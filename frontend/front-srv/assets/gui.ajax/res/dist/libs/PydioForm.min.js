(()=>{"use strict";var e={4305:e=>{e.exports=require("lodash.debounce")},39455:e=>{e.exports=require("material-ui")},580:e=>{e.exports=require("prop-types")},10757:e=>{e.exports=require("pydio")},9763:e=>{e.exports=require("pydio/util/lang")},16689:e=>{e.exports=require("react")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{r.r(n),r.d(n,{default:()=>rn});var e=r(16689),t=r.n(e);const o=require("pydio/util/xml");var i=r.n(o),a=r(10757),l=r.n(a);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e,t,r){return(t=y(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===u(t)?t:String(t)}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}const b=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(b,n);var o,i,a,l,y=(a=b,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(a);if(l){var r=d(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function b(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({displayContext:"form",disabled:!1},e),(t=y.call(this,e)).state={editMode:!1,dirty:!1,value:t.props.value},t}return o=b,(i=[{key:"isDisplayGrid",value:function(){return"grid"===this.props.displayContext}},{key:"isDisplayForm",value:function(){return"form"===this.props.displayContext}},{key:"toggleEditMode",value:function(){if(!this.isDisplayForm()){var e=!this.state.editMode;this.setState({editMode:e}),this.props.onChangeEditMode&&this.props.onChangeEditMode(e)}}},{key:"enterToToggle",value:function(e){"Enter"===e.key&&this.toggleEditMode()}},{key:"bufferChanges",value:function(e,t){this.triggerPropsOnChange(e,t)}},{key:"onChange",value:function(e,t){void 0===t&&(t=e.currentTarget.getValue?e.currentTarget.getValue():e.currentTarget.value),this.changeTimeout&&clearTimeout(this.changeTimeout);var n=t,o=this.state.value;if(r&&this.triggerPropsOnChange(n,o),this.setState({dirty:!0,value:n}),!r){var i=250;"password"===this.props.attributes.type&&(i=1200),this.changeTimeout=setTimeout(function(){this.bufferChanges(n,o)}.bind(this),i)}}},{key:"triggerPropsOnChange",value:function(e,t){"password"===this.props.attributes.type?(this.toggleEditMode(),this.props.onChange(e,t,{type:this.props.attributes.type})):this.props.onChange(e,t)}},{key:"componentWillReceiveProps",value:function(e){this.setState({value:e.value,dirty:!1})}},{key:"isValid",value:function(){return!this.refs.internal||!this.refs.internal.isValid||this.refs.internal.isValid()}},{key:"render",value:function(){var r=this;return t().createElement(e,s({},this.props,this.state,{ref:"internal",onChange:function(e,t){return r.onChange(e,t)},toggleEditMode:function(){return r.toggleEditMode()},enterToToggle:function(e){return r.enterToToggle(e)},isDisplayGrid:function(){return r.isDisplayGrid()},isDisplayForm:function(){return r.isDisplayForm()}}))}}])&&f(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),b}(t().Component);return n},m=require("pydio/util/pass");var v=r.n(m);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==g(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===g(o)?o:String(o)),n)}var o}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var P=l().requireLib("hoc").ModernTextField;const S=b(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(l,e);var r,n,o,i,a=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(o);if(i){var r=j(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===g(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={},e.value){var r=v().isValidLogin(e.value);t.state={valid:!r,err:r}}return t}return r=l,(n=[{key:"textValueChanged",value:function(e,t){var r=v().isValidLogin(t),n=!r;(this.state&&this.state.valid)!==n&&this.props.onValidStatusChange&&this.props.onValidStatusChange(n),this.setState({valid:n,err:r}),this.props.onChange(e,t)}},{key:"isValid",value:function(){return this.state&&this.state.valid}},{key:"render",value:function(){var e=this,r=this.props,n=r.isDisplayGrid,o=r.isDisplayForm,i=r.editMode,a=r.disabled,l=r.errorText,u=r.enterToToggle,s=r.toggleEditMode,c=r.attributes,p=r.variant,f=this.props.value;if(n()&&!i)return"password"===c.type&&f&&(f="***********"),t().createElement("div",{onClick:a?function(){}:s,className:f?"":"paramValue-empty"},f||"Empty");var y=this.state&&this.state.err,h=t().createElement(P,{floatingLabelText:o()?c.label:null,value:f||"",onChange:function(t,r){return e.textValueChanged(t,r)},onKeyDown:u,type:"password"===c.type?"password":null,multiLine:"textarea"===c.type,disabled:a,errorText:l||y,autoComplete:"off",fullWidth:!0,variant:p});return"password"===c.type?t().createElement("form",{autoComplete:"off",onSubmit:function(e){e.stopPropagation(),e.preventDefault()},style:{display:"inline"}},h):t().createElement("span",null,h)}}])&&O(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}(t().Component));var E=r(39455);function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==_(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===_(o)?o:String(o)),n)}var o}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}var k=l().requireLib("hoc").ModernTextField;const R=b(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(l,e);var r,n,o,i,a=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=T(o);if(i){var r=T(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a.apply(this,arguments)}return r=l,(n=[{key:"render",value:function(){var e=this.props,r=e.editMode,n=e.value,o=e.variant,i=e.isDisplayGrid,a=e.isDisplayForm,l=e.onChange,u=e.enterToToggle,s=e.attributes,c=e.disabled,p=e.errorText,f=e.toggleEditMode;if(i()&&!r){var y=n;return"password"===s.type&&n&&(y="***********"),t().createElement("div",{onClick:c?function(){}:f,className:y?"":"paramValue-empty"},y||"Empty")}var h=t().createElement(k,{hintText:a()?s.label:null,value:n||"",onChange:l,onKeyDown:u,type:"password"===s.type?"password":null,multiLine:"textarea"===s.type,disabled:c,errorText:p,autoComplete:"off",fullWidth:!0,variant:o});return"password"===this.props.attributes.type?t().createElement("form",{autoComplete:"off",onSubmit:function(e){e.stopPropagation(),e.preventDefault()},style:{display:"inline"}},h):t().createElement("span",null,h)}}])&&x(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}(t().Component));function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==D(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===D(o)?o:String(o)),n)}var o}function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var M=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&N(e,t)}(u,e);var r,n,o,i,a,l=(r=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(r);if(n){var o=A(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),l.apply(this,arguments)}return o=u,(i=[{key:"render",value:function(){var e,r=this.props,n=r.attributes,o=r.altIcon,i=void 0===o?"mdi mdi-toggle-switch":o,a=r.altIconText,l=void 0===a?"mdi mdi-textbox":a,u=r.altTip,s=void 0===u?"Switch to text version":u,c=r.onAltTextSwitch,p=n.alternativeText;return e=p?t().createElement(R,this.props):this.props.children,t().createElement("div",{style:{display:"flex"}},t().createElement("div",{style:{flex:1}},e),t().createElement("div",null,t().createElement(E.IconButton,{iconClassName:p?i:l,title:s,onClick:function(){return c(n.name,!p)},iconStyle:{opacity:.3,fontSize:20},style:{padding:"14px 8px",width:42,height:42}})))}}])&&I(o.prototype,i),a&&I(o,a),Object.defineProperty(o,"prototype",{writable:!1}),u}(t().Component);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==V(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===V(o)?o:String(o)),n)}var o}function L(e,t){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},L(e,t)}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}var H=l().requireLib("hoc"),q=H.ModernTextField,G=H.ModernSelectField;const U=b(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&L(e,t)}(u,e);var r,n,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=F(o);if(i){var r=F(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),a.apply(this,arguments)}return r=u,(n=[{key:"divide",value:function(e){for(var t=["k","M","G","T","P"],r={bytesValue:e,unit:""},n=0;n<t.length;n++){var o=this.multiple(1,t[n]);e>=o&&e%o==0&&(r={bytesValue:e/o,unit:t[n]})}return r}},{key:"multiple",value:function(e,t){var r=parseFloat(e);switch(t){case"k":return 1024*r;case"M":return 1024*r*1024;case"G":return 1024*r*1024*1024;case"T":return 1024*r*1024*1024*1024;case"P":return 1024*r*1024*1024*1024*1024;default:return r}}},{key:"render",value:function(){var e=this,r=l().getMessages().byte_unit_symbol||"B",n=this.props,o=n.value,i=n.onChange,a=n.isDisplayGrid,u=n.isDisplayForm,s=n.editMode,c=n.disabled,p=n.toggleEditMode,f=n.attributes,y=n.variant,h=0,d="";if(o){var b=this.divide(parseInt(o)),m=b.bytesValue,v=b.unit;h=m,d=v}return a()&&!s?t().createElement("div",{onClick:c?function(){}:p,className:o?"":"paramValue-empty"},o?h+d+r:"Empty"):t().createElement("div",null,t().createElement("div",{style:{display:"flex",height:"v2"===y?66:null}},t().createElement(q,{value:h,hintText:u()?f.label:null,style:{flex:2},type:"number",variant:y,hasRightBlock:!0,disabled:c,onChange:function(t,r){var n=Math.max(0,r)||0;i(t,e.multiple(n,d))}}),t().createElement(G,{value:d||"b",variant:y,hintText:"Unit",hasLeftBlock:!0,disabled:c,onChange:function(t,r,n){i(t,e.multiple(h,n))},style:{flex:1}},t().createElement(E.MenuItem,{value:"b",primaryText:r}),t().createElement(E.MenuItem,{value:"k",primaryText:"K"+r}),t().createElement(E.MenuItem,{value:"M",primaryText:"M"+r}),t().createElement(E.MenuItem,{value:"G",primaryText:"G"+r}),t().createElement(E.MenuItem,{value:"T",primaryText:"T"+r}),t().createElement(E.MenuItem,{value:"P",primaryText:"P"+r}))))}}])&&B(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),u}(t().Component)),z=require("material-ui/styles");function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},J.apply(this,arguments)}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){X(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function X(e,t,r){return(t=$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$(n.key),n)}}function $(e){var t=function(e,t){if("object"!==W(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===W(t)?t:String(t)}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function ee(e){return ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ee(e)}var te=l().requireLib("hoc").ThemedModernStyles,re={position:"absolute",fontSize:16,lineHeight:"22px",top:25,transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",zIndex:1,transform:"scale(0.75) translate(0px, -28px)",transformOrigin:"left top",pointerEvents:"none",userSelect:"none",color:"rgba(0, 0, 0, 0.3)",left:8,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"127%"},ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(l,e);var r,n,o,i,a=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ee(o);if(i){var r=ee(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a.apply(this,arguments)}return r=l,(n=[{key:"render",value:function(){var e=this.props.value,r=this.props,n=r.variant,o=r.variantShowLegend,i=r.disabled,a=r.onChange,l=r.attributes,u=r.isDisplayForm,s=r.muiTheme;"string"==typeof e&&(e="true"===e);var c=te(s);if("v2"===n){var p=Y({},c.toggleFieldV2);return o&&(p.style=Y(Y({},p.style),{},{padding:"23px 6px 4px"})),t().createElement("div",{style:{position:"relative",height:58}},t().createElement("div",{style:Y(Y({},re),{},{display:o?"block":"none"})},l.description),t().createElement(E.Checkbox,J({checked:e,onCheck:function(e,t){return a(e,t)},disabled:i,label:u()?l.label:null,labelPosition:"right"},p)))}return t().createElement(E.Toggle,J({toggled:e,onToggle:function(e,t){return a(e,t)},disabled:i,label:u()?l.label:null,labelPosition:u()?"left":"right"},c.toggleField))}}])&&Z(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}(t().Component);const oe=b((0,z.muiThemeable)()(ne),!0);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(r),!0).forEach((function(t){ue(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ue(e,t,r){return(t=ce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ce(n.key),n)}}function ce(e){var t=function(e,t){if("object"!==ie(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ie(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ie(t)?t:String(t)}function pe(e,t){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},pe(e,t)}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fe(e)}var ye=l().requireLib("hoc").ModernTextField;const he=b(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pe(e,t)}(u,e);var r,n,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fe(o);if(i){var r=fe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this,e)).state={},t}return r=u,(n=[{key:"isValid",value:function(){return this.state.valid}},{key:"checkMinLength",value:function(e){var t=parseInt(l().getInstance().getPluginConfigs("core.auth").get("PASSWORD_MINLENGTH"));return!(e&&e.length<t)}},{key:"getMessage",value:function(e){return l().getMessages()[e]||e}},{key:"updatePassState",value:function(){var e=this.state.valid,t=v().getState(this.refs.pass.getValue(),this.refs.confirm?this.refs.confirm.getValue():"");t.value=this.refs.pass.getValue(),this.setState(t),e!==t.valid&&this.props.onValidStatusChange&&this.props.onValidStatusChange(t.valid)}},{key:"onPasswordChange",value:function(e,t){this.updatePassState(),this.props.onChange(e,t)}},{key:"onConfirmChange",value:function(e,t){this.setState({confirmValue:t}),this.updatePassState(),this.props.onChange(e,this.state.value)}},{key:"render",value:function(){var e=this.props,r=e.disabled,n=e.className,o=e.attributes,i=e.dialogField,a=this.props,l=a.isDisplayGrid,u=(a.isDisplayForm,a.editMode),s=a.value,c=a.toggleEditMode,p=a.enterToToggle,f=a.variant;if(l()&&!u)return t().createElement("div",{onClick:r?function(){}:c,className:s?"":"paramValue-empty"},s||"Empty");var y,h={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"100%"},d=this.state.valid?"":"mui-error-as-hint";n&&(d=n+" "+d);var b=i?E.TextField:ye;s&&!r&&(y=[t().createElement("div",{key:"sep",style:{width:8}}),t().createElement(b,{key:"confirm",ref:"confirm",floatingLabelText:this.getMessage(199),floatingLabelShrinkStyle:le(le({},h),{},{width:"130%"}),floatingLabelStyle:h,className:d,value:this.state.confirmValue,onChange:this.onConfirmChange.bind(this),type:"password",multiLine:!1,disabled:r,fullWidth:!0,style:{flex:1},errorText:this.state.confirmErrorText,errorStyle:i?{bottom:15}:null,variant:f})]);var m={display:"flex"};return"v2"===f&&(m.height=66,"column"===o.direction&&(m.flexDirection="column",m.paddingBottom=4,y&&(m.height*=2))),t().createElement("form",{autoComplete:"off",onSubmit:function(e){e.stopPropagation(),e.preventDefault()}},t().createElement("div",{style:m},t().createElement(b,{ref:"pass",floatingLabelText:l()?null:o.label,floatingLabelShrinkStyle:le(le({},h),{},{width:"130%"}),floatingLabelStyle:h,className:d,value:this.state.value,onChange:this.onPasswordChange.bind(this),onKeyDown:p,type:"password",multiLine:!1,disabled:r,errorText:this.state.passErrorText,fullWidth:!0,style:{flex:1},errorStyle:i?{bottom:15}:null,variant:f}),y))}}])&&se(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),u}(t().Component));function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}function be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==de(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==de(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===de(o)?o:String(o)),n)}var o}function me(e,t){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},me(e,t)}function ve(e){return ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ve(e)}var ge=l().requireLib("hoc").ModernTextField;const Oe=b(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&me(e,t)}(l,e);var r,n,o,i,a=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ve(o);if(i){var r=ve(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===de(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),a.apply(this,arguments)}return r=l,(n=[{key:"keyDown",value:function(e){var t=0,r=1;if("Enter"!==e.key){"ArrowUp"===e.key?t=1:"ArrowDown"===e.key&&(t=-1),e.shiftKey&&(r=10);var n=parseInt(this.props.value);isNaN(n)&&(n=0);var o=n+t*r;this.props.onChange(null,o)}else this.props.toggleEditMode()}},{key:"render",value:function(){var e,r=this,n=this.props,o=n.value,i=n.isDisplayGrid,a=n.isDisplayForm,l=n.editMode,u=n.disabled,s=n.toggleEditMode,c=n.attributes,p=n.variant;return i()&&!l?t().createElement("div",{onClick:u?function(){}:s,className:o?"":"paramValue-empty"},o||"Empty"):(o?(e=parseInt(o)+"",isNaN(e)&&(e=o+"")):e="0",t().createElement("span",{className:"integer-input"},t().createElement(ge,{value:e,onChange:function(e,t){return r.props.onChange(e,t)},onKeyDown:function(e){return r.keyDown(e)},disabled:u,fullWidth:!0,variant:p,hintText:a()?c.label:null})))}}])&&be(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}(t().Component)),we=require("pydio/http/api");var je=r.n(we);function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ee(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){_e(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _e(e,t,r){return(t=Ce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ce(n.key),n)}}function Ce(e){var t=function(e,t){if("object"!==Pe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Pe(t)?t:String(t)}function Te(e,t){return Te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Te(e,t)}function ke(e){return ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ke(e)}var Re=r(16689);const De=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Te(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ke(n);if(o){var r=ke(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,Ee({onDrop:function(){}},e))).state={isDragActive:!1,supportClick:void 0===e.supportClick||e.supportClick,multiple:void 0===e.multiple||e.multiple},t}return t=a,(r=[{key:"onDragLeave",value:function(e){this.setState({isDragActive:!1})}},{key:"onDragOver",value:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",this.setState({isDragActive:!0})}},{key:"onFilePicked",value:function(e){if(e.target&&e.target.files){var t=e.target.files,r=this.state.multiple?t.length:1;t=Array.prototype.slice.call(t,0,r),this.props.onDrop&&this.props.onDrop(t,e,this)}}},{key:"onFolderPicked",value:function(e){this.props.onFolderPicked&&this.props.onFolderPicked(e.target.files)}},{key:"onDrop",value:function(e){if(this.setState({isDragActive:!1}),e.preventDefault(),!this.props.ignoreNativeDrop){var t;e.dataTransfer?t=e.dataTransfer.files:e.target&&(t=e.target.files);for(var r=this.state.multiple?t.length:1,n=0;n<r;n++)t[n].preview=URL.createObjectURL(t[n]);this.props.onDrop&&(t=Array.prototype.slice.call(t,0,r),this.props.onDrop(t,e,this))}}},{key:"onClick",value:function(){!0===this.state.supportClick&&this.open()}},{key:"open",value:function(){this.refs.fileInput.click()}},{key:"openFolderPicker",value:function(){this.refs.folderInput.setAttribute("webkitdirectory","true"),this.refs.folderInput.click()}},{key:"render",value:function(){var e=this,t=this.props.className||"file-dropzone";this.state.isDragActive&&(t+=" active");var r,n={width:this.props.size||100,height:this.props.size||100};return this.props.style&&(n=Ee(Ee({},n),this.props.style)),this.state.isDragActive&&this.props.dragActiveStyle&&(n=Ee(Ee({},n),this.props.dragActiveStyle)),this.props.enableFolders&&(r=Re.createElement("input",{style:{display:"none"},name:"userfolder",type:"file",ref:"folderInput",onChange:function(t){return e.onFolderPicked(t)}})),Re.createElement("div",{className:t,style:n,onClick:this.onClick.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragOver:this.onDragOver.bind(this),onDrop:this.onDrop.bind(this)},Re.createElement("input",{style:{display:"none"},name:"userfile",type:"file",multiple:this.state.multiple,ref:"fileInput",value:"",onChange:this.onFilePicked.bind(this),accept:this.props.accept}),r,this.props.children)}}])&&xe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(Re.Component);var Ie=r(9763),Ne=r.n(Ie);function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function Me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(r),!0).forEach((function(t){Be(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Be(e,t,r){return(t=Fe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fe(n.key),n)}}function Fe(e){var t=function(e,t){if("object"!==Ae(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Ae(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ae(t)?t:String(t)}function He(e,t){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},He(e,t)}function qe(e){return qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qe(e)}var Ge=(0,l().requireLib("hoc").NativeFileDropProvider)(De,(function(e,t,r){}));const Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&He(e,t)}(u,e);var r,n,o,i,a=(o=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=qe(o);if(i){var r=qe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=a.call(this,e)).props.value?(r=t.getBinaryUrl(t.props),n=t.props.value):t.props.attributes.defaultImage&&(r=t.props.attributes.defaultImage),t.state={imageSrc:r,originalBinary:n,value:t.props.value},t}return r=u,(n=[{key:"componentWillReceiveProps",value:function(e){var t;(e.value||e.binary_context&&e.binary_context!==this.props.binary_context)&&!this.state.reset?t=this.getBinaryUrl(e,this.state.temporaryBinary&&this.state.temporaryBinary===e.value):e.attributes.defaultImage&&(t=e.attributes.defaultImage),t&&this.setState({imageSrc:t,reset:!1,value:e.value})}},{key:"getBinaryUrl",value:function(e){var t=je().getClient().getPydioObject().Parameters.get("ENDPOINT_REST_API")+e.attributes.loadAction,r=e.value;return e.binary_context&&0===e.binary_context.indexOf("user_id=")&&(r=e.binary_context.replace("user_id=","")),t.replace("{BINARY}",r)}},{key:"getUploadUrl",value:function(){var e,t=je().getClient().getPydioObject().Parameters.get("ENDPOINT_REST_API")+this.props.attributes.uploadAction;return e=this.props.binary_context&&0===this.props.binary_context.indexOf("user_id=")?this.props.binary_context.replace("user_id=",""):this.props.value?this.props.value:Ne().computeStringSlug(this.props.attributes.name+".png"),t.replace("{BINARY}",e)}},{key:"uploadComplete",value:function(e){var t=this.state.value;if(this.setState({temporaryBinary:e,value:null}),this.props.onChange){var r={type:"binary"};this.state.originalBinary&&(r.original_binary=this.state.originalBinary),this.props.onChange(e,t,r),this.setState({dirty:!0,value:e})}}},{key:"htmlUpload",value:function(){window.formManagerHiddenIFrameSubmission=function(e){this.uploadComplete(e.trim()),window.formManagerHiddenIFrameSubmission=null}.bind(this),this.refs.uploadForm.submit()}},{key:"onDrop",value:function(e,t,r){var n=this;if(0!==e.length){var o=l().getMessages();"avatar"===this.props.name&&e[0].size>5242880?this.setState({error:o["form.input-image.avatarMax"]}):-1!==["image/jpeg","image/png","image/bmp","image/tiff","image/webp"].indexOf(e[0].type)?(this.setState({error:null}),je().supportsUpload()?(this.setState({loading:!0}),je().getRestClient().getOrUpdateJwt().then((function(t){var r={customHeaders:{Authorization:"Bearer "+t}};je().getClient().uploadFile(e[0],"userfile","",(function(e){var t=JSON.parse(e.responseText);t&&t.binary&&n.uploadComplete(t.binary),n.setState({loading:!1})}),(function(e){n.setState({loading:!1,error:e})}),(function(e){}),n.getUploadUrl(),r)}))):this.htmlUpload()):this.setState({error:o["form.input-image.fileTypes"]})}}},{key:"clearImage",value:function(){if(confirm(l().getMessages()["form.input-image.clearConfirm"])){var e=this.state.value;this.setState({value:null,error:null,reset:!0},function(){this.props.onChange("",e,{type:"binary"})}.bind(this))}}},{key:"render",value:function(){var e=this,r=this.state,n=r.loading,o=r.error,i=this.state.imageSrc,a=this.props.attributes,u=a.defaultImage===i;i.indexOf("[mode]")>-1&&(i=i.replace("[mode]","light"));var s,c={backgroundImage:"url("+i+")",backgroundPosition:"50% 50%",backgroundSize:"cover",position:"relative"},p={};o?(p={backgroundColor:"rgba(255, 255, 255, 0.77)",borderRadius:"50%"},s=t().createElement("div",{style:{color:"#F44336",textAlign:"center",fontSize:11,cursor:"pointer"},onClick:function(){e.setState({error:null})}},t().createElement("span",{className:"mdi mdi-alert",style:{fontSize:40}}),t().createElement("br",null),o)):s=n?t().createElement(E.CircularProgress,{mode:"indeterminate"}):t().createElement("span",{className:"mdi mdi-camera",style:{fontSize:40,opacity:.5,color:u?null:"white"}});var f=this.props.variant;return t().createElement("div",{style:"v2"===f?{backgroundColor:"#f6f6f8"}:null},t().createElement("div",{className:"image-label"},a.label),t().createElement("form",{ref:"uploadForm",encType:"multipart/form-data",target:"uploader_hidden_iframe",method:"post",action:this.getUploadUrl()},t().createElement(Ge,{onDrop:this.onDrop.bind(this),accept:"image/*",style:c},t().createElement("div",{style:Ve({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},p)},s))),!u&&t().createElement("div",{className:"binary-remove-button",onClick:this.clearImage.bind(this)},t().createElement("span",{key:"remove",className:"mdi mdi-close"})," ",l().getMessages()["form.input-image.clearButton"]),t().createElement("iframe",{style:{display:"none"},id:"uploader_hidden_iframe",name:"uploader_hidden_iframe"}))}}])&&Le(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),u}(t().Component),ze=require("pydio/model/repository");var We=r.n(ze);function Je(e){return Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Je(e)}function Ke(){return Ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ke.apply(this,arguments)}function Ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Je(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Je(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Je(o)?o:String(o)),n)}var o}function Xe(e,t){return Xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xe(e,t)}function Ze(e){return Ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ze(e)}var $e=r(16689).Component,Qe=r(10757).requireLib("boot").PydioContextConsumer;function et(e){return Qe(function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xe(e,t)}(l,t);var r,n,o,i,a=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ze(o);if(i){var r=Ze(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Je(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(e,t){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),r=a.call(this,e,t);var n=new Map;return n.set("0",r.props.pydio?r.props.pydio.MessageHash["ajxp_admin.home.6"]:" ... "),r.state={choices:n,choicesParsed:!1},r}return r=l,(n=[{key:"loadExternalValues",value:function(e){var t,r=this,n=this.props.pydio,o=!0;if(e instanceof Map)return this.onChoicesLoaded&&this.onChoicesLoaded(e),{choices:e,parsed:o};var i=new Map;if(0===e.indexOf("json_file:"))o=!1,t=e.replace("json_file:",""),i.set("0",n.MessageHash["ajxp_admin.home.6"]),je().getClient().loadFile(t,(function(t){var n=new Map;if(t.responseJSON)t.responseJSON.forEach((function(e){n.set(e.key,e.label)}));else if(t.responseText)try{JSON.parse(t.responseText).forEach((function(e){n.set(e.key,e.label)}))}catch(t){console.log("Error while parsing list "+e,t)}r.setState({choices:n},(function(){r.onChoicesLoaded&&r.onChoicesLoaded(n)}))}));else if("PYDIO_AVAILABLE_LANGUAGES"===e)n.listLanguagesWithCallback((function(e,t){i.set(e,t)})),this.onChoicesLoaded&&this.onChoicesLoaded(i);else if("PYDIO_AVAILABLE_REPOSITORIES"===e){if(n.user){var a=[],l=[];n.user.repositories.forEach((function(e){We().isInternal(e.getId())?l.push({id:e.getId(),label:"["+n.MessageHash[331]+"] "+e.getLabel()}):"cell"!==e.getRepositoryType()&&a.push({id:e.getId(),label:e.getLabel()})})),a.sort((function(e,t){return e.label.localeCompare(t.label,void 0,{numeric:!0})})),a.push.apply(a,l),a.forEach((function(e){return i.set(e.id,e.label)}))}this.onChoicesLoaded&&this.onChoicesLoaded(i)}else e.split(",").map((function(e){var t,r,o=e.split("|");o.length>1?(r=o[0],t=o[1]):r=t=e,n.MessageHash[t]&&(t=n.MessageHash[t]),i.set(r,t)}));return{choices:i,parsed:o}}},{key:"componentDidMount",value:function(){if(this.props.attributes.choices){var e=this.loadExternalValues(this.props.attributes.choices),t=e.choices,r=e.parsed;this.setState({choices:t,choicesParsed:r})}}},{key:"componentWillReceiveProps",value:function(e){if(e.attributes.choices&&e.attributes.choices!==this.props.attributes.choices){var t=this.loadExternalValues(e.attributes.choices),r=t.choices,n=t.parsed;this.setState({choices:r,choicesParsed:n})}}},{key:"render",value:function(){return React.createElement(e,Ke({},this.props,this.state))}}])&&Ye(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}($e))}function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function rt(){return rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rt.apply(this,arguments)}function nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==tt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===tt(o)?o:String(o)),n)}var o}function ot(e,t){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ot(e,t)}function it(e){return it=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},it(e)}var at=r(16689),lt=r(39455),ut=(lt.SelectField,lt.MenuItem),st=lt.Chip,ct=r(9763),pt=l().requireLib("hoc").ModernSelectField,ft=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ot(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=it(n);if(o){var r=it(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===tt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"onDropDownChange",value:function(e,t,r){this.props.onChange(e,r),this.props.toggleEditMode()}},{key:"onMultipleSelect",value:function(e,t,r){if(-1!==r){var n=this.props.value,o="string"==typeof n?n.split(","):n;-1===o.indexOf(r)&&(o.push(r),this.props.onChange(e,o.join(","))),this.props.toggleEditMode()}}},{key:"onMultipleRemove",value:function(e){var t=this.props.value,r="string"==typeof t?t.split(","):t;-1!==r.indexOf(e)&&(r=ct.arrayWithout(r,r.indexOf(e)),this.props.onChange(null,r.join(",")))}},{key:"render",value:function(){var e=this,t=this.props.value,r=[],n=this.props,o=n.attributes,i=n.isDisplayGrid,a=n.toggleEditMode,l=n.editMode,u=n.disabled,s=n.multiple,c=n.className,p=n.variant;o.mandatory&&"true"===o.mandatory||r.push(at.createElement(ut,{value:-1,primaryText:o.label+"..."}));var f=this.props.choices;if(f.forEach((function(e,t){r.push(at.createElement(ut,{value:t,primaryText:e}))})),i()&&!l){var y=this.props.value;return f.get(y)&&(y=f.get(y)),at.createElement("div",{onClick:u?function(){}:a,className:y?"":"paramValue-empty"},y||"Empty","   ",at.createElement("span",{className:"mdi mdi-chevron-down"}))}if(s&&!0===s){var h=t;"string"==typeof t&&(h=t.split(","));var d=at.createElement("div",{style:{display:"flex",flexWrap:"wrap",marginTop:"v2"===p?22:8}},h.map((function(t){return at.createElement(st,{style:{marginRight:8},onRequestDelete:function(){e.onMultipleRemove(t)}},f.get(t)||t)}))),b={};return"v2"===p&&(r=[at.createElement(ut,{value:-1,primaryText:d})],f.forEach((function(e,t){r.push(at.createElement(ut,{value:t,primaryText:e}))})),b.hintText=o.label,b.style={height:72},b.dropDownMenuProps={iconStyle:{fill:"#9e9e9e",top:22,right:0}}),at.createElement("span",{className:"multiple has-value"},"v2"!==p&&d,at.createElement(pt,rt({value:-1,onChange:function(t,r,n){return e.onMultipleSelect(t,r,n)},fullWidth:!0,className:c,variant:p,disabled:u},b),r))}return at.createElement("span",null,at.createElement(pt,{hintText:o.label,value:t,onChange:function(t,r,n){return e.onDropDownChange(t,r,n)},fullWidth:!0,className:c,variant:p,disabled:u},r))}}])&&nt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(at.Component);function yt(e){return yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yt(e)}function ht(){return ht=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ht.apply(this,arguments)}function dt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==yt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===yt(o)?o:String(o)),n)}var o}function bt(e,t){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bt(e,t)}function mt(e){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mt(e)}ft=et(ft=b(ft,!0));var vt=r(16689),gt=r(39455),Ot=gt.AutoComplete,wt=gt.MenuItem,jt=gt.RefreshIndicator,Pt=l().requireLib("hoc"),St=Pt.ThemedModernStyles,Et=Pt.ModernAutoComplete,_t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=mt(n);if(o){var r=mt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"handleUpdateInput",value:function(e){}},{key:"handleNewRequest",value:function(e){void 0===e.key?this.props.onChange(null,e):this.props.onChange(null,e.key)}},{key:"render",value:function(){var e=this,t=this.props,r=t.choices,n=t.isDisplayGrid,o=t.editMode,i=t.disabled,a=t.toggleEditMode,l=t.variant,u=t.muiTheme,s=[],c={};r.forEach((function(e,t){s.push({key:t,text:e,value:vt.createElement(wt,null,e)}),c[t]=e}));var p=this.props.value;return c&&c[p]&&(p=c[p]),n()&&!o||i?(r.get(p)&&(p=r.get(p)),vt.createElement("div",{onClick:i?function(){}:a,className:p?"":"paramValue-empty"},p||"Empty","   ",vt.createElement("span",{className:"mdi mdi-chevron-down"}))):vt.createElement("div",{className:"pydioform_autocomplete",style:{position:"relative"}},!s.length&&vt.createElement(jt,{size:30,right:10,top:0,status:"loading"}),"v2"!==l&&s.length&&vt.createElement(Ot,ht({fullWidth:!0,searchText:p,onUpdateInput:function(t){return e.handleUpdateInput(t)},onNewRequest:function(t){return e.handleNewRequest(t)},dataSource:s,hintText:this.props.attributes.label,filter:function(e,t){return!(!t||!e)&&0===t.toLowerCase().indexOf(e.toLowerCase())},openOnFocus:!0,menuProps:{maxHeight:200}},St(u).textField)),"v2"===l&&s.length&&vt.createElement(Et,{fullWidth:!0,searchText:p,onUpdateInput:function(t){return e.handleUpdateInput(t)},onNewRequest:function(t){return e.handleNewRequest(t)},dataSource:s,hintText:this.props.attributes.label,filter:function(e,t){return!(!t||!e)&&0===t.toLowerCase().indexOf(e.toLowerCase())},openOnFocus:!0,menuProps:{maxHeight:200},autoComplete:"no-completion"}))}}])&&dt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(vt.Component);function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function Ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==xt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===xt(o)?o:String(o)),n)}var o}function Tt(e,t){return Tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tt(e,t)}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kt(e)}_t=et(_t=b(_t=(0,z.muiThemeable)()(_t)));var Rt=r(16689),Dt=r(4305),It=r(39455),Nt=It.AutoComplete,At=It.MenuItem,Mt=It.RefreshIndicator,Vt=It.FontIcon;const Bt=b(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kt(n);if(o){var r=kt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===xt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,r=[{key:"handleUpdateInput",value:function(e){this.debounced(),this.setState({searchText:e})}},{key:"handleNewRequest",value:function(e){var t;t=void 0===e.key?e:e.key,this.props.onChange(null,t),this.loadValues(t)}},{key:"componentWillMount",value:function(){this.debounced=Dt(this.loadValues.bind(this),300),this.lastSearch=null;var e="";this.props.value&&(e=this.props.value),this.loadValues(e)}},{key:"loadValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e;if(!e&&this.state.searchText){var r=this.state.searchText.lastIndexOf("/");t=this.state.searchText.substr(0,r)}null!==this.lastSearch&&this.lastSearch===t||(this.lastSearch=t)}},{key:"render",value:function(){var e=[];this.state&&this.state.nodes&&this.state.nodes.forEach((function(t){var r="mdi mdi-folder";t.uuid.startsWith("DATASOURCE:")&&(r="mdi mdi-database"),e.push({key:t.path,text:t.path,value:Rt.createElement(At,null,Rt.createElement(Vt,{className:r,color:"#616161",style:{float:"left",marginRight:8}})," ",t.path)})}));var t=this.state.value;return Rt.createElement("div",{className:"pydioform_autocomplete",style:{position:"relative"}},!e.length&&Rt.createElement(Mt,{size:30,right:10,top:0,status:"loading"}),Rt.createElement(Nt,{fullWidth:!0,searchText:t,onUpdateInput:this.handleUpdateInput.bind(this),onNewRequest:this.handleNewRequest.bind(this),dataSource:e,floatingLabelText:this.props.attributes.label,filter:function(e,t){return 0===t.toLowerCase().indexOf(e.toLowerCase())},openOnFocus:!0,menuProps:{maxHeight:200}}))}}],r&&Ct(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(Rt.Component));function Lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(r),!0).forEach((function(t){Ht(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ht(e,t,r){return(t=zt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function Gt(){return Gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gt.apply(this,arguments)}function Ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zt(n.key),n)}}function zt(e){var t=function(e,t){if("object"!==qt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===qt(t)?t:String(t)}var Wt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,o;return n=e,o=[{key:"hasHelper",value:function(t,r){var n=e.getHelpersCache();return n[t]&&n[t].parameters[r]}},{key:"getHelpersCache",value:function(){if(!e.HELPERS_CACHE){for(var t={},r=i().XPathSelectNodes(window.pydio.Registry.getXML(),'plugins/*/client_settings/resources/js[@type="helper"]'),n=0;n<r.length;n++){var o=r[n],a=o.getAttribute("plugin");t[a]={namespace:o.getAttribute("className"),parameters:{}};for(var l=i().XPathSelectNodes(o,"parameter"),u=0;u<l.length;u++){var s=l[u];t[a].parameters[s.getAttribute("name")]=!0}}e.HELPERS_CACHE=t}return e.HELPERS_CACHE}},{key:"parseParameters",value:function(t,r){return i().XPathSelectNodes(t,r).map(function(t){return e.parameterNodeToHash(t)}.bind(this))}},{key:"parameterNodeToHash",value:function(e){var t=e.attributes,n={};e.parentNode&&e.parentNode.parentNode&&e.parentNode.parentNode.getAttribute&&(n.pluginId=e.parentNode.parentNode.getAttribute("id"));for(var o=!1,i=r.g.pydio.MessageHash,a=0;a<t.length;a++){var l=t.item(a).nodeName,u=t.item(a).value;"label"!==l&&"description"!==l&&"group"!==l&&0!==l.indexOf("group_switch_")||!i[u]||(u=i[u]),"cdatavalue"!==l?n[l]=u:o=!0}return o&&(n.value=e.firstChild.value),"boolean"===n.type?(void 0!==n.value&&(n.value="true"===n.value),void 0!==n.default&&(n.default="true"===n.default)):"integer"!==n.type&&"integer-bytes"!==n.type||(void 0!==n.value&&(n.value=parseInt(n.value)),void 0!==n.default&&(n.default=parseInt(n.default))),n}},{key:"createFormElement",value:function(e){var r,n=e.attributes,o=e.onAltTextSwitch,i=e.altTextSwitchIcon,a={onAltTextSwitch:o,altTip:e.altTextSwitchTip,altIconText:i};switch(n.type){case"boolean":r=t().createElement(oe,e),o&&(r=t().createElement(M,Gt({},e,a,{altIcon:"mdi mdi-toggle-switch"}),r));break;case"string":case"textarea":case"password":r=t().createElement(R,e);break;case"valid-password":r=t().createElement(he,e);break;case"valid-login":r=t().createElement(S,e);break;case"integer":case"integer-bytes":r="integer-bytes"===n.type?t().createElement(U,e):t().createElement(Oe,e),o&&(r=t().createElement(M,Gt({},e,a,{altIcon:"mdi mdi-number"}),r));break;case"image":r=t().createElement(Ue,e);break;case"select":r=t().createElement(ft,e),o&&(r=t().createElement(M,Gt({},e,a,{altIcon:"mdi mdi-view-list"}),r));break;case"autocomplete":r=t().createElement(_t,e);break;case"autocomplete-tree":r=t().createElement(Bt,e);break;case"legend":case"hidden":r=null;break;default:r=e.value?e.value:t().createElement("span",{className:"paramValue-empty"},"Empty")}return r}},{key:"SlashesToJson",value:function(t){if(void 0===t||"object"!==qt(t))return t;var r={},n={};return Object.keys(t).forEach((function(e){var o=t[e];if(e.indexOf("/")>0){var i=e.split("/"),a=i.shift(),l=i.join("/");r[a]?"string"==typeof r[a]&&(r[a]={"@value":r[a]}):r[a]={},r[a][l]=o,n[a]=a}else r[e]&&"object"===qt(r[e])?r[e]["@value"]=o:r[e]=o})),Object.keys(n).map((function(t){r[t]=e.SlashesToJson(r[t])})),r}},{key:"JsonToSlashes",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};return Object.keys(t).forEach((function(o){if("object"===qt(t[o])){var i=e.JsonToSlashes(t[o],r+o+"/");n=Ft(Ft({},n),i),t[o]["@value"]&&(n[r+o]=t[o]["@value"])}else n[r+o]=t[o]})),n}},{key:"getValuesForPOST",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"DRIVER_OPTION_",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o={};for(var i in t)if(t.hasOwnProperty(i)){o[r+i]=t[i];for(var a=null,l=0;l<e.length;l++)if(e[l].name==i){a=e[l].type;break}if(!a){var u,s,c=i.split("/");c.length>1&&(u=c.pop(),s=c.pop());for(var p=0;p<e.length;p++)if(void 0!==u){if(e[p].name==u&&e[p].group_switch_name&&e[p].group_switch_name==s){a=e[p].type;break}}else if(e[p].name==i){a=e[p].type;break}}if(a&&("image"==a&&(a="binary"),o[r+i+"_ajxptype"]=a),n&&n[i])for(var f in n[i])n[i].hasOwnProperty(f)&&(o[r+i+"_"+f]=n[i][f])}var y=Object.keys(o);y.sort(),y.reverse();var h={};for(i in y.map((function(e){if(-1!==e.indexOf("/")&&!e.endsWith("_ajxptype")){for(var t,r=e+"_ajxptype",n=e.split("/"),i=n.shift();n.length>0;)t||(t=h),t[i]||(t[i]={}),t=t[i],i=n.shift();var a=o[r];if(delete o[r],t&&!t[i])if("boolean"===a){var l=o[e];t[i]="true"===l||1===l||!0===l}else"integer"===a||"integer-bytes"===a?t[i]=parseInt(o[e]):a&&a.startsWith("group_switch:")&&"string"==typeof o[e]?t[i]={group_switch_value:o[e]}:t[i]=o[e];else t&&a&&a.startsWith("group_switch:")&&(t[i].group_switch_value=o[e]);delete o[e]}})),h)if(h.hasOwnProperty(i)){var d=h[i];o[i+"_ajxptype"]&&0===o[i+"_ajxptype"].indexOf("group_switch:")&&!d.group_switch_value&&(d.group_switch_value=o[i]),o[i]=JSON.stringify(d),o[i+"_ajxptype"]="text/json"}for(var b in o)o.hasOwnProperty(b)&&(-1==b.indexOf("/")&&o[b]&&o[b+"_ajxptype"]&&o[b+"_ajxptype"].startsWith("group_switch:")&&"string"==typeof o[b]&&(o[b]=JSON.stringify({group_switch_value:o[b]}),o[b+"_ajxptype"]="text/json"),o.hasOwnProperty(b)&&b.endsWith("_group_switch")&&delete o[b]);return o}}],null&&Ut(n.prototype,null),o&&Ut(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();const Jt=require("create-react-class");var Kt=r.n(Jt);function Yt(e){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yt(e)}function Xt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,tr(n.key),n)}}function Zt(e,t){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zt(e,t)}function $t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qt(e){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qt(e)}function er(e,t,r){return(t=tr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tr(e){var t=function(e,t){if("object"!==Yt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Yt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Yt(t)?t:String(t)}var rr=r(16689),nr=r(580),or=r(9763),ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Qt(n);if(o){var r=Qt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Yt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $t(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return er($t(e=i.call.apply(i,[this].concat(r))),"computeSubPanelParameters",(function(){var t=e.props.paramAttributes.type.split(":").pop(),r=e.props.paramAttributes.name,n={},o=[];for(var i in e.props.parameters.map(function(e){if(e.group_switch_name)if(e.group_switch_name==t){var i=e.group_switch_value;n[i]||(n[i]={label:e.group_switch_label,fields:[],values:{},fieldsKeys:{}}),delete(e=or.deepCopy(e)).group_switch_name,e.name=r+"/"+e.name;var a=e.name,l=a;n[i].fieldsKeys[l]||(n[i].fields.push(e),n[i].fieldsKeys[l]=l,this.props.values&&this.props.values[a]&&(n[i].values[l]=this.props.values[a]))}else o.push(e)}.bind($t(e))),n)if(n.hasOwnProperty(i)){var a=n[i];a.fields=a.fields.concat(o)}return n})),er($t(e),"clearSubParametersValues",(function(t,r,n){var o=or.deepCopy(e.props.values),i={};for(var a in o)o.hasOwnProperty(a)&&0===a.indexOf(t+"/")&&(i[a]="");o[t]=r,n.map((function(e){"hidden"==e.type&&e.default&&!e.group_switch_name||e.group_switch_name==t?(o[e.name]=e.default,void 0!==i[e.name]&&delete i[e.name]):0===e.name.indexOf(t+"/")&&e.default&&(e.type&&e.type.startsWith("group_switch:"),o[e.name]=e.default)})),e.props.onChange(o,!0,i)})),er($t(e),"onChange",(function(t,r,n){e.props.onChange(t,!0,n)})),e}return t=a,(r=[{key:"render",value:function(){var e=this.props,t=e.variant,r=e.variantShowLegend,n=this.props.paramAttributes,o=this.props.values,i=n.name,a=this.computeSubPanelParameters(n),l=new Map;Object.keys(a).map((function(e){l.set(e,a[e].label)}));var u,s,c=function(e){this.clearSubParametersValues(i,e,a[e]?a[e].fields:[])}.bind(this),p=rr.createElement(ft,{key:i,name:i,className:"group-switch-selector",attributes:{name:i,choices:l,label:n.label+(r?" - "+n.description:""),mandatory:n.mandatory},value:o[i],onChange:c,displayContext:"form",disabled:this.props.disabled,ref:"subFormSelector",variant:this.props.variant});if(this.props.setHelperData&&this.props.checkHasHelper&&this.props.checkHasHelper(n.name,this.props.helperTestFor)){var f=function(){this.props.setHelperData({paramAttributes:n,values:o})}.bind(this);s=rr.createElement("span",{className:"mdi mdi-comment-question-outline",onClick:f})}if(o[i]&&a[o[i]]){var y=this.props,h=y.onAltTextSwitch,d=y.altTextSwitchIcon,b=y.altTextSwitchTip;u=rr.createElement(Ur,{onParameterChange:this.props.onParameterChange,applyButtonAction:this.props.applyButtonAction,disabled:this.props.disabled,ref:i+"-SUB",key:i+"-SUB",className:"sub-form",parameters:a[o[i]].fields,values:o,depth:this.props.depth+1,onChange:this.onChange,checkHasHelper:this.props.checkHasHelper,setHelperData:this.props.setHelperData,helperTestFor:o[i],accordionizeIfGroupsMoreThan:5,onAltTextSwitch:h,altTextSwitchIcon:d,altTextSwitchTip:b,variant:this.props.variant,variantShowLegend:this.props.variantShowLegend})}return rr.createElement("div",{className:"sub-form-group"},"v2"!==t&&rr.createElement("div",{className:"form-legend"},n.description," ",s),p,u)}}])&&Xt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(rr.Component);function ar(e){return ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ar(e)}function lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ur(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lr(Object(r),!0).forEach((function(t){sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sr(e,t,r){return(t=fr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cr(){return cr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cr.apply(this,arguments)}function pr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,fr(n.key),n)}}function fr(e){var t=function(e,t){if("object"!==ar(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ar(t)?t:String(t)}function yr(e,t){return yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},yr(e,t)}function hr(e){return hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hr(e)}er(ir,"propTypes",{paramAttributes:nr.object.isRequired,parameters:nr.array.isRequired,values:nr.object.isRequired,onChange:nr.func.isRequired});var dr="mdi mdi-chevron-up",br="mdi mdi-chevron-down",mr="mdi mdi-close",vr="mdi mdi-plus",gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hr(n);if(o){var r=hr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ar(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e,t){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),r=i.call(this,e,t);var n=e.subValues[e.parameters[0].name]||"";return r.state={toggled:!n},r}return t=a,(r=[{key:"render",value:function(){var e=this,t=this.props,r=(t.depth,t.onSwapUp),n=t.onSwapDown,o=t.onRemove,i=t.parameters,a=t.subValues,l=t.disabled,u=t.onAddValue,s=this.state.toggled,c=1===i.length,p=a[i[0].name]||React.createElement("span",{style:{color:"rgba(0,0,0,0.33)"}},"Empty Value"),f={width:36,height:36,padding:6};if(c){var y={opacity:.3},h=!o||l?y:{},d=!r||l?y:{},b=!n||l?y:{};return React.createElement("div",{style:{display:"flex",width:"100%"}},React.createElement("div",{style:{flex:1}},React.createElement(Ur,cr({},this.props,{tabs:null,values:a,onChange:null,className:"replicable-unique",depth:-1,style:{paddingBottom:0}}))),React.createElement("div",{style:{display:"flex",fontSize:24,paddingLeft:4,paddingTop:2}},u&&React.createElement("div",null,React.createElement("div",{className:vr,style:{padding:"8px 4px",cursor:"pointer"},onClick:u})),React.createElement("div",null,React.createElement("div",{className:mr,style:ur({padding:"8px 4px",cursor:"pointer"},h),onClick:o})),React.createElement("div",{style:{display:"flex",flexDirection:"column",padding:"0 4px"}},React.createElement("div",{className:dr,style:ur({height:16,cursor:"pointer"},d),onClick:r}),React.createElement("div",{className:br,style:ur({height:16,cursor:"pointer"},b),onClick:n}))))}return React.createElement(E.Paper,{zDepth:0,style:{border:"2px solid whitesmoke",marginBottom:8}},React.createElement("div",{style:{display:"flex",alignItems:"center"}},React.createElement("div",null,React.createElement(E.IconButton,{iconClassName:"mdi mdi-menu-"+(this.state.toggled?"down":"right"),iconStyle:{color:"rgba(0,0,0,.15)"},onClick:function(){e.setState({toggled:!e.state.toggled})}})),React.createElement("div",{style:{flex:1,fontSize:16}},p),React.createElement("div",null,u&&React.createElement(E.IconButton,{style:f,iconClassName:vr,onClick:u}),React.createElement(E.IconButton,{style:f,iconClassName:mr,onClick:o,disabled:!o||l}),React.createElement(E.IconButton,{style:f,iconClassName:dr,onClick:r,disabled:!r||l}),React.createElement(E.IconButton,{style:f,iconClassName:br,onClick:n,disabled:!n||l}))),s&&React.createElement(Ur,cr({},this.props,{tabs:null,values:a,onChange:null,className:"replicable-group",depth:-1})))}}])&&pr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(e.Component);function Or(e){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(e)}function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(Object(r),!0).forEach((function(t){Cr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Pr(){return Pr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pr.apply(this,arguments)}function Sr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tr(n.key),n)}}function Er(e,t){return Er=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Er(e,t)}function _r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xr(e){return xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xr(e)}function Cr(e,t,r){return(t=Tr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tr(e){var t=function(e,t){if("object"!==Or(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Or(t)?t:String(t)}var kr=r(16689),Rr=r(39455).IconButton,Dr=r(580),Ir=r(9763),Nr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Er(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=xr(n);if(o){var r=xr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Or(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _r(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Cr(_r(e=i.call.apply(i,[this].concat(r))),"buildSubValue",(function(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=0==n?"":"_"+n;return e.props.parameters.map((function(e){var n=e.name;void 0!==t[n+o]&&(r||(r={}),r[n]=t[n+o])})),r||!1})),Cr(_r(e),"indexedValues",(function(e){var t=0,r={};return e.map((function(e){var n=0==t?"":"_"+t;for(var o in e)e.hasOwnProperty(o)&&(r[o+n]=e[o]);t++})),r})),Cr(_r(e),"indexValues",(function(t,r){var n=e.indexedValues(t);if(e.props.onChange)if(r){var o={},i=t.length-1;e.props.parameters.map((function(e){o[e.name+(i>0?"_"+i:"")]=""})),e.props.onChange(n,!0,o)}else e.props.onChange(n,!0)})),Cr(_r(e),"instances",(function(){for(var t,r=[],n=0;t=e.buildSubValue(e.props.values,n);)n++,r.push(t);var o=e.props.parameters[0];if(!r.length&&"true"===o.replicationMandatory){var i={};e.props.parameters.map((function(e){i[e.name]=e.default||""})),r.push(i)}return r})),Cr(_r(e),"addRow",(function(){var t={},r=e.instances();e.props.parameters.map((function(e){t[e.name]=e.default||""})),r.push(t),e.indexValues(r)})),Cr(_r(e),"removeRow",(function(t){var r=e.instances(),n=r[t];(r=Ir.arrayWithout(e.instances(),t)).push(n),e.indexValues(r,!0)})),Cr(_r(e),"swapRows",(function(t,r){var n=e.instances(),o=n[r];n[r]=n[t],n[t]=o,e.indexValues(n)})),Cr(_r(e),"onChange",(function(t,r,n){var o=e.instances();o[t]=r,e.indexValues(o)})),Cr(_r(e),"onParameterChange",(function(t,r,n,o){var i=e.instances();i[t][r]=n,e.indexValues(i)})),e}return t=a,(r=[{key:"render",value:function(){var e=this,t=this.props,r=t.parameters,n=t.disabled,o=t.variant,i=r[0],a=i.replicationTitle||i.label,l="true"===i.replicationMandatory,u=this.instances(),s=u.length>1,c=u.map((function(t,r){var n,o,i;s&&r>0&&(n=function(){e.swapRows(r,r-1)}),s&&r<u.length-1&&(o=function(){e.swapRows(r,r+1)}),!s&&l||(i=function(){e.removeRow(r)});var a={onSwapUp:n,onSwapDown:o,onRemove:i,onParameterChange:function(t,n,o){e.onParameterChange(r,t,n,o)}};return l&&0===r&&(a.onAddValue=function(){return e.addRow()}),kr.createElement(gr,Pr({key:r},e.props,a,{subValues:t}))}));if(l)return kr.createElement("div",{className:"replicable-field",style:{marginBottom:14}},c);var p=c.length?{}:{backgroundColor:"whitesmoke",borderRadius:4},f={marginBottom:14};return"v2"===o&&(p=jr(jr({},p),{},{height:52,backgroundColor:"#f6f6f8",marginTop:8,borderRadius:"4px 4px 0 0"}),c.length||(p=jr(jr({},p),{},{borderBottom:"1px solid rgba(158,158,158,.3)"}),f={height:58})),kr.createElement("div",{className:"replicable-field",style:f},kr.createElement("div",{style:jr({display:"flex",alignItems:"center"},p)},kr.createElement("div",{className:"title",style:{fontSize:16,flex:1,paddingLeft:8}},a),kr.createElement(Rr,{key:"add",iconClassName:"mdi mdi-plus-box",tooltipPosition:"bottom-left",style:{padding:14},iconStyle:{fontSize:20,color:"#9e9e9e"},tooltip:"Add value",onClick:function(){return e.addRow()},disabled:n})),c)}}])&&Sr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(kr.Component);Cr(Nr,"propTypes",{parameters:Dr.array.isRequired,values:Dr.object,onChange:Dr.func,disabled:Dr.bool,binary_context:Dr.string,depth:Dr.number});var Ar=r(580),Mr=r.n(Ar);function Vr(e){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vr(e)}function Br(e){return function(e){if(Array.isArray(e))return Lr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Lr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lr(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Hr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fr(Object(r),!0).forEach((function(t){qr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function qr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==Vr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Vr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Vr(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gr(){return Gr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gr.apply(this,arguments)}const Ur=Kt()({displayName:"FormPanel",_hiddenValues:{},_internalValid:null,_parametersMetadata:null,propTypes:{parameters:Mr().array.isRequired,values:Mr().object,onParameterChange:Mr().func,onChange:Mr().func,onValidStatusChange:Mr().func,disabled:Mr().bool,binary_context:Mr().string,depth:Mr().number,header:Mr().object,footer:Mr().object,additionalPanes:Mr().shape({top:Mr().array,bottom:Mr().array}),tabs:Mr().array,onTabChange:Mr().func,accordionizeIfGroupsMoreThan:Mr().number,onScrollCallback:Mr().func,limitToGroups:Mr().array,skipFieldsTypes:Mr().array,setHelperData:Mr().func,checkHasHelper:Mr().func,helperTestFor:Mr().string},externallySelectTab:function(e){this.setState({tabSelectedIndex:e})},getInitialState:function(){return this.props.onTabChange?{tabSelectedIndex:0}:{}},getDefaultProps:function(){return{depth:0,values:{}}},componentWillReceiveProps:function(e){JSON.stringify(e.parameters)!==JSON.stringify(this.props.parameters)&&(this._internalValid=null,this._hiddenValues={},this._parametersMetadata={}),e.values&&e.values!==this.props.values&&this.checkValidStatus(e.values)},getValues:function(){return this.props.values},onParameterChange:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=Ne().deepCopy(this.getValues());this.props.onParameterChange&&this.props.onParameterChange(e,t,r,n),n&&(this._parametersMetadata||(this._parametersMetadata={}),this._parametersMetadata[e]=n),o[e]=t,this.onChange(o,!0)},onChange:function(e,t,r){if(this.props.onChange){for(var n in this._hiddenValues)!this._hiddenValues.hasOwnProperty(n)||void 0!==e[n]||r&&void 0!==r[n]||(e[n]=this._hiddenValues[n]);this.props.onChange(e,t,r)}this.checkValidStatus(e)},onSubformChange:function(e,t,r){var n=Ne().mergeObjectsRecursive(this.getValues(),e);if(r)for(var o in r)r.hasOwnProperty(o)&&void 0!==n[o]&&(delete n[o],void 0!==this._hiddenValues[o]&&delete this._hiddenValues[o]);this.onChange(n,t,r)},onSubformValidStatusChange:function(e,t){(e!==this._internalValid||this.props.forceValidStatusCheck)&&this.props.onValidStatusChange&&this.props.onValidStatusChange(e,t),this._internalValid=e},applyButtonAction:function(e,t){this.props.applyButtonAction&&this.props.applyButtonAction(e,t)},getValuesForPOST:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DRIVER_OPTION_";return Wt.getValuesForPOST(this.props.parameters,e,t,this._parametersMetadata)},checkValidStatus:function(e){var t,r=[];this.props.parameters.map(function(t){["string","textarea","password","integer","integer-bytes"].indexOf(t.type)>-1&&("true"===t.mandatory||!0===t.mandatory)&&(e&&e.hasOwnProperty(t.name)&&void 0!==e[t.name]&&""!==e[t.name]||r.push(t)),"valid-password"!==t.type&&"valid-login"!==t.type||!this.refs["form-element-"+t.name]||this.refs["form-element-"+t.name].isValid()||r.push(t)}.bind(this)),this._internalValid,((t=!r.length)!==this._internalValid||this.props.forceValidStatusCheck)&&this.props.onValidStatusChange&&this.props.onValidStatusChange(t,r),this._internalValid=t},componentDidMount:function(){this.checkValidStatus(this.props.values)},renderGroupHeader:function(e,r,n,o){var i={key:"group-"+e};if(r){var a=this.state&&this.state.currentActiveGroup?this.state.currentActiveGroup:null;i.className="group-label-"+(o?"active":"inactive"),i.onClick=function(){this.setState({currentActiveGroup:a!==n?n:null})}.bind(this),e=[t().createElement("span",{key:"toggler",className:"group-active-toggler mdi-mdi-chevron-"+(a===n?"down":"right")}),e]}return t().createElement("h"+(3+this.props.depth),i,e)},render:function(){var r=this,n=[],o=["__DEFAULT__"];n.__DEFAULT__={FIELDS:[]};var i={},a=this.props,u=a.parameters,s=a.values,c=a.skipFieldsTypes,p=a.disabled,f=a.binary_context,y=a.variant,h=a.variantShowLegend,d=a.panelStyle,b=this.props,m=b.altTextSwitchIcon,v=b.altTextSwitchTip,g=b.onAltTextSwitch;u.map(function(r){var a,d=this,b=r.type,O=r.name,w=r.replicationGroup;if(!(c&&c.indexOf(b)>-1||r.group_switch_name)){var j=r.group||"__DEFAULT__";if(n[j]||(o.push(j),n[j]={FIELDS:[],LABEL:j}),w){i[w]||(i[w]={PARAMS:[],GROUP:j,POSITION:n[j].FIELDS.length},n[j].FIELDS.push("REPLICATION:"+w));var P=Ne().deepCopy(r);delete P.replicationGroup,delete P.group,i[w].PARAMS.push(P)}else{if(0===b.indexOf("group_switch:"))a=t().createElement(ir,Gr({},this.props,{onChange:this.onSubformChange,paramAttributes:r,parameters:u,values:s,key:O,onScrollCallback:null,limitToGroups:null,onValidStatusChange:this.onSubformValidStatusChange}));else if("hidden"!==b){var S,E=this.props,_=E.setHelperData,x=E.checkHasHelper,C=E.helperTestFor;if(_&&x&&x(r.name,C)){var T=function(){_({paramAttributes:r,values:s,postValues:this.getValuesForPOST(s),applyButtonAction:this.applyButtonAction},C)}.bind(this);S=t().createElement("span",{className:"mdi mdi-comment-question-outline",onClick:T})}var k=!1,R="form-legend",D=r.errorText,I=r.warningText,N=r.mandatory;D?R="form-legend mandatory-missing":I?R="form-legend warning-message":!N||"true"!==N&&!0!==N||-1===["string","textarea","image","integer","integer-bytes"].indexOf(b)||s[O]||(k=!0,R="form-legend mandatory-missing");var A=r.description,M=r.readonly,V=r.multiple,B=I||A,L=r.label;h&&"boolean"!==r.type&&(L=t().createElement(e.Fragment,null,L," ",t().createElement("span",null,"- ",B)));var F={ref:"form-element-"+O,attributes:Hr(Hr({},r),{},{label:L}),name:O,value:s[O],onChange:function(e,t,r){d.onParameterChange(O,e,t,r)},disabled:p||M,multiple:V,binary_context:f,displayContext:"form",applyButtonAction:this.applyButtonAction,variant:y,variantShowLegend:h,errorText:k?l().getInstance().MessageHash[621]:D||null,onAltTextSwitch:g,altTextSwitchIcon:m,altTextSwitchTip:v};a=t().createElement("div",{key:O,className:"form-entry-"+b},"v2"!==y&&t().createElement("div",{className:R},B," ",S),"v2"===y&&"legend"===r.type&&t().createElement("div",{style:{padding:"6px 3px",color:"#616161",fontSize:14}},B," ",S),Wt.createFormElement(F))}else this._hiddenValues[O]=void 0===s[O]?r.default:s[O];a&&n[j].FIELDS.push(a)}}}.bind(this)),Object.keys(i).forEach((function(e){var o=i[e];n[o.GROUP].FIELDS[o.POSITION]=t().createElement(Nr,Gr({},r.props,{key:"replication-group-"+o.PARAMS[0].name,onChange:r.onSubformChange,onParameterChange:null,values:r.getValues(),depth:r.props.depth+1,parameters:o.PARAMS,applyButtonAction:r.applyButtonAction,onScrollCallback:null}))}));var O=[],w=this.props.accordionizeIfGroupsMoreThan&&o.length>this.props.accordionizeIfGroupsMoreThan,j=this.state&&this.state.currentActiveGroup?this.state.currentActiveGroup:0;if(o.map(function(e,r){if(!this.props.limitToGroups||-1!==this.props.limitToGroups.indexOf(e)){var i,a=n[e],l="pydio-form-group",u=!1;w&&(u=j===r,l+=r===j?" form-group-active":" form-group-inactive"),a.FIELDS.length&&(!a.LABEL||this.props.skipFieldsTypes&&this.props.skipFieldsTypes.indexOf("GroupHeader")>-1||(i=this.renderGroupHeader(a.LABEL,w,r,u)),0===this.props.depth?(l+=" z-depth-1",O.push(t().createElement(E.Paper,{className:l,key:"pane-"+e},0===r&&this.props.header?this.props.header:null,i,t().createElement("div",null,a.FIELDS),r===o.length-1&&this.props.footer?this.props.footer:null))):O.push(t().createElement("div",{className:l,key:"pane-"+e},0===r&&this.props.header?this.props.header:null,i,t().createElement("div",null,a.FIELDS),r===o.length-1&&this.props.footer?this.props.footer:null)))}}.bind(this)),this.props.additionalPanes){var P={top:[],bottom:[]},S=this.props.depth,_=0;["top","bottom"].forEach((function(e){(r.props.additionalPanes[e]||[]).map((function(r){0===S?P[e].push(t().createElement(E.Paper,{className:"pydio-form-group additional",key:"other-pane-"+_},r)):P[e].push(t().createElement("div",{className:"pydio-form-group additional",key:"other-pane-"+_},r)),_++}))})),O=[].concat(Br(P.top),Br(O),Br(P.bottom))}if(this.props.tabs){var x=this.props.className,C=0,T=0,k=this.props.tabs.map(function(e){var r=e.label,n=e.groups;e.selected&&(C=T);var o=n.map((function(e){return O[e]?O[e]:null}));return T++,t().createElement(E.Tab,{label:r,key:r,value:this.props.onTabChange?T-1:void 0},t().createElement("div",{className:(x?x+" ":" ")+"pydio-form-panel"+(o.length%2?" form-panel-odd":"")},o))}.bind(this));return void 0!==this.state.tabSelectedIndex&&(C=this.state.tabSelectedIndex),t().createElement("div",{className:"layout-fill vertical-layout tab-vertical-layout"},t().createElement(E.Tabs,{ref:"tabs",initialSelectedIndex:C,value:this.props.onTabChange?C:void 0,onChange:this.props.onTabChange?function(e){r.setState({tabSelectedIndex:e}),r.props.onTabChange(e)}:void 0,style:{flex:1,display:"flex",flexDirection:"column"},contentContainerStyle:{flex:1,overflowY:"auto"}},k))}return t().createElement("div",{className:(this.props.className?this.props.className+" ":" ")+"pydio-form-panel"+(O.length%2?" form-panel-odd":""),onScroll:this.props.onScrollCallback,style:Hr({},d)},O)}});function zr(e){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zr(e)}function Wr(){return Wr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wr.apply(this,arguments)}function Jr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$r(n.key),n)}}function Kr(e,t){return Kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Kr(e,t)}function Yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xr(e){return Xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xr(e)}function Zr(e,t,r){return(t=$r(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $r(e){var t=function(e,t){if("object"!==zr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==zr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===zr(t)?t:String(t)}var Qr=r(16689),en=r(10757).requireLib("boot").AsyncComponent,tn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xr(n);if(o){var r=Xr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===zr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Yr(e)}(this,e)});function a(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Zr(Yr(e=i.call.apply(i,[this].concat(r))),"closeHelper",(function(){e.props.close()})),e}return t=a,(r=[{key:"render",value:function(){var e;if(this.props.helperData){var t=Wt.getHelpersCache()[this.props.helperData.pluginId].namespace;e=Qr.createElement("div",null,Qr.createElement("div",{className:"helper-title"},Qr.createElement("span",{className:"helper-close mdi mdi-close",onClick:this.closeHelper}),"Pydio Companion"),Qr.createElement("div",{className:"helper-content"},Qr.createElement(en,Wr({},this.props.helperData,{namespace:t,componentName:"Helper",paramName:this.props.helperData.paramAttributes.name}))))}return Qr.createElement("div",{className:"pydio-form-helper"+(e?" helper-visible":" helper-empty"),style:{zIndex:1}},e)}}])&&Jr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(Qr.Component);Zr(tn,"propTypes",{helperData:Mr().object,close:Mr().func.isRequired});var rn={Manager:Wt,InputText:R,ValidPassword:he,InputBoolean:oe,InputInteger:Oe,InputIntegerBytes:U,InputSelectBox:ft,AutocompleteBox:_t,AutocompleteTree:Bt,InputImage:Ue,FormPanel:Ur,PydioHelper:tn,FileDropZone:De,createFormElement:Wt.createFormElement}})(),window.PydioForm=n})();