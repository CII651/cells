(()=>{"use strict";var e={105:e=>{e.exports=require("color")},345:e=>{e.exports=require("react-textfit")}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{r.r(o),r.d(o,{DLTemplate:()=>ee,DropZoneMinisite:()=>oe,FileMinisite:()=>re,FilmStripMinisite:()=>ie,FolderMinisite:()=>te});const e=require("react");var t=r.n(e);const i=require("prop-types");var n=r.n(i);const a=require("create-react-class");var s=r.n(a);const l=require("pydio");var c=r.n(l);const p=require("material-ui/styles"),d=require("react-redux"),u=require("redux"),y=require("material-ui"),m=require("pydio/util/path");var f=r.n(m);const h=require("pydio/util/dom");var g=r.n(h);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return(t=k(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(){return S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},S.apply(this,arguments)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,k(o.key),o)}}function O(e,t,r){return t&&w(e.prototype,t),r&&w(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function k(e){var t=function(e,t){if("object"!==b(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==b(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===b(t)?t:String(t)}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=M(e);if(t){var i=M(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return function(e,t){if(t&&("object"===b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function M(e){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},M(e)}var T=r(345).Textfit,N=r(105),R=c().requireLib("workspaces"),D=R.Breadcrumb,F=R.SearchForm,L=R.MainFilesList,I=R.Editor,H=R.EditionPanel,q=c().requireLib("components"),z=q.ContextMenu,A=q.IconButtonMenu,B=q.Toolbar,W=q.ListPaginator,U=q.ClipboardTextField,G=c().requireLib("boot").withProgressiveBg,V=c().requireLib("hoc"),Z=V.EditorActions,J=V.dropProvider,K=function(e){return function(r){return function(o){_(n,o);var i=j(n);function n(){return C(this,n),i.apply(this,arguments)}return O(n,[{key:"componentDidMount",value:function(){this.detectFirstNode()}},{key:"detectFirstNode",value:function(){var t=this,r=this.props.pydio.getContextHolder();if(r.getSelectedNodes().length)this.state&&this.state.node||this.setState({node:r.getSelectedNodes()[0]});else{var o=r.getRootNode().getFirstChildIfExists();o?(r.setSelectedNodes([o],"dataModel"),this.setState({node:o})):setTimeout((function(){return t.detectFirstNode()}),1e3)}e&&r.observe("selection_changed",function(){var e=r.getSelectedNodes();e.length?this.setState({node:e[0]}):this.setState({node:null})}.bind(this))}},{key:"render",value:function(){return t().createElement(r,S({},this.props,this.state))}}]),n}(t().PureComponent)}},Q=function(){return function(e){return function(r){_(i,r);var o=j(i);function i(e){var t;C(this,i),t=o.call(this,e);var r=e.pydio;return t.state={emptyUser:!r.user},t}return O(i,[{key:"componentDidMount",value:function(){var e=this,t=this.props.pydio;this._obs=function(){return e.setState({emptyUser:!t.user})},t.observe("repository_list_refreshed",this._obs)}},{key:"componentWillUnmount",value:function(){this.props.pydio.stopObserving("repository_list_refreshed",this._obs)}},{key:"render",value:function(){return t().createElement(e,S({},this.props,this.state))}}]),i}(t().PureComponent)}},X=function(e){_(o,e);var r=j(o);function o(){return C(this,o),r.apply(this,arguments)}return O(o,[{key:"render",value:function(){var e,r=this.props.pydio,o=r.Registry.getPluginConfigs("action.advanced_settings").get("CUSTOM_MINISITE_LOGO");return o||(o=r.Parameters.get("ajxpResourcesFolder")+"/themes/common/images/PydioLogoSquare.png"),o&&(e=0===o.indexOf("plug/")?o:r.Parameters.get("ENDPOINT_REST_API")+"/frontend/binaries/GLOBAL/"+o),t().createElement("img",{src:e,style:this.props.style})}}]),o}(t().Component),Y=function(e){_(o,e);var r=j(o);function o(){return C(this,o),r.apply(this,arguments)}return O(o,[{key:"render",value:function(){var e,r=this.props,o=r.mode,i=r.style;return"false"===r.aboutString?null:("insert"===o?e={textAlign:"right",padding:"6px 16px",backgroundColor:"var(--md-sys-color-surface-variant)",color:"var(--md-sys-color-on-surface-variant)"}:"overlay"===o?e={position:"absolute",bottom:0,right:0,color:"rgba(255,255,255,0.8)",padding:"6px 16px"}:"block"===o&&(e={textAlign:"center",padding:"6px 16px",color:"rgba(255,255,255)"}),t().createElement("div",{style:E(E({},e),i)},t().createElement("a",{href:"https://pydio.com",style:{fontWeight:500,color:e.color}},"Pydio Cells")," - secure file sharing"))}}]),o}(t().Component),$=s()({displayName:"StandardLayout",childContextTypes:{messages:n().object,getMessage:n().func,showSearchForm:n().bool},getChildContext:function(){var e=this.props.pydio.MessageHash;return{messages:e,getMessage:function(t){try{return e[t]||t}catch(e){return t}}}},getDefaultProps:function(){return{minisiteMode:"embed",uniqueNode:!0}},render:function(){var e=this.props,r=e.showSearchForm,o=e.uniqueNode,i=e.skipDisplayToolbar,n=e.bgStyle,a=e.emptyUser,s=e.pydio,l=e.muiTheme,c={appBarStyle:{zIndex:1,backgroundColor:N(l.palette.primary1Color).alpha(.5).toString(),display:"flex",alignItems:"center",height:64,padding:"0 10px"},buttonsStyle:{color:N(l.appBar.textColor).alpha(.9).toString()}};if(a)return t().createElement("div",{className:"vertical_fit vertical_layout",style:n});var p=[];return o?p.push("minisite_toolbar"):(p.push("info_panel"),i||p.push("display_toolbar")),t().createElement("div",{className:"vertical_fit vertical_layout",style:n},t().createElement(y.Paper,{zDepth:1,rounded:!1,style:c.appBarStyle},t().createElement(X,{pydio:this.props.pydio,style:{height:40}}),t().createElement("div",{id:"workspace_toolbar",style:{display:"flex",flex:1,overflow:"hidden"}},t().createElement(D,S({},this.props,{rootStyle:{padding:"0 14px",height:36,lineHeight:"36px",maxWidth:null}}))),t().createElement("div",{style:{position:"relative"}},t().createElement("div",{id:"main_toolbar",style:{display:"flex",padding:"0 8px"}},!o&&t().createElement(A,S({},this.props,{id:"create-button-menu",toolbars:["upload","create"],buttonTitle:this.props.pydio.MessageHash[198],buttonClassName:"mdi mdi-folder-plus",buttonStyle:{color:"white"},controller:this.props.pydio.Controller})),t().createElement("div",{style:{flex:1}}),t().createElement(W,{id:"paginator-toolbar",dataModel:this.props.pydio.getContextHolder(),toolbarDisplay:!0}),t().createElement(B,S({},this.props,{id:"main-toolbar",toolbars:p,groupOtherList:o?[]:["change_main","more","change","remote"],renderingType:"icon-font",buttonStyle:c.buttonsStyle})))),r&&s.user&&t().createElement(F,S({},this.props,{uniqueSearchScope:s.user.getActiveRepositoryObject().getSlug(),style:{marginTop:2,marginRight:3}}))),this.props.children,t().createElement("span",{className:"context-menu"},t().createElement(z,{pydio:this.props.pydio})))}});$=J($=G($));var ee=function(e){_(o,e);var r=j(o);function o(){return C(this,o),r.apply(this,arguments)}return O(o,[{key:"triggerDL",value:function(){this.setState({downloadStarted:!0}),setTimeout(function(){this.props.pydio.Controller.fireAction("download"),setTimeout(function(){this.setState({downloadStarted:!1})}.bind(this),3500)}.bind(this),100)}},{key:"componentDidMount",value:function(){var e=this.props.pydio;e.user&&e.user.activeRepository?this.setState({repoObject:e.user.repositories.get(e.user.activeRepository)}):e.observe("repository_list_refreshed",function(e){var t=e.list,r=e.active;if(t&&t.has(r)){var o=t.get(r);this.setState({repoObject:o})}}.bind(this))}},{key:"renderMui3",value:function(){var e,r=this.props,o=r.bgStyle,i=r.node,n=r.emptyUser,a=r.muiTheme,s=r.pydio,l=a.palette.mui3,c={main:E(E({},o),{},{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%"}),block:{cursor:"pointer",maxWidth:420,minWidth:320,margin:"0 auto",background:l.surface,borderRadius:a.borderRadius,boxShadow:"0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23)"},cardImage:{margin:"0 auto",display:"flex",alignItems:"center",justifyContent:"center",background:l["surface-2"],borderRadius:a.borderRadius,padding:"60px 80px"},logo:{width:160,margin:"-50px auto 0"},filename:{fontSize:20,wordBreak:"break-all",fontWeight:500},fileIcon:{fontSize:80,color:l.primary},dlIcon:{position:"absolute",top:40,left:25,fontSize:30,color:l["inverse-primary"],transition:g().getBeziersTransition()}};if(n)return t().createElement("div",{className:"vertical_fit",style:E(E({},c.main),{},{width:"100%"})});this.state&&this.state.repoObject&&(e=this.state.repoObject.getLabel());var p,d=null,u=s.MessageHash[466];if(i){d=this.triggerDL.bind(this);var y=f().roundFileSize(i.getMetadata().get("bytesize"));u="".concat(MessageHash["share_center.231"]," (").concat(s.MessageHash[503],": ").concat(y,").")}return this.state&&this.state.downloadStarted&&(p=!0),t().createElement("div",{style:c.main,id:"main-background"},t().createElement(X,{pydio:this.props.pydio,style:c.logo}),t().createElement("div",{className:["download-block"].join(" "),onClick:d,style:c.block},t().createElement("div",{style:c.cardImage},t().createElement("div",{style:{position:"relative"}},t().createElement("span",{style:c.fileIcon,className:"mdi mdi-file"}),t().createElement("span",{style:c.dlIcon,className:"mdi mdi-download"}))),t().createElement("div",{style:{padding:16,color:l["on-surface"]}},t().createElement("span",{style:c.filename},t().createElement(T,{min:14,max:16,perfectFit:!1,mode:"single"},e)),t().createElement("div",{style:{fontSize:13,paddingTop:8,color:l.outline}},u)),t().createElement("div",{style:{display:"flex",justifyContent:"flex-start",padding:16,opacity:!i||p?.5:1}},t().createElement("div",{style:{color:l["on-primary"],backgroundColor:l.primary,borderRadius:20,padding:"8px 16px",fontWeight:500}},"Start Download"))),t().createElement(Y,S({mode:"block"},this.props)))}},{key:"render",value:function(){var e=this,r=this.props,o=r.bgStyle,i=r.node,n=r.emptyUser;if("mui3"===r.muiTheme.userTheme)return this.renderMui3();var a,s={main:E(E({},o),{},{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%"}),block:{cursor:"pointer",width:300,margin:"0 auto",textAlign:"center",background:"rgba(255, 255, 255, 0.91)",padding:20,borderRadius:4,boxShadow:"0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23)"},logo:{width:230,margin:"-50px auto 0"},filename:{fontSize:22,lineHeight:"22px",wordBreak:"break-all"},fileIcon:{fontSize:180,color:this.props.muiTheme.palette.primary1Color},dlIcon:{position:"absolute",top:90,left:80,fontSize:60,color:"#f4f4f4",transition:g().getBeziersTransition()}};if(n)return t().createElement("div",{className:"vertical_fit",style:E(E({},s.main),{},{width:"100%"})});this.state&&this.state.repoObject&&(a=this.state.repoObject.getLabel());var l=null,c=t().createElement("div",{style:{fontSize:13,lineHeight:"18px"}},this.props.pydio.MessageHash[466]);if(i){l=this.triggerDL.bind(this);var p=i.getMetadata().get("bytesize");c=t().createElement("div",{style:{fontSize:13,lineHeight:"18px",color:"rgba(0,0,0,.43)"}},t().createElement("div",{style:{display:"flex"}},t().createElement("div",{style:{flex:1,textAlign:"right",paddingRight:6,fontWeight:500}},this.props.pydio.MessageHash[503]),t().createElement("div",{style:{flex:1,textAlign:"left",color:"rgba(0,0,0,.73)"}},f().roundFileSize(p))),t().createElement("div",{style:{fontSize:12,marginTop:10}},this.props.pydio.MessageHash["share_center.231"]))}this.state&&this.state.downloadStarted&&(s.dlIcon.opacity=.3);var d,u=this.props.pydio.Controller.getActionByName("share_current_page");return u&&!u.deny&&(d=t().createElement("a",{style:{display:"block",textAlign:"center",padding:12,cursor:"pointer"},onClick:function(){e.setState({displayShareLink:!0})}},u.options.text)),t().createElement("div",{style:s.main},t().createElement(X,{pydio:this.props.pydio,style:s.logo}),t().createElement("div",{className:["download-block"].join(" "),onClick:l,style:s.block},t().createElement("span",{style:s.filename},t().createElement(T,{min:12,max:25,perfectFit:!1,mode:"single"},a)),t().createElement("div",{style:{width:220,margin:"0 auto",position:"relative"}},t().createElement("span",{style:s.fileIcon,className:"mdi mdi-file"}),t().createElement("span",{style:s.dlIcon,className:"mdi mdi-download"})),c),this.state&&this.state.displayShareLink&&t().createElement("div",{style:{width:267,margin:"10px auto",backgroundColor:"rgba(255, 255, 255, 0.85)",padding:"0px 10px",borderRadius:2}},t().createElement(U,{floatingLabelText:u.options.text,inputValue:document.location.href,getMessage:function(t){return e.props.pydio.MessageHash[t]},buttonStyle:{right:-8,bottom:9}})),t().createElement(Y,S({mode:"block"},this.props)),!(this.state&&this.state.displayShareLink)&&d)}}]),o}(t().Component),te=function(e){_(o,e);var r=j(o);function o(){return C(this,o),r.apply(this,arguments)}return O(o,[{key:"render",value:function(){return t().createElement($,S({},this.props,{uniqueNode:!1,showSearchForm:this.props.pydio.getPluginConfigs("action.share").get("SHARED_FOLDER_SHOW_SEARCH")}),t().createElement("div",{style:{backgroundColor:"var(--md-sys-color-surface)",paddingTop:8},className:"layout-fill vertical-layout"},t().createElement(L,S({ref:"list"},this.props,{dataModel:this.props.pydio.getContextHolder()})),t().createElement(Y,S({mode:"insert"},this.props))),t().createElement(H,this.props))}}]),o}(t().Component),re=function(e){_(o,e);var r=j(o);function o(){return C(this,o),r.apply(this,arguments)}return O(o,[{key:"componentWillReceiveProps",value:function(e){var t=this,r=e.pydio,o=e.node,i=e.dispatch;if(o){r.UI.registerEditorOpener(this);var n=f().getAjxpMimeType(o),a=r.Registry.findEditorsForMime(n,!1);if(a.length&&a[0].openable){var s=a[0];r.Registry.loadEditorResources(s.resourcesManager,(function(){var e;if(e=FuncUtils.getFunctionByName(s.editorClass,window)){var n=i(Z.tabCreate({id:o.getLabel(),title:o.getLabel(),url:o.getPath(),icon:PydioWorkspaces.FilePreview,Editor:e.Editor,Controls:e.Controls,metadata:o.getMetadata(),readonly:"true"===o.getMetadata().get("node_readonly"),pydio:r,node:o,editorData:s,registry:r.Registry})).id;i(Z.editorSetActiveTab(n))}else t.setState({error:"Cannot find editor component ("+s.editorClass+")!"})}))}}}},{key:"openEditorForNode",value:function(e,t){var r=this,o=this.props.dispatch;pydio.Registry.loadEditorResources(t.resourcesManager,(function(){var i;(i=FuncUtils.getFunctionByName(t.editorClass,window))?o(Z.tabModify({id:e.getLabel(),title:e.getLabel(),url:e.getPath(),icon:PydioWorkspaces.FilePreview,Editor:i.Editor,Controls:i.Controls,metadata:e.getMetadata(),readonly:"true"===e.getMetadata().get("node_readonly"),pydio,node:e,editorData:t,registry:pydio.Registry})):r.setState({error:"Cannot find editor component ("+t.editorClass+")!"})}))}},{key:"componentWillUnmount",value:function(){pydio.UI.unregisterEditorOpener(this)}},{key:"render",value:function(){return t().createElement($,S({},this.props,{uniqueNode:!0,skipDisplayToolbar:!0}),t().createElement("div",{className:"editor_container vertical_layout vertical_fit",style:{backgroundColor:"#424242"}},t().createElement(I,{displayToolbar:!1,style:{display:"flex",flex:1}}),t().createElement(Y,S({mode:"overlay"},this.props))))}}]),o}(t().Component),oe=function(e){_(o,e);var r=j(o);function o(){return C(this,o),r.apply(this,arguments)}return O(o,[{key:"render",value:function(){return t().createElement($,this.props,t().createElement("div",{className:"vertical_fit vertical_layout",style:{backgroundColor:"var(--md-sys-color-surface)"}},t().createElement("div",{className:"vertical_fit vertical_layout",style:{margin:8,padding:"8px 0",marginBottom:2,border:"2px dashed #CFD8DC",borderRadius:12}},t().createElement(L,S({ref:"list",dataModel:this.props.pydio.getContextHolder()},this.props))),t().createElement(Y,S({mode:"insert",style:{backgroundColor:"var(--md-sys-color-surface-variant)"}},this.props))),t().createElement(H,this.props))}}]),o}(t().Component),ie=function(e){_(o,e);var r=j(o);function o(){return C(this,o),r.apply(this,arguments)}return O(o,[{key:"render",value:function(){return t().createElement($,S({},this.props,{uniqueNode:!1,showSearchForm:this.props.pydio.getPluginConfigs("action.share").get("SHARED_FOLDER_SHOW_SEARCH")}),t().createElement("div",{style:{backgroundColor:"var(--md-sys-color-surface)",paddingTop:8},className:"layout-fill vertical-layout"},t().createElement(L,S({ref:"list"},this.props,{dataModel:this.props.pydio.getContextHolder(),displayMode:"masonry"})),t().createElement(Y,S({mode:"insert"},this.props))),t().createElement(H,this.props))}}]),o}(t().Component);te=(0,u.compose)((0,p.muiThemeable)(),Q())(te),re=(0,u.compose)(Q(),K(!1),(0,p.muiThemeable)(),(0,d.connect)())(re),ee=(0,u.compose)((0,p.muiThemeable)(),K(!1),Q())(G(ee)),oe=(0,u.compose)((0,p.muiThemeable)(),Q())(oe),ie=(0,u.compose)(Q(),K(!0),(0,p.muiThemeable)(),(0,d.connect)())(ie)})(),window.ShareTemplates=o})();