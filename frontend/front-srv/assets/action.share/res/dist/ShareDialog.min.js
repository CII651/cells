!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).ShareDialog=e()}(function(){return function n(o,i,a){function l(t,e){if(!i[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(s)return s(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=i[t]={exports:{}},o[t][0].call(r.exports,function(e){return l(o[t][1][e]||e)},r,r.exports,n,o,i,a)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,r){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==s(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===s(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(l){var e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();var r,n,o=function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")};function i(){var e=this,t=i;if(e instanceof t)return o.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}var t=i,e=[{key:"render",value:function(){var e=this.context,t=e.messages,r=e.getMessage,e=e.isReadonly;return d.createElement(l,u({},this.props,{messages:t,getMessage:r,isReadonly:e}))}}],a=void 0;return e&&c(t.prototype,e),a&&c(t,a),Object.defineProperty(t,"prototype",{writable:!1}),i}(d.Component);return e.contextTypes={messages:n.object,getMessage:n.func,isReadonly:n.func},e};var n=e("prop-types"),d=e("react");t.exports=r.default},{"prop-types":"prop-types",react:"react"}],2:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var v=i(e("react")),n=i(e("pydio")),w=i(e("./EditCellDialog")),a=i(e("pydio/model/cell")),l=i(e("pydio/http/resources-manager")),O=e("material-ui"),s=i(e("../main/ShareHelper"));function i(e){return e&&e.__esModule?e:{default:e}}function P(){return(P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=n.default.requireLib("components"),k=e.GenericCard,E=e.GenericLine,j=e.QuotaUsageLine,n=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,o=f(i);function i(e){var r;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(r=o.call(this,e)).state={edit:!1,model:new a.default,loading:!0},r._observer=function(){r.forceUpdate()},l.default.loadClass("PydioActivityStreams").then(function(e){r.setState({asLib:e})}),l.default.loadClass("PydioCoreActions").then(function(e){r.setState({coreActionsLib:e})});var n=r.props.rootNode;return n&&(n.getMetadata().has("virtual_root")?n.isLoaded()?(r.state.rootNodes=[],n.getChildren().forEach(function(e){return r.state.rootNodes.push(e)})):(n.observe("loaded",function(){var t=[];n.getChildren().forEach(function(e){return t.push(e)}),r.setState({rootNodes:t})}),n.load()):r.state.rootNodes=[n]),r}return t=i,(e=[{key:"componentDidMount",value:function(){var t=this,e=this.props,r=e.pydio,e=e.cellId;r.user.activeRepository===e?r.user.getActiveRepositoryAsCell().then(function(e){t.setState({model:e,loading:!1}),e.observe("update",t._observer)}):(this.state.model.observe("update",function(){t.setState({loading:!1}),t.forceUpdate()}),this.state.model.load(this.props.cellId))}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update",this._observer)}},{key:"usersInvitations",value:function(e){s.default.sendCellInvitation(this.props.node,this.state.model,e)}},{key:"render",value:function(){function e(e){return i.MessageHash["share_center."+e]}var t,r=this,n=this.props,o=n.mode,i=n.pydio,n=n.editorOneColumn,a=this.state,l=a.edit,s=a.model,u=a.asLib,c=a.coreActionsLib,f=a.rootNodes,a=a.loading,p={width:350,minHeight:270};if(l)p=n?{width:350,height:500}:{width:700,height:500},t=v.default.createElement(w.default,P({},this.props,{model:s,sendInvitations:this.usersInvitations.bind(this),editorOneColumn:n}));else if(s){var d,y,m,l=(l=s.getRootNodes().map(function(e){return s.getNodeLabelInContext(e)}).join(", "))||s.getRootNodes().length+" item(s)";"infoPanel"!==o&&(m=[],s.getUuid()!==i.user.activeRepository&&m.push(v.default.createElement(O.MenuItem,{primaryText:e(246),onClick:function(){i.triggerRepositoryChange(s.getUuid()),r.props.onDismiss()}})),s.isEditable())&&(d=function(){s.deleteCell().then(function(e){r.props.onDismiss()})},y=function(){r.setState({edit:!0}),r.props.onHeightChange&&r.props.onHeightChange(500)},m.push(v.default.createElement(O.MenuItem,{primaryText:e(247),onClick:function(){return r.setState({edit:!0})}})),m.push(v.default.createElement(O.MenuItem,{primaryText:e(248),onClick:d})));var h,b,g=[];if(u&&c&&f&&!a&&(n=u.WatchSelector,u=c.BookmarkButton,h=v.default.createElement(E,{iconClassName:"mdi mdi-bell-outline",legend:i.MessageHash["meta.watch.selector.legend"],data:v.default.createElement(n,{pydio:i,nodes:f}),iconStyle:{marginTop:32}}),b=v.default.createElement(u,{pydio:i,nodes:f,styles:{iconStyle:{color:"white"}}})),f&&!a&&f.forEach(function(e){e.getMetadata().get("ws_quota")&&g.push(v.default.createElement(j,{node:e}))}),t=v.default.createElement(k,{pydio:i,title:s.getLabel(),onDismissAction:this.props.onDismiss,otherActions:b,onDeleteAction:d,onEditAction:y,editColor:"#009688",headerSmall:"infoPanel"===o,moreMenuItems:m},!a&&s.getDescription()&&v.default.createElement(E,{iconClassName:"mdi mdi-information",legend:e(145),data:s.getDescription()}),v.default.createElement(E,{iconClassName:"mdi mdi-account-multiple",legend:e(54),data:s.getAclsSubjects(),placeHolder:!0,placeHolderReady:!a}),v.default.createElement(E,{iconClassName:"mdi mdi-folder",legend:e(249),data:l,placeHolder:!0,placeHolderReady:!a}),g,"infoPanel"!==o&&(h||v.default.createElement(E,{placeHolder:!0,placeHolderReady:!a}))),"infoPanel"===o)return t}return v.default.createElement(O.Paper,{zDepth:0,style:p},t)}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(v.default.Component);r.default=n,t.exports=r.default},{"../main/ShareHelper":29,"./EditCellDialog":4,"material-ui":"material-ui",pydio:"pydio","pydio/http/resources-manager":"pydio/http/resources-manager","pydio/model/cell":"pydio/model/cell",react:"react"}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=a(e("react")),n=a(e("prop-types")),o=a(e("pydio")),u=e("material-ui"),i=e("material-ui/styles"),c=a(e("./SharedUsers")),f=a(e("./NodesPicker")),p=a(e("pydio/model/cell"));function a(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(r),t=(e=n?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,r){(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function v(e){e=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===l(e)?e:String(e)}var w=o.default.requireLib("hoc").ModernTextField,e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,i=m(l);function l(){var a,e=this,t=l;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return g(h(a=i.call.apply(i,[this].concat(n))),"state",{step:"users",model:new p.default,saving:!1}),g(h(a),"submit",function(){var e=a.state.model;a.setState({saving:!0}),e.save().then(function(e){a.props.onDismiss(),a.setState({saving:!1})}).catch(function(e){pydio.UI.displayMessage("ERROR",e.message),a.setState({saving:!1})})}),g(h(a),"m",function(e){return a.props.pydio.MessageHash["share_center."+e]}),g(h(a),"computeSummaryString",function(){var e=a.state.model,t=0,r=0,n=0,o=[],i=e.getAcls();return Object.keys(i).map(function(e){e=i[e];e.Group?r++:e.Role?n++:t++}),t&&o.push(t+" "+a.m(270)),r&&o.push(r+" "+a.m(271)),n&&o.push(n+" "+a.m(272)),e=3===o.length?o[0]+", "+o[1]+a.m(274)+o[3]:0===o.length?a.m(273):o.join(a.m(274)),a.m(269).replace("%USERS",e)}),a}return t=l,(e=[{key:"getChildContext",value:function(){var r=this.props.pydio.MessageHash;return{messages:r,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return r[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){var e=this;this.refs.title.focus(),this.state.model.observe("update",function(){e.forceUpdate()})}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"render",value:function(){var e,t=this,r=[],n=this.props.pydio,o=this.state,i=o.step,a=o.model,o=o.saving,l=n.MessageHash[418];return"users"!==i&&(l=a.getLabel()),"users"===i?(e=s.default.createElement("div",null,s.default.createElement("div",null,this.m(275)),s.default.createElement(w,{ref:"title",floatingLabelText:this.m(276),value:a.getLabel(),onChange:function(e,t){a.setLabel(t)},fullWidth:!0,variant:"v2",focusOnMount:!0,onKeyPress:function(e){"Enter"===e.key&&a.getLabel()&&t.submit()}}),s.default.createElement(w,{floatingLabelText:this.m(277),value:a.getDescription(),onChange:function(e,t){a.setDescription(t)},fullWidth:!0,variant:"v2"})),a.getLabel()&&(r.push(s.default.createElement(u.FlatButton,{key:"quick",primary:!0,disabled:!a.getLabel()||o,label:this.m("cells.create.advanced"),onClick:function(){t.setState({step:"data"})}})),r.push(s.default.createElement("span",{style:{display:"inline-block",margin:"0  10px",fontSize:14,fontWeight:500,color:"#9E9E9E"}},this.m("cells.create.buttons.separator")))),r.push(s.default.createElement(u.RaisedButton,{key:"next1",disabled:!a.getLabel()||o,primary:!0,label:this.m(279),onClick:function(){t.submit()}}))):"data"===i?(e=s.default.createElement("div",null,s.default.createElement("h5",{style:{marginTop:-10}},this.m(278)),s.default.createElement(c.default,{pydio:n,cellAcls:a.getAcls(),excludes:[n.user.id],onUserObjectAdd:a.addUser.bind(a),onUserObjectRemove:a.removeUser.bind(a),onUserObjectUpdateRight:a.updateUserRight.bind(a)})),r.push(s.default.createElement(u.FlatButton,{key:"prev1",primary:!1,label:n.MessageHash[304],onClick:function(){t.setState({step:"users"})}})),r.push(s.default.createElement(u.FlatButton,{key:"next2",primary:!0,label:n.MessageHash[179],onClick:function(){return t.setState({step:"label"})}}))):(e=s.default.createElement("div",null,s.default.createElement("h5",{style:{marginTop:-10}},this.m("cells.create.title.fill.folders")),s.default.createElement("div",{style:{color:"#9e9e9e"}},this.computeSummaryString()),s.default.createElement("div",{style:{paddingTop:16}},s.default.createElement(f.default,{pydio:n,model:a}))),r.push(s.default.createElement(u.FlatButton,{key:"prev2",primary:!1,label:n.MessageHash[304],onClick:function(){t.setState({step:"data"})}})),r.push(s.default.createElement(u.RaisedButton,{key:"submit",disabled:o,primary:!0,label:this.m(279),onClick:this.submit.bind(this)}))),s.default.createElement("div",{style:{width:380,fontSize:13,color:"rgba(0,0,0,.87)",display:"flex",flexDirection:"column",minHeight:300}},s.default.createElement("div",{style:{display:"flex",alignItems:"center",paddingLeft:20}},s.default.createElement(u.FontIcon,{className:"icomoon-cells-full-plus"}),s.default.createElement("div",{style:{padding:20,fontSize:22}},l)),s.default.createElement("div",{style:{padding:"20px 20px 10px",flex:1}},e),s.default.createElement("div",{style:{padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"flex-end"}},r))}}])&&d(t.prototype,e),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(s.default.Component);g(r.default=e,"childContextTypes",{messages:n.default.object,getMessage:n.default.func,isReadonly:n.default.func}),r.default=(0,i.muiThemeable)()(e),t.exports=r.default},{"./NodesPicker":5,"./SharedUsers":7,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/model/cell":"pydio/model/cell",react:"react"}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=a(e("./SharedUsers")),s=a(e("./NodesPicker")),u=a(e("../main/GenericEditor")),n=a(e("prop-types")),o=a(e("pydio"));function a(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,r){(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function h(e){e=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===l(e)?e:String(e)}var b=e("react"),g=o.default.requireLib("components").ResourcePoliciesPanel,v=o.default.requireLib("hoc").ModernTextField,e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,a=p(l);function l(){var o,e=this,t=l;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return m(d(o=a.call.apply(a,[this].concat(n))),"submit",function(){var e=o.props,t=e.model,r=e.pydio,n=t.hasDirtyRootNodes();t.save().then(function(e){o.forceUpdate(),n&&t.getUuid()===r.user.getActiveRepository()&&(r.goTo("/"),r.fireContextRefresh())}).catch(function(e){r.UI.displayMessage("ERROR",e.message)})}),o}return t=l,(e=[{key:"getChildContext",value:function(){var r=this.props.pydio.MessageHash;return{messages:r,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return r[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}}}},{key:"render",value:function(){function e(e){return r.MessageHash["share_center."+e]}var t=this.props,r=t.pydio,n=t.model,t=t.sendInvitations,o=b.createElement("div",null,b.createElement(v,{floatingLabelText:e(267),value:n.getLabel(),onChange:function(e,t){n.setLabel(t)},fullWidth:!0}),b.createElement(v,{floatingLabelText:e(268),value:n.getDescription(),onChange:function(e,t){n.setDescription(t)},fullWidth:!0})),t={leftStyle:{padding:10},rightStyle:{padding:10},left:[{Label:e(54),Value:"users",Component:b.createElement(i.default,{pydio:r,cellAcls:n.getAcls(),excludes:[r.user.id],sendInvitations:t,onUserObjectAdd:n.addUser.bind(n),onUserObjectRemove:n.removeUser.bind(n),onUserObjectUpdateRight:n.updateUserRight.bind(n)})},{Label:e(253),Value:"permissions",AlwaysLast:!0,Component:b.createElement(g,{pydio:r,resourceType:"cell",description:e("cell.visibility.advanced"),resourceId:n.getUuid(),style:{margin:-10},skipTitle:!0,onSavePolicies:function(){},readonly:!1,cellAcls:n.getAcls()})}],right:[{Label:e(249),Value:"content",Component:b.createElement(s.default,{pydio:r,model:n,mode:"edit"})}]};return b.createElement(u.default,{pydio:r,tabs:t,header:o,editorOneColumn:this.props.editorOneColumn,saveEnabled:n.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){n.revertChanges()}})}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(b.Component);m(r.default=e,"childContextTypes",{messages:n.default.object,getMessage:n.default.func,isReadonly:n.default.func}),t.exports=r.default},{"../main/GenericEditor":27,"./NodesPicker":5,"./SharedUsers":7,"prop-types":"prop-types",pydio:"pydio",react:"react"}],5:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=i(e("react")),f=e("material-ui"),n=e("material-ui/styles"),p=i(e("pydio/model/data-model"));function i(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?a(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=e("pydio").requireLib("components").FoldersTree,e=function(e){var t=u;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,s=m(u);function u(e){var t,r,n,o,i,a,l;if(this instanceof u)return t=s.call(this,e),r=e.pydio.user,n=[],r.getRepositoriesList().forEach(function(e){if("gateway"===e.getAccessType()){if(e.getId()===r.activeRepository){if("shared"===e.getOwner())return;i=e}n.push(e)}}),e=[],l=n.filter(function(e){return!e.getOwner()}),o=n.filter(function(e){return e.getOwner()}),(e=l.length&&o.length?[].concat(d(l),["DIVIDER"],d(o)):[].concat(d(l),d(o))).length&&(i=i||e[0],(l=(a=p.default.RemoteDataModelFactory({tmp_repository_id:i.getId()})).getRootNode()).getMetadata().set("repository_id",i.getId()),l.load(a.getAjxpNodeProvider())),t.state={dataModel:a,open:!1,availableWs:e,crtWs:i},t;throw new TypeError("Cannot call a class as a function")}return t=u,(e=[{key:"switchWorkspace",value:function(e){var t=p.default.RemoteDataModelFactory({tmp_repository_id:e.getId()}),r=t.getRootNode();r.getMetadata().set("repository_id",e.getId()),r.load(t.getAjxpNodeProvider()),this.setState({crtWs:e,dataModel:t})}},{key:"handleTouchTap",value:function(e){e.preventDefault(),this.setState({open:!0,anchorEl:e.currentTarget})}},{key:"handleRequestClose",value:function(){this.setState({open:!1})}},{key:"onValidateNode",value:function(){var e=this.state,t=e.node,e=e.crtWs;this.props.model.addRootNode(t,e.getId()),this.handleRequestClose()}},{key:"onNodeSelected",value:function(e){var t=this.state.dataModel;e.load(t.getAjxpNodeProvider()),this.setState({node:e})}},{key:"renderNodeLine",value:function(e){var t=this.props.model;return c.default.createElement(f.ListItem,{disabled:!0,leftIcon:c.default.createElement(f.FontIcon,{className:"mdi mdi-"+("LEAF"===e.Type?"file":"folder")}),primaryText:t.getNodeLabelInContext(e),rightIconButton:c.default.createElement(f.IconButton,{onClick:function(){t.removeRootNode(e.Uuid)},iconClassName:"mdi mdi-delete",tooltip:"Remove",iconStyle:{color:"rgba(0,0,0,.43)"}})})}},{key:"render",value:function(){function e(e){return l.MessageHash["share_center."+e]}var t,n=this,r=this.props,o=r.model,i=r.muiTheme,a=r.mode,l=r.pydio,r=o.getRootNodes()||[],s=[],r=(r.map(function(e){s.push(n.renderNodeLine(e)),s.push(c.default.createElement(f.Divider,{inset:!0}))}),s.pop(),r.length||"edit"===a&&(t=c.default.createElement("span",{style:{color:"rgba(0,0,0,.54)",fontStyle:"italic"}},e(280))),o="edit"===a?c.default.createElement(f.FlatButton,{label:e(282),onClick:this.handleTouchTap.bind(this),primary:!0,style:{marginBottom:10},icon:c.default.createElement(f.FontIcon,{className:"mdi mdi-folder-plus"})}):c.default.createElement(f.RaisedButton,{label:e(282),onClick:this.handleTouchTap.bind(this),primary:!1,style:{marginBottom:10},icon:c.default.createElement(f.FontIcon,{className:"mdi mdi-folder-plus",style:{fontSize:20,marginTop:-4}})}),this.state),a=r.node,u=r.availableWs,r=r.crtWs;return c.default.createElement("div",null,o,c.default.createElement(f.List,null,s),t,c.default.createElement(f.Popover,{open:this.state.open,anchorEl:this.state.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.handleRequestClose.bind(this)},c.default.createElement("div",{style:{width:372,height:300,display:"flex",flexDirection:"column"}},c.default.createElement(f.DropDownMenu,{style:{height:54},value:r,onChange:function(e,t,r){n.switchWorkspace(r)}},u.map(function(e){return"DIVIDER"===e?c.default.createElement(f.Divider,null):c.default.createElement(f.MenuItem,{value:e,primaryText:e.getLabel()})})),c.default.createElement(f.Divider,null),c.default.createElement("div",{style:{marginLeft:-26,flex:"1",overflowY:"auto",fontSize:15,color:"rgba(0,0,0,.73)"}},c.default.createElement(h,{pydio:this.props.pydio,dataModel:this.state.dataModel,onNodeSelected:this.onNodeSelected.bind(this),showRoot:!1,draggable:!1})),c.default.createElement(f.Divider,null),c.default.createElement("div",{style:{display:"flex",padding:"4px 16px",alignItems:"center",fontSize:15}},a&&c.default.createElement("div",{style:{flex:1,color:"rgba(0,0,0,.87)"}},a&&a.getPath()),!a&&c.default.createElement("div",{style:{flex:1,color:"rgba(0,0,0,.54)",fontWeight:500}},e(283)),c.default.createElement(f.IconButton,{iconStyle:{color:i.palette.primary1Color},disabled:!a,iconClassName:"mdi mdi-plus-circle-outline",onClick:this.onValidateNode.bind(this)})))))}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(c.default.Component);r.default=e,r.default=(0,n.muiThemeable)()(e),t.exports=r.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=e("material-ui"),f=o(e("./UserBadge")),n=o(e("../ShareContextConsumer"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){m(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,r){(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function h(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}var b=e("prop-types"),g=e("react"),e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,a=d(l);function l(){var r,e=this,t=l;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return m(y(r=a.call.apply(a,[this].concat(o))),"onRemove",function(){r.props.onUserObjectRemove(r.props.cellAcl.RoleId)}),m(y(r),"onInvite",function(){var e={},t=PydioUsers.User.fromIdmUser(r.props.cellAcl.User);e[t.getId()]=t,r.props.sendInvitations(e)}),m(y(r),"onUpdateRight",function(e,t){r.props.onUserObjectUpdateRight(r.props.cellAcl.RoleId,e,t)}),r}return t=l,(e=[{key:"render",value:function(){var e,t,r=this,n=this.props,o=n.cellAcl,n=n.pydio,i=[],a=o.User?"user":o.Group?"group":"team";if(o.User&&o.User.Login===n.user.id)return null;switch("group"!=a&&this.props.sendInvitations&&i.push({text:this.props.getMessage("45"),callback:this.onInvite}),this.props.isReadonly()||this.props.readonly||i.push({text:this.props.getMessage("257",""),callback:this.onRemove}),a){case"user":e=o.User.Attributes.displayName||o.User.Login,t=o.User.Attributes.avatar;break;case"group":e=o.Group.Attributes?o.Group.Attributes.displayName||o.Group.GroupLabel:o.Group.Uuid;break;case"team":e=o.Role?o.Role.Label:"No role found";break;default:e=o.RoleId}var l=!1,s=!1,n=(o.Actions.map(function(e){"read"===e.Name&&(l=!0),"write"===e.Name&&(s=!0)}),this.props.isReadonly()||this.props.readonly),u={display:"flex",width:70},u=(i.length||(u=p(p({},u),{},{marginRight:48})),g.createElement("span",{style:u},g.createElement(c.Checkbox,{disabled:n,checked:l,onCheck:function(e,t){r.onUpdateRight("read",t)}}),g.createElement(c.Checkbox,{disabled:n,checked:s,onCheck:function(e,t){r.onUpdateRight("write",t)}})));return g.createElement(f.default,{label:e,avatar:t,type:a,menus:i,boxes:u})}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(g.Component);m(r.default=e,"propTypes",{cellAcl:b.object.isRequired,sendInvitations:b.func,onUserObjectRemove:b.func.isRequired,onUserObjectUpdateRight:b.func.isRequired}),r.default=(0,n.default)(e),t.exports=r.default},{"../ShareContextConsumer":1,"./UserBadge":8,"material-ui":"material-ui","prop-types":"prop-types",react:"react"}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var f=i(e("react")),n=i(e("../ShareContextConsumer")),p=i(e("./SharedUserEntry")),d=i(e("../main/ActionButton")),o=i(e("prop-types")),e=i(e("pydio"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,r){(t=h(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function h(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}var b=e.default.requireLib("components").UsersCompleter,g=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,a=c(l);function l(){var o,e=this,t=l;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return m(y(o=a.call.apply(a,[this].concat(n))),"sendInvitationToAllUsers",function(){var e=o.props,t=e.cellAcls,r=e.pydio,n=[];Object.keys(t).map(function(e){var e=t[e];e.User&&e.User.Login===r.user.id||e.User&&(e=PydioUsers.User.fromIdmUser(e.User),n[e.getId()]=e)}),o.props.sendInvitations(n)}),m(y(o),"clearAllUsers",function(){Object.keys(o.props.cellAcls).map(function(e){o.props.onUserObjectRemove(e)})}),m(y(o),"valueSelected",function(e){e.IdmUser?o.props.onUserObjectAdd(e.IdmUser):o.props.onUserObjectAdd(e.IdmRole)}),o}return t=l,(e=[{key:"render",value:function(){var e,t,r=this,n=this.props,o=n.cellAcls,i=n.pydio,n=n.completerStyle,a=i.getPluginConfigs("core.auth"),l=0,s=[],u=(Object.keys(o).map(function(e){e=o[e];e.User&&e.User.Login===i.user.id||(l++,s.push(f.default.createElement(p.default,{cellAcl:e,key:l,pydio:r.props.pydio,readonly:r.props.readonly,sendInvitations:r.props.sendInvitations,onUserObjectRemove:r.props.onUserObjectRemove,onUserObjectUpdateRight:r.props.onUserObjectUpdateRight})))}),[]),c=Object.keys(this.props.cellAcls).length;return!c||this.props.isReadonly()||this.props.readonly||u.push(f.default.createElement(d.default,{key:"clear",callback:this.clearAllUsers,tooltipPosition:"top-center",mdiIcon:"account-minus",messageId:"180"})),c&&this.props.sendInvitations&&u.push(f.default.createElement(d.default,{key:"invite",callback:this.sendInvitationToAllUsers,tooltipPosition:"top-center",mdiIcon:"email-outline",messageId:"45"})),this.props.saveSelectionAsTeam&&1<c&&!this.props.isReadonly()&&!this.props.readonly&&u.push(f.default.createElement(d.default,{key:"team",callback:this.props.saveSelectionAsTeam,mdiIcon:"account-multiple-plus",tooltipPosition:"top-center",messageId:"509",messageCoreNamespace:!0})),this.props.withActionLinks&&(u=this.props.withActionLinks(u)),s.length&&(e=f.default.createElement("div",{style:{display:"flex",marginBottom:-8,marginTop:-8,color:"rgba(0,0,0,.33)",fontSize:12}},f.default.createElement("div",{style:{flex:1}}),f.default.createElement("div",{style:{width:43,textAlign:"center"}},f.default.createElement("span",{style:{borderBottom:"0px solid rgba(0,0,0,0.13)"}},this.props.getMessage("361",""))),f.default.createElement("div",{style:{width:43,textAlign:"center"}},f.default.createElement("span",{style:{borderBottom:"0px solid rgba(0,0,0,0.13)"}},this.props.getMessage("181"))),f.default.createElement("div",{style:{width:6}}))),this.props.isReadonly()||this.props.readonly||(c=Object.values(o).map(function(e){return e.User?e.User.Login:e.Group?e.Group.Uuid:e.Role?e.Role.Uuid:null}).filter(function(e){return!!e}),t=f.default.createElement(b,{className:"share-form-users",fieldLabel:this.props.getMessage("34"),onValueSelected:this.valueSelected,pydio:this.props.pydio,showAddressBook:!0,usersFrom:"local",excludes:c,existingOnly:!a.get("USER_CREATE_USERS")})),f.default.createElement("div",null,f.default.createElement("div",{style:n||{margin:"0 8px 16px"}},t),e,f.default.createElement("div",null,s),!s.length&&f.default.createElement("div",{style:{color:"rgba(0,0,0,0.43)",fontWeight:500,margin:"0 10px"}},this.props.getMessage("182")),0<s.length&&f.default.createElement("div",{style:{textAlign:"center",marginTop:10,marginBottom:10}},u))}}])&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(f.default.Component);m(r.default=g,"propTypes",{pydio:o.default.instanceOf(e.default),cellAcls:o.default.object,saveSelectionAsTeam:o.default.func,sendInvitations:o.default.func,showTitle:o.default.bool,onUserObjectAdd:o.default.func.isRequired,onUserObjectRemove:o.default.func.isRequired,onUserObjectUpdateRight:o.default.func.isRequired}),r.default=(0,n.default)(g),t.exports=r.default},{"../ShareContextConsumer":1,"../main/ActionButton":26,"./SharedUserEntry":6,"prop-types":"prop-types",pydio:"pydio",react:"react"}],8:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("prop-types"),u=e("react").Component,c=e("material-ui"),f=c.MenuItem,p=c.IconMenu,d=c.IconButton,c=e("material-ui/styles").muiThemeable,y=e("color"),e=function(){var e=o,t=u;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t);var r,n=l(o);function o(){var e=this,t=o;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"renderMenu",value:function(){var e;return this.props.menus&&this.props.menus.length?(e=this.props.menus.map(function(e){var t;return e.checked&&(t=React.createElement("span",{className:"mdi mdi-check"})),React.createElement(f,{primaryText:e.text,onClick:e.callback,rightIcon:t})}),React.createElement(p,{iconButtonElement:React.createElement(d,{style:{width:30,height:30,padding:5},iconStyle:{fontSize:18},iconClassName:"mdi mdi-dots-vertical"}),anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},desktop:!0},e)):null}},{key:"render",value:function(){var e=this.props.muiTheme.palette.avatarsColor,e="group"===this.props.type?(e=y(e).darken(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-multiple",style:{backgroundColor:e}})):"team"===this.props.type?(e=y(e).darken(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-multiple-outline",style:{backgroundColor:e}})):"temporary"===this.props.type?(e=y(e).lighten(.2).toString(),React.createElement("span",{className:"avatar mdi mdi-account-plus",style:{backgroundColor:e}})):"remote_user"===this.props.type?React.createElement("span",{className:"avatar mdi mdi-account-network",style:{backgroundColor:e}}):React.createElement("span",{className:"avatar mdi mdi-account",style:{backgroundColor:e}}),t=this.renderMenu(),r=this.props.boxes;return React.createElement("div",{className:"share-dialog user-badge user-type-"+this.props.type},e,React.createElement("span",{className:"user-badge-label"},this.props.label),t,r)}}])&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}();(r.default=e).propTypes={label:n.string,avatar:n.string,type:n.string,menus:n.object,muiTheme:n.object},r.default=e=c()(e),t.exports=r.default},{color:"color","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",react:"react"}],9:[function(y,m,h){!function(d){!function(){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(h,"__esModule",{value:!0}),h.default=void 0;var g=t(y("react")),i=t(y("../composite/CompositeModel")),v=t(y("../main/GenericEditor")),e=t(y("pydio")),w=t(y("../links/Panel")),O=(t(y("../links/SecureOptions")),t(y("../main/ShareHelper"))),P=t(y("./Mailer")),k=t(y("./NewCellsList")),l=t(y("clipboard")),E=(t(y("../links/PublicLinkTemplate")),t(y("../links/VisibilityPanel"))),j=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var i;"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((i=o?Object.getOwnPropertyDescriptor(e,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r])}n.default=e,t&&t.set(e,n);return n}(y("../links/LabelPanel"));y("material-ui");function s(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(s=function(e){return e?r:t})(e))}function t(e){return e&&e.__esModule?e:{default:e}}function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function r(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?r(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=o(r),t=(e=n?(e=o(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var n=e.default.requireLib("hoc").PaletteModifier,M=e.default.requireLib("boot").Tooltip,e=e.default.requireLib("components"),C=e.GenericCard,L=e.GenericLine,e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,n=p(o);function o(e){if(this instanceof o)return(e=n.call(this,e)).state={mode:e.props.mode||"view",model:new i.default("edit"===e.props.mode)},e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"confirmAndDismiss",value:function(){var e=this.state.model,t=this.props,r=t.pydio,t=t.onDismiss;e.isDirty()&&!confirm(r.MessageHash["share_center.dialog.close.confirm.unsaved"])||t()}},{key:"attachClipboard",value:function(){function r(e){return n.MessageHash["share_center."+e]}var t,n=this.props.pydio,e=this.state.model;this.detachClipboard(),e.getLinks().length&&(t=e.getLinks()[0]).getLink()&&this.refs["copy-button"]&&(this._clip=new l.default(this.refs["copy-button"],{text:function(e){return O.default.buildPublicUrl(n,t.getLink())}.bind(this)}),this._clip.on("success",function(){var e=this;this.setState({copyMessage:r("192")},function(){setTimeout(function(){e.setState({copyMessage:null})},2500)})}.bind(this)),this._clip.on("error",function(){var e=this,t=0===d.navigator.platform.indexOf("Mac")?r(144):r(143);this.setState({copyMessage:t},function(){setTimeout(function(){e.setState({copyMessage:null})},2500)})}.bind(this)))}},{key:"detachClipboard",value:function(){this._clip&&this._clip.destroy()}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.node,t=t.mode;this.state.model.observe("update",function(){e.forceUpdate()}),this.state.model.load(r,"infoPanel"===t),this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update"),this.detachClipboard()}},{key:"componentDidUpdate",value:function(){this.attachClipboard()}},{key:"componentWillReceiveProps",value:function(e){!e.node||e.node===this.props.node&&e.node.getMetadata("pydio_shares")===this.props.node.getMetadata("pydio_shares")||this.state.model.load(e.node,"infoPanel"===e.mode)}},{key:"usersInvitations",value:function(e,t){O.default.sendCellInvitation(this.props.node,t,e)}},{key:"linkInvitation",value:function(e){try{var t=O.default.prepareEmail(this.props.node,e);this.setState({mailerData:_(_({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){try{this.state.model.save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"deleteAllShares",value:function(){var e=this.props.pydio,t=this.state.model;e.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{dialogTitleId:"share_center.composite.deleteAll",message:e.MessageHash["share_center.255"],validCallback:function(){t.stopObserving("update"),t.deleteAll().then(function(e){t.updateUnderlyingNode()})}})}},{key:"render",value:function(){function e(e){return f.MessageHash["share_center."+e]}var t,r,n,o,i,a,l=this,s=this.props,u=s.node,c=s.mode,f=s.pydio,p=s.editorOneColumn,d=s.popoverPanel,y=s.popoverRequestClose,s=this.state,m=s.model,h=s.mailerData,b=s.linkTooltip,s=s.copyMessage;return"edit"===c?(h=g.default.createElement("div",{style:{fontSize:20,padding:10}},g.default.createElement(P.default,S({},h,{pydio:f,onDismiss:this.dismissMailer.bind(this)})),u&&e(256).replace("%s",u.getLabel())+(m.isDirty()?" *":"")),u={left:[],right:[]},i=1<(a=m.getCells().filter(function(e){return e.getUuid()})).length?e("254c").replace("%d",a.length):1===a.length?e("254d").replace("%s",a[0].getLabel()):e("254b"),u.right.push({Label:i,Value:"cells",Icon:"mdi mdi-account-multiple",Component:g.default.createElement(k.default,{pydio:f,compositeModel:m,usersInvitations:this.usersInvitations.bind(this)})}),(t=(i=m.getLinks()).length?i[0]:t)&&(r=!(o=[]),t.getLinkUuid()&&(r=!0,o.push(_(_({},(0,j.LinkLabelTitle)(m,t,e)),{},{content:g.default.createElement(j.default,{pydio:f,linkModel:i[0],model:m,showLayout:!0})})),i[0].isEditable())&&o.push({title:e("link.visibility.title"),content:g.default.createElement(E.default,{pydio:f,linkModel:i[0],style:{margin:-10}})}),u.left.push({Label:e(121)+(r?" ("+e("link.active")+")":""),Value:"public-link",Icon:"mdi mdi-link",Component:g.default.createElement(w.default,{pydio:f,compositeModel:m,linkModel:i[0],showMailer:O.default.mailerSupported(f)?this.linkInvitation.bind(this):null,additionalPanes:o})})),console.log(i.filter(function(e){return e.getLinkUuid()}),a.length),t=!i.filter(function(e){return e.getLinkUuid()}).length&&0<a.length?"cells":null,g.default.createElement(v.default,{tabs:u,defaultLeft:t,pydio:f,header:h,saveEnabled:m.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:function(){return l.confirmAndDismiss()},onRevertAction:function(){m.revertChanges(!0)},editorOneColumn:p,style:{width:"100%",height:null,flex:1,minHeight:350,color:"rgba(0,0,0,.83)",fontSize:13}})):(r=[],n=[],m.getCells().map(function(e){n.push(e.getLabel())}),(o=m.getLinks()).length&&((i=o[0]).hasError()?(a=i.hasError(),r.push(g.default.createElement(L,{iconClassName:"mdi mdi-alert-outline",legend:"Error",data:a.Detail||a.Msg||a}))):i.getLink()&&i.getLink().LinkHash&&(u=O.default.buildPublicUrl(f,i.getLink(),"infoPanel"===c),r.push(g.default.createElement(L,{iconClassName:"mdi mdi-link",legend:e(121),style:{overflow:"visible"},dataStyle:{overflow:"visible"},data:g.default.createElement("div",{ref:"copy-button",style:{cursor:"pointer",position:"relative"},onMouseOver:function(){l.setState({linkTooltip:!0})},onMouseOut:function(){l.setState({linkTooltip:!1})}},g.default.createElement(M,{label:s||e(191),horizontalPosition:"left",verticalPosition:"top",show:b}),u)})))),n.length&&r.push(g.default.createElement(L,{iconClassName:"mdi mdi-account-multiple",legend:e(254),data:n.join(", ")})),g.default.createElement(C,{pydio:f,title:f.MessageHash["share_center.50"],onDismissAction:this.props.onDismiss,onDeleteAction:function(){y&&y(),l.deleteAllShares()},onEditAction:function(){y&&y(),f.Controller.fireAction("share-edit-shared")},editTooltip:f.MessageHash["share_center.125"],deleteTooltip:f.MessageHash["share_center.composite.deleteAll"],headerSmall:"infoPanel"===c,popoverPanel:d,popoverRequestClose:y},r,!r.length&&g.default.createElement(L,{placeHolder:!0})))}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(g.default.Component);h.default=e,h.default=n({primary1Color:"#009688"})(e),m.exports=h.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../composite/CompositeModel":11,"../links/LabelPanel":17,"../links/Panel":19,"../links/PublicLinkTemplate":21,"../links/SecureOptions":22,"../links/VisibilityPanel":24,"../main/GenericEditor":27,"../main/ShareHelper":29,"./Mailer":12,"./NewCellsList":13,clipboard:"clipboard","material-ui":"material-ui",pydio:"pydio",react:"react"}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=l(e("./CompositeCard")),o=l(e("pydio/model/data-model")),i=l(e("prop-types")),a=l(e("pydio"));function l(e){return e&&e.__esModule?e:{default:e}}var s=e("react"),e=e("create-react-class")({displayName:"CompositeDialog",mixins:[e("pydio").requireLib("boot").ActionDialogMixin],getDefaultProps:function(){return{dialogTitle:"",dialogIsModal:!0,dialogPadding:!1,dialogSize:"md+"}},propTypes:{pydio:i.default.instanceOf(a.default).isRequired,selection:i.default.instanceOf(o.default),readonly:i.default.bool},childContextTypes:{messages:i.default.object,getMessage:i.default.func,isReadonly:i.default.func},getChildContext:function(){var e=this,r=this.props.pydio.MessageHash;return{messages:r,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return r[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return e.props.readonly}}},shouldComponentUpdate:function(e,t){return!!this.props.selection.getUniqueNode()},render:function(){var e,t=this.props,r=t.pydio,t=t.selection;return t.getUniqueNode()&&(e=t.getUniqueNode()),s.createElement(n.default,{editorOneColumn:!0,pydio:r,mode:"edit",node:e,onDismiss:this.props.onDismiss})}});r.default=e,t.exports=r.default},{"./CompositeCard":9,"create-react-class":"create-react-class","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model",react:"react"}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("pydio/lang/observable")),a=o(e("../links/LinkModel")),l=o(e("../main/ShareHelper")),i=o(e("pydio/model/cell")),s=e("cells-sdk"),u=o(e("pydio"));function o(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function p(){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(n)return(n=Object.getOwnPropertyDescriptor(n,t)).get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,r){(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function g(e){e=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===c(e)?e:String(e)}var v=u.default.requireLib("boot").moment,e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var r,n=y(o);function o(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this,r=o;if(t instanceof r)return b(m(t=n.call(this)),"cells",void 0),b(m(t),"links",void 0),b(m(t),"edit",void 0),b(m(t),"node",void 0),b(m(t),"saving",void 0),t.cells=[],t.links=[],t.edit=e,t;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"emptyLink",value:function(e){var t,r=this,n=new a.default,o=new s.TreeNode,i=l.default.getAuthorizations(),o=(o.Uuid=e.getMetadata().get("uuid"),n.getLink().Label=e.getLabel(),n.getLink().Description=pydio.MessageHash["share_center.257"].replace("%s",v(new Date).format("YYYY/MM/DD")),n.getLink().RootNodes.push(o),[s.RestShareLinkAccessType.constructFromObject("Download")]);return e.isLeaf()?(t="pydio_unique_dl",l.default.nodeHasEditor(pydio,e).preview&&!i.max_downloads?(t="pydio_unique_strip",o.push(s.RestShareLinkAccessType.constructFromObject("Preview"))):0<i.max_downloads&&(n.getLink().MaxDownloads=i.max_downloads)):(t="pydio_shared_folder",o.push(s.RestShareLinkAccessType.constructFromObject("Preview"))),n.getLink().ViewTemplateName=t,n.getLink().Permissions=o,i.max_expiration&&(n.getLink().AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(i.max_expiration)*60*24)),n.observe("update",function(){r.notify("update")}),n.observe("save",function(){r.updateUnderlyingNode()}),n}},{key:"createEmptyCell",value:function(){var e=this,t=new i.default(!0);t.setLabel(this.node.getLabel()),t.addRootNode(this.node),t.observe("update",function(){e.notify("update")}),t.dirty=!1,this.cells.push(t),this.notify("update")}},{key:"addToExistingCell",value:function(e){var t=this,r=new i.default(!0),e=(r.observe("update",function(){t.notify("update")}),r.load(e).then(function(){r.addRootNode(t.node)}),this.cells.filter(function(e){return!e.getUuid()}));e.length&&this.removeNewCell(e[0]),this.cells.push(r)}},{key:"updateUnderlyingNode",value:function(){this.skipUpdateUnderlyingNode||u.default.getInstance().getContextHolder().requireNodeReload(this.node)}},{key:"deleteLink",value:function(e){var t=this;return e.deleteLink(this.emptyLink(this.node).getLink()).then(function(e){t.updateUnderlyingNode()})}},{key:"getNode",value:function(){return this.node}},{key:"load",value:function(e){var r=this,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.node=e,this.cells=[],this.links=[],e.getMetadata().get("pydio_shares")&&JSON.parse(e.getMetadata().get("pydio_shares")).map(function(e){var t;3===e.Scope?((t=new a.default).observe("update",function(){r.notify("update")}),t.observe("save",function(){r.updateUnderlyingNode()}),t.load(e.UUID),r.links.push(t)):2===e.Scope&&((t=new i.default).observe("update",function(){r.notify("update")}),t.load(e.UUID),r.cells.push(t))}),this.edit&&!this.links.length&&this.links.push(this.emptyLink(e)),this.edit&&this.canCreateCells()&&!this.cells.length&&this.createEmptyCell(),t&&this.node.observe("node_replaced",function(){r.load(r.node,!1)})}},{key:"loadUniqueLink",value:function(e,t){var r=this,t=(this.node=t,new a.default);return t.observe("update",function(){r.notify("update")}),t.load(e),this.links.push(t),t}},{key:"canCreateCells",value:function(){var e,t;return!!this.node&&(e=l.default.getAuthorizations(),(t=this.node.isLeaf())&&e.file_workspaces||!t&&e.folder_workspaces)}},{key:"save",value:function(){var r=this,t=(this.saving=!0,this.notify("update"),[]);this.cells.map(function(e){e.isDirty()&&t.push(e.save())}),this.links.map(function(e){e.isDirty()&&t.push(e.save())}),Promise.all(t).then(function(){var t=r.node.getMetadata().get("uuid");r.cells=r.cells.filter(function(e){return e.hasRootNode(t)}),r.updateUnderlyingNode(),r.saving=!1}).catch(function(e){r.updateUnderlyingNode(),r.saving=!1})}},{key:"deleteAll",value:function(){var t=this.node.getMetadata().get("uuid"),r=[];return this.cells.map(function(e){e.removeRootNode(t),r.push(e.save())}),this.links.map(function(e){r.push(e.deleteLink())}),Promise.all(r)}},{key:"removeNewCell",value:function(t){this.cells=this.cells.filter(function(e){return e!==t}),this.notify("update")}},{key:"revertChanges",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.cells=this.cells.filter(function(e){return e.getUuid()}),this.cells.map(function(e){e.isDirty()&&e.revertChanges()}),this.links.map(function(e){e.isDirty()&&e.revertChanges()}),!this.cells.length&&e&&this.canCreateCells()&&this.createEmptyCell(),this.notify("update")}},{key:"isDirty",value:function(){return!this.saving&&this.cells.filter(function(e){return e.isDirty()}).length||this.links.filter(function(e){return e.isDirty()}).length}},{key:"stopObserving",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this.cells.map(function(e){e.stopObserving("update")}),this.links.map(function(e){e.stopObserving("update")}),p(h(o.prototype),"stopObserving",this).call(this,e,t)}},{key:"getCells",value:function(){var t;return this.node?(t=this.node.getMetadata().get("uuid"),this.cells.filter(function(e){return e.hasRootNode(t)})):this.cells}},{key:"getLinks",value:function(){return this.links}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(n.default);r.default=e,t.exports=r.default},{"../links/LinkModel":18,"../main/ShareHelper":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/lang/observable":"pydio/lang/observable","pydio/model/cell":"pydio/model/cell"}],12:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("react")),a=n(e("pydio/http/resources-manager")),l=n(e("../main/ShareHelper")),p=(e("material-ui"),e("cells-sdk"));function n(e){return e&&e.__esModule?e:{default:e}}function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function u(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function c(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,n=m(o);function o(e){if(this instanceof o)return(e=n.call(this,e)).state={mailerData:null},e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"componentWillReceiveProps",value:function(e){var t=this,r=e.subject,n=e.message,o=(e.users,e.linkModel),i=e.templateId;e.templateData;r||i?l.default.forceMailerOldSchool()?(i=encodeURIComponent(r),location.href="mailto:custom-email@domain.com?Subject="+i+"&Body="+n):a.default.loadClassesAndApply(["PydioMailer"],function(){t.setState({mailerData:c(c({},e),{},{enableIdentification:o&&o.getLink().TargetUsers,identifiedOnly:o&&o.getLink().RestrictToTargetUsers,crippleIdentificationKeys:!0})})}):this.setState({mailerData:null})}},{key:"toggleMailerData",value:function(e){this.setState({mailerData:c(c({},this.state.mailerData),e)})}},{key:"dismissMailer",value:function(){this.props.onDismiss()}},{key:"mailerProcessPost",value:function(e,r,i,a,t,l){var n=this.state.mailerData,o=n.crippleIdentificationKeys,s=n.identifiedOnly,u=n.linkModel,c=u.getLink(),f=(c.TargetUsers||(c.TargetUsers={}),c.RestrictToTargetUsers=s,{});Object.keys(r).forEach(function(e){var t=o?Math.random().toString(36).substring(7):e;c.TargetUsers[t]=p.RestShareLinkTargetUser.constructFromObject({Display:r[e].getLabel(),DownloadCount:0}),f[t]=e}),u.updateLink(c),u.save().then(function(){var r=new e,n=u.getPublicUrl(),o=new RegExp(n,"g");Object.keys(f).forEach(function(e){var t=a.replace(o,n+"?u="+e);r.addTarget(f[e],i,t)}),r.post(function(e){l(e)})})}},{key:"getMessage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";return this.props.pydio.MessageHash[t+(t?".":"")+e]}},{key:"render",value:function(){var e,t;return this.state.mailerData?(e=this.state.mailerData,i.default.createElement(PydioMailer.Pane,s({},e,{onDismiss:this.dismissMailer.bind(this),overlay:!0,className:"share-center-mailer",panelTitle:this.props.pydio.MessageHash["share_center.45"],additionalPaneTop:t,processPost:e.enableIdentification?this.mailerProcessPost.bind(this):null,style:{width:420,margin:"0 auto"}}))):null}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(i.default.Component);r.default=e,t.exports=r.default},{"../main/ShareHelper":29,"cells-sdk":"cells-sdk","material-ui":"material-ui","pydio/http/resources-manager":"pydio/http/resources-manager",react:"react"}],13:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=s(e("react")),n=s(e("./CompositeModel")),u=s(e("../cells/SharedUsers")),i=s(e("prop-types")),a=s(e("pydio")),l=e("material-ui/styles"),f=e("material-ui"),p=s(e("../main/ActionButton")),d=e("../links/Panel");function s(e){return e&&e.__esModule?e:{default:e}}function y(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function m(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?y(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):y(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function h(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?b(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function v(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=P(r),t=(e=n?(e=P(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e);var r,n=O(o);function o(e){var t,r;if(this instanceof o)return t=n.call(this,e),r=null,0===e.compositeModel.getCells().length&&(r="NEWCELL"),t.state={edit:r},t;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"addToCellsMenuItems",value:function(e){var t,r,n,o=this,i=[],a=this.props,l=a.pydio,s=a.compositeModel,u=s.getCells().map(function(e){return e.getUuid()});return 0===u.filter(function(e){return!e}).length&&(i.push(c.default.createElement(f.MenuItem,{primaryText:e("cell.add.new"),onClick:function(){o.setState({addMenuOpen:!1}),s.createEmptyCell()},leftIcon:c.default.createElement(f.FontIcon,{className:"icomoon-cells-full-plus"})})),t=!0),l.user.getRepositoriesList().forEach(function(e){"shared"===e.getOwner()&&-1===u.indexOf(e.getId())&&(i.push(c.default.createElement(f.MenuItem,{primaryText:e.getLabel(),onClick:function(){o.setState({addMenuOpen:!1}),s.addToExistingCell(e.getId())},leftIcon:c.default.createElement(f.FontIcon,{className:"icomoon-cells"})})),r=!0)}),r&&t?n=e("cell.add.existing-or-new"):r?n=e("cell.add.existing"):t&&(n=e("cell.add.new")),{addItems:i,addLabel:n}}},{key:"removeCurrentNodeFromCell",value:function(t){var e=this.props.compositeModel;0===e.getCells().filter(function(e){return e!==t}).length&&e.createEmptyCell(),t.removeRootNode(e.getNode().getMetadata().get("uuid"))}},{key:"render",value:function(){function r(e){return l.MessageHash["share_center."+e]}var n,o,e,i=this,t=this.props,a=t.compositeModel,l=t.pydio,s=t.usersInvitations;t.muiTheme,this.state.edit;return a.getNode()&&!a.canCreateCells()?c.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0, 0, 0, 0.43)",padding:8}},r(a.getNode().isLeaf()?"227":"228")):(n=1<a.getCells().length,o=[],a.getCells().map(function(t){var e=c.default.createElement("div",{style:{margin:"0 -10px"}},c.default.createElement(u.default,{pydio:l,cellAcls:t.getAcls(),excludes:[l.user.id],onUserObjectAdd:t.addUser.bind(t),onUserObjectRemove:t.removeUser.bind(t),onUserObjectUpdateRight:t.updateUserRight.bind(t),sendInvitations:function(e){return s(e,t)},saveSelectionAsTeam:!1,withActionLinks:function(e){return t.isEditable()?[].concat(h(e),[c.default.createElement(p.default,{mdiIcon:"delete-forever",destructive:!0,messageId:r("cells.remove.node"),callback:function(){i.removeCurrentNodeFromCell(t)}})]):e},readonly:!t.isEditable(),completerStyle:{margin:"-6px 8px 16px"}}));o.push(n?c.default.createElement(d.PaneToggler,{title:t.getLabel(),legend:t.getAclsSubjects()},e):c.default.createElement("div",{style:{padding:16}},e)),o.push(c.default.createElement(f.Divider,null))}),o.pop(),a=(t=this.addToCellsMenuItems(r)).addItems,t=t.addLabel,a.length&&(e=this.props.muiTheme,e=c.default.createElement("span",{id:"share-dialog-addtocell-menu"},c.default.createElement(f.FlatButton,{iconClassName:"icomoon-cells-full-plus",style:{width:"100%"},iconStyle:{color:e.palette.accent2Color},primary:!0,tooltip:r(263),label:t,tooltipPosition:"bottom-left",onClick:function(e){i.setState({addMenuOpen:!0,addMenuAnchor:e.currentTarget})}}),c.default.createElement(f.Popover,{open:this.state.addMenuOpen,anchorEl:this.state.addMenuAnchor,onRequestClose:function(){i.setState({addMenuOpen:!1})},anchorOrigin:{horizontal:"left",vertical:"top"},targetOrigin:{horizontal:"left",vertical:"bottom"}},c.default.createElement(f.Menu,{desktop:!0,listStyle:{paddingTop:0},width:250},c.default.createElement(f.Subheader,null,t),a)))),c.default.createElement("div",{style:m(m({},this.props.style),{},{minHeight:300})},o,e&&c.default.createElement("div",{style:{position:"absolute",bottom:10,left:10}},e)))}}])&&g(t.prototype,e),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(c.default.Component);(r.default=e).PropTypes={pydio:i.default.instanceOf(a.default),compositeModel:i.default.instanceOf(n.default).isRequired,usersInvitations:i.default.func},r.default=e=(0,l.muiThemeable)()(e),t.exports=r.default},{"../cells/SharedUsers":7,"../links/Panel":19,"../main/ActionButton":26,"./CompositeModel":11,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio",react:"react"}],14:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=n(e("react")),i=n(e("../composite/CompositeModel")),u=n(e("../main/GenericEditor")),c=n(e("../links/Panel")),f=(n(e("../links/SecureOptions")),n(e("../main/ShareHelper"))),p=n(e("./Mailer")),d=(n(e("../links/PublicLinkTemplate")),n(e("../links/VisibilityPanel"))),y=n(e("../links/LabelPanel"));e("material-ui");function n(e){return e&&e.__esModule?e:{default:e}}function m(){return(m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function l(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,b(n.key),n)}}function b(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=w(r),t=(e=n?(e=w(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var e=e("pydio").requireLib("hoc").PaletteModifier,O=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e);var r,n=v(o);function o(e){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");e.editorOneColumn=!0;var e=n.call(this,e),t=new i.default(!0);return t.skipUpdateUnderlyingNode=!0,e.state={mode:e.props.mode||"view",model:t},e}return t=o,(e=[{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.node,n=t.linkUuid,o=t.onRemoveLink,t=this.state.model;t.observe("update",function(){e.forceUpdate()}),t.loadUniqueLink(n,r).observeOnce("delete",function(){o&&o()})}},{key:"componentWillUnmount",value:function(){this.state.model.stopObserving("update")}},{key:"componentWillReceiveProps",value:function(e){e.LinkUuid&&e.LinkUuid!==this.props.LinkUuid&&this.state.model.loadUniqueLink(e.LinkUuid,e.node)}},{key:"linkInvitation",value:function(e){try{var t=f.default.prepareEmail(this.props.node,e);this.setState({mailerData:l(l({},t),{},{users:[],linkModel:e})})}catch(e){alert(e.message)}}},{key:"dismissMailer",value:function(){this.setState({mailerData:null})}},{key:"submit",value:function(){var e=this.state.model;try{e.getLinks().length&&e.getLinks()[0].save()}catch(e){this.props.pydio.UI.displayMessage("ERROR",e.message)}}},{key:"render",value:function(){function e(e){return o.MessageHash["share_center."+e]}var t,r=this.props,n=r.node,o=r.pydio,r=r.editorOneColumn,i=this.state,a=i.model,i=i.mailerData,n=(i=(t=a.getLinks().length?a.getLinks()[0]:t)&&t.getLinkUuid()&&t.isEditable()?s.default.createElement("div",null,s.default.createElement(p.default,m({},i,{pydio:o,onDismiss:this.dismissMailer.bind(this)})),s.default.createElement(y.default,{pydio:o,linkModel:t,model:a})):s.default.createElement("div",{style:{fontSize:24,padding:"26px 10px 0 ",lineHeight:"26px"}},s.default.createElement(p.default,m({},i,{pydio:o,onDismiss:this.dismissMailer.bind(this)})),e(256).replace("%s",n.getLabel())),{left:[],right:[],leftStyle:{padding:0}}),l=a.getLinks();return t&&(n.left.push({Label:e(251),Value:"public-link",Component:s.default.createElement(c.default,{pydio:o,compositeModel:a,linkModel:l[0],showMailer:f.default.mailerSupported(o)?this.linkInvitation.bind(this):null})}),t.getLinkUuid())&&n.left.push({Label:e(253),Value:"link-visibility",Component:s.default.createElement(d.default,{pydio:o,linkModel:l[0]}),AlwaysLast:!0}),s.default.createElement(u.default,{tabs:n,pydio:o,header:i,saveEnabled:a.isDirty(),onSaveAction:this.submit.bind(this),onCloseAction:this.props.onDismiss,onRevertAction:function(){a.revertChanges()},editorOneColumn:r,style:{width:"100%",height:null,flex:1,minHeight:550,color:"rgba(0,0,0,.83)",fontSize:13}})}}])&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(s.default.Component);r.default=O,r.default=e({primary1Color:"#009688"})(O),t.exports=r.default},{"../composite/CompositeModel":11,"../links/LabelPanel":17,"../links/Panel":19,"../links/PublicLinkTemplate":21,"../links/SecureOptions":22,"../links/VisibilityPanel":24,"../main/GenericEditor":27,"../main/ShareHelper":29,"./Mailer":12,"material-ui":"material-ui",pydio:"pydio",react:"react"}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"CellCard",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"CompositeDialog",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"CreateCellDialog",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"EditCellDialog",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"InfoPanel",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"LinkModel",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"ShareHelper",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(r,"ShareView",{enumerable:!0,get:function(){return f.ShareView}}),Object.defineProperty(r,"ShareViewModal",{enumerable:!0,get:function(){return f.ShareViewModal}}),Object.defineProperty(r,"SimpleLinkCard",{enumerable:!0,get:function(){return a.default}});var n=p(e("./cells/CreateCellDialog")),o=p(e("./cells/EditCellDialog")),i=p(e("./cells/CellCard")),a=p(e("./composite/SimpleLinkCard")),l=p(e("./main/InfoPanel")),s=p(e("./composite/CompositeDialog")),u=p(e("./links/LinkModel")),c=p(e("./main/ShareHelper")),f=e("./lists/ShareView");function p(e){return e&&e.__esModule?e:{default:e}}},{"./cells/CellCard":2,"./cells/CreateCellDialog":3,"./cells/EditCellDialog":4,"./composite/CompositeDialog":10,"./composite/SimpleLinkCard":14,"./links/LinkModel":18,"./lists/ShareView":25,"./main/InfoPanel":28,"./main/ShareHelper":29}],16:[function(S,_,M){!function(j){!function(){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.default=void 0;var s=i(S("react")),e=i(S("pydio")),t=i(S("prop-types")),r=i(S("../ShareContextConsumer")),u=(i(S("./TargetedUsers")),S("material-ui")),c=i(S("qrcode.react")),f=i(S("clipboard")),p=i(S("../main/ActionButton")),d=i(S("pydio/util/path")),y=i(S("pydio/util/lang")),n=S("material-ui/styles"),m=i(S("../main/ShareHelper")),o=i(S("./LinkModel"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(){return(h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w(t)}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,r){(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function P(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}var k=e.default.requireLib("hoc").ModernStyles,E=e.default.requireLib("boot").Tooltip,e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e);var r,a=v(l);function l(){var n,e=this,t=l;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return O(w(n=a.call.apply(a,[this].concat(o))),"state",{editLink:!1,copyMessage:"",showQRCode:!1}),O(w(n),"toggleEditMode",function(){var e=n.props,t=e.linkModel,e=e.pydio;if(n.state.editLink&&n.state.customLink){var r=m.default.getAuthorizations();if(r.hash_min_length&&n.state.customLink.length<r.hash_min_length)return void e.UI.displayMessage("ERROR",n.props.getMessage("223").replace("%s",r.hash_min_length));t.setCustomLink(n.state.customLink),t.save()}n.setState({editLink:!n.state.editLink,customLink:void 0})}),O(w(n),"changeLink",function(e){e=e.target.value,e=y.default.computeStringSlug(e);n.setState({customLink:e})}),O(w(n),"clearCopyMessage",function(){j.setTimeout(function(){this.setState({copyMessage:""})}.bind(w(n)),5e3)}),O(w(n),"attachClipboard",function(){var e=n.props,t=e.linkModel,r=e.pydio;n.detachClipboard(),n.refs["copy-button"]&&(n._clip=new f.default(n.refs["copy-button"],{text:function(e){return m.default.buildPublicUrl(r,t.getLink())}.bind(w(n))}),n._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(w(n))),n._clip.on("error",function(){var e=0===j.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("143");this.refs["public-link-field"].focus(),this.setState({copyMessage:e},this.clearCopyMessage)}.bind(w(n))))}),O(w(n),"detachClipboard",function(){n._clip&&n._clip.destroy()}),O(w(n),"openMailer",function(){n.props.showMailer(n.props.linkModel)}),O(w(n),"toggleQRCode",function(){n.setState({showQRCode:!n.state.showQRCode})}),n}return t=l,(e=[{key:"componentDidUpdate",value:function(e,t){this.attachClipboard()}},{key:"componentDidMount",value:function(){this.attachClipboard()}},{key:"componentWillUnmount",value:function(){this.detachClipboard()}},{key:"confirmDisable",value:function(){var e=this.props.onDisableLink;confirm(this.props.getMessage("dialog.link.confirm.remove"))&&e()}},{key:"render",value:function(){var e,t,r,n=this,o=this.props,i=o.linkModel,o=o.pydio,o=m.default.buildPublicUrl(o,i.getLink()),a=m.default.getAuthorizations(),a=this.props.editAllowed&&a.editable_hash&&!this.props.isReadonly()&&i.isEditable();return this.state.editLink&&a?s.default.createElement("div",null,s.default.createElement("div",{style:{display:"flex",alignItems:"center",backgroundColor:"rgb(246, 246, 248)",padding:6,borderRadius:2}},s.default.createElement("span",{style:{fontSize:16,color:"rgba(0,0,0,0.4)",display:"inline-block",maxWidth:160,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},d.default.getDirname(o)+"/ "),s.default.createElement(u.TextField,{style:{flex:1,marginRight:10,marginLeft:10},onChange:this.changeLink,value:void 0!==this.state.customLink?this.state.customLink:i.getLink().LinkHash}),s.default.createElement(p.default,{mdiIcon:"check",callback:this.toggleEditMode})),s.default.createElement("div",{style:{textAlign:"center",fontSize:13,color:"rgba(0,0,0,0.43)",paddingTop:16}},this.props.getMessage("194"))):(r=(i=this.state).copyMessage,i=i.linkTooltip,function(){return{__html:this.state.copyMessage}}.bind(this),e=[],t=this.props.muiTheme,r=s.default.createElement("div",{key:"copy",ref:"copy-button",style:{position:"absolute",right:0,bottom:7,width:30,height:30,padding:4,backgroundColor:"#f6f6f8",fontSize:16,cursor:"pointer"},onMouseOver:function(){n.setState({linkTooltip:!0})},onMouseOut:function(){n.setState({linkTooltip:!1})}},s.default.createElement(E,{label:r||this.props.getMessage("191"),horizontalPosition:"left",verticalPosition:"bottom",show:i}),s.default.createElement("span",{className:"copy-link-button mdi mdi-content-copy",style:{color:t.palette.primary1Color}})),this.props.showMailer&&e.push(s.default.createElement(p.default,{key:"outline",callback:this.openMailer,mdiIcon:"email-outline",messageId:"45"})),a&&e.push(s.default.createElement(p.default,{key:"pencil",callback:this.toggleEditMode,mdiIcon:"pencil",messageId:"193"})),m.default.qrcodeEnabled()&&e.push(s.default.createElement(p.default,{key:"qrcode",callback:this.toggleQRCode,mdiIcon:"qrcode",messageId:"94"})),this.props.onDisableLink&&e.push(s.default.createElement(p.default,{key:"delete",destructive:!0,callback:function(){return n.confirmDisable()},mdiIcon:"link-off",messageId:"link.disable"})),e=e.length?s.default.createElement("div",{style:{display:"flex",marginTop:10}},s.default.createElement("span",{style:{flex:1}}),e,s.default.createElement("span",{style:{flex:1}})):null,i=this.state.showQRCode?s.default.createElement(u.Paper,{zDepth:1,style:{width:120,paddingTop:10,overflow:"hidden",margin:"0 auto",height:120,textAlign:"center"}},s.default.createElement(c.default,{size:100,value:o,level:"Q"})):s.default.createElement(u.Paper,{zDepth:0,style:{width:120,overflow:"hidden",margin:"0 auto",height:0,textAlign:"center"}}),s.default.createElement(u.Paper,{zDepth:0,rounded:!1,className:"public-link-container"},s.default.createElement("div",{style:{marginTop:-8,position:"relative"}},s.default.createElement(u.TextField,h({floatingLabelText:this.props.getMessage("link.floatingLabel"),floatingLabelFixed:!0,type:"text",name:"Link",ref:"public-link-field",value:o,onFocus:function(e){e.target.select()},fullWidth:!0},k.textFieldV2)),r),!1,e,i))}}])&&b(t.prototype,e),r&&b(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(s.default.Component);O(M.default=e,"propTypes",{linkModel:t.default.instanceOf(o.default),editAllowed:t.default.bool,onChange:t.default.func,showMailer:t.default.func}),M.default=e=(0,n.muiThemeable)()(e),M.default=(0,r.default)(e),_.exports=M.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ShareContextConsumer":1,"../main/ActionButton":26,"../main/ShareHelper":29,"./LinkModel":18,"./TargetedUsers":23,clipboard:"clipboard","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/util/lang":"pydio/util/lang","pydio/util/path":"pydio/util/path","qrcode.react":"qrcode.react",react:"react"}],17:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.LinkLabelTitle=function(e,t,r){return{title:r("265"),legend:t.getLink().Label}},r.default=void 0;var s=l(e("react")),n=l(e("prop-types")),i=l(e("pydio")),a=l(e("./LinkModel")),u=l(e("../main/ShareHelper")),c=l(e("./PublicLinkTemplate")),e=l(e("../ShareContextConsumer"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var m=i.default.requireLib("hoc").ModernTextField;var h=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,n=d(o);function o(){var e=this,t=o;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"render",value:function(){function e(e){return n.MessageHash["share_center."+e]}var t,r=this.props,n=r.pydio,o=r.model,i=r.linkModel,a=r.style,r=r.showLayout,l=i.getLink(),o=u.default.compileLayoutData(n,o);return r&&1<o.length&&(t=s.default.createElement(c.default,{linkModel:i,pydio:n,layoutData:o,hideTitle:!0})),s.default.createElement("div",{style:a},s.default.createElement(m,{variant:"v2",floatingLabelText:e(265),value:l.Label,onChange:function(e,t){l.Label=t,i.updateLink(l)},fullWidth:!0}),s.default.createElement(m,{variant:"v2",floatingLabelText:e(266),value:l.Description,onChange:function(e,t){l.Description=t,i.updateLink(l)},fullWidth:!0}),t)}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(s.default.Component);r.default=h,r.default=h=(0,e.default)(h),h.PropTypes={pydio:n.default.instanceOf(i.default),linkModel:n.default.instanceOf(a.default)}},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"./PublicLinkTemplate":21,"prop-types":"prop-types",pydio:"pydio",react:"react"}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=o(e("pydio")),l=o(e("pydio/http/api")),n=o(e("pydio/lang/observable")),s=o(e("../main/ShareHelper")),u=e("cells-sdk"),c=o(e("pydio/util/pass"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(r),t=(e=n?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}e=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,o=d(i);function i(){var e,t,r,n;if(this instanceof i)return e=o.call(this),t=y(e),n=void 0,(r=h(r="dirty"))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,e.link=new u.RestShareLink,e.link.Permissions=[u.RestShareLinkAccessType.constructFromObject("Preview"),u.RestShareLinkAccessType.constructFromObject("Download")],e.link.Policies=[],e.link.PoliciesContextEditable=!0,e.link.RootNodes=[],e.ValidPassword=!0,e.loadError=null,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"hasError",value:function(){return this.loadError}},{key:"isEditable",value:function(){return this.link.PoliciesContextEditable}},{key:"isDirty",value:function(){return this.dirty}},{key:"getLinkUuid",value:function(){return this.link.Uuid}},{key:"getLink",value:function(){return this.link}},{key:"getPublicUrl",value:function(){return s.default.buildPublicUrl(a.default.getInstance(),this.link)}},{key:"updateLink",value:function(e){this.link=e,this.notifyDirty()}},{key:"notifyDirty",value:function(){this.dirty=!0,this.notify("update")}},{key:"revertChanges",value:function(){this.originalLink&&(this.link=this.clone(this.originalLink),this.dirty=!1,this.updatePassword=this.createPassword=null,this.ValidPassword=!0,this.notify("update"))}},{key:"hasPermission",value:function(t){return 0<this.link.Permissions.filter(function(e){return e===t}).length}},{key:"isExpired",value:function(){return!!(this.link.MaxDownloads&&parseInt(this.link.CurrentDownloads)>=parseInt(this.link.MaxDownloads))||(this.link.AccessEnd,!1)}},{key:"load",value:function(e){var t=this;return new u.ShareServiceApi(l.default.getRestClient()).getShareLink(e).then(function(e){t.link=e,t.link.Permissions||(t.link.Permissions=[]),t.link.Policies||(t.link.Policies=[]),t.link.RootNodes||(t.link.RootNodes=[]),t.originalLink=t.clone(t.link),t.notify("update")}).catch(function(e){t.loadError=e,t.notify("update")})}},{key:"setCreatePassword",value:function(e){var r=this;e?c.default.checkPasswordStrength(e,function(e,t){r.ValidPassword=e,r.ValidPasswordMessage=t}):this.ValidPassword=!0,this.createPassword=e,this.link.PasswordRequired=!0,this.notifyDirty()}},{key:"setUpdatePassword",value:function(e){var r=this;e?c.default.checkPasswordStrength(e,function(e,t){r.ValidPassword=e,r.ValidPasswordMessage=t}):this.ValidPassword=!0,this.updatePassword=e,this.notifyDirty()}},{key:"setCustomLink",value:function(e){this.customLink=e}},{key:"save",value:function(){var t=this;if(!this.ValidPassword)throw new Error(this.ValidPasswordMessage);var e=new u.ShareServiceApi(l.default.getRestClient()),r=new u.RestPutShareLinkRequest,n=(this.createPassword?(r.PasswordEnabled=!0,r.CreatePassword=this.createPassword):this.updatePassword?(r.PasswordEnabled=!0,this.link.PasswordRequired?r.UpdatePassword=this.updatePassword:r.CreatePassword=this.updatePassword):r.PasswordEnabled=this.link.PasswordRequired,s.default.getAuthorizations());if(n.password_mandatory&&!r.PasswordEnabled)throw new Error(a.default.getMessages()["share_center.175"]);return 0<parseInt(n.max_downloads)&&!parseInt(this.link.MaxDownloads)&&(this.link.MaxDownloads=""+parseInt(n.max_downloads),this.notify("update")),0<parseInt(n.max_expiration)&&!parseInt(this.link.AccessEnd)&&(this.link.AccessEnd=""+(Math.round(new Date/1e3)+60*parseInt(n.max_expiration)*60*24),this.notify("update")),this.customLink&&this.customLink!==this.link.LinkHash&&(r.UpdateCustomHash=this.customLink),r.ShareLink=this.link,e.putShareLink(r).then(function(e){t.link=e,t.dirty=!1,t.originalLink=t.clone(t.link),t.updatePassword=t.createPassword=t.customLink=null,t.ValidPassword=!0,t.notify("update"),t.notify("save")}).catch(function(e){e=e.Detail||e.message||e;a.default.getInstance().UI.displayMessage("ERROR",e)})}},{key:"deleteLink",value:function(t){var r=this;return new u.ShareServiceApi(l.default.getRestClient()).deleteShareLink(this.link.Uuid).then(function(e){r.link=t,r.dirty=!1,r.updatePassword=r.createPassword=r.customLink=null,r.notify("update"),r.notify("delete")}).catch(function(e){e=e.Detail||e.message||e;pydio.UI.displayMessage("ERROR",e)})}},{key:"clone",value:function(e){return u.RestShareLink.constructFromObject(JSON.parse(JSON.stringify(e)))}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.default);r.default=e,t.exports=r.default},{"../main/ShareHelper":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/lang/observable":"pydio/lang/observable","pydio/util/pass":"pydio/util/pass"}],19:[function(e,t,r){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.PaneToggler=void 0;var m=f(e("react")),n=f(e("../ShareContextConsumer")),h=f(e("./Field")),b=c(e("./Permissions")),g=f(e("./TargetedUsers")),v=e("material-ui"),o=f(e("./LinkModel")),i=f(e("../composite/CompositeModel")),l=f(e("prop-types")),s=f(e("pydio")),w=f(e("../main/ShareHelper")),O=c(e("./SecureOptions"));function u(e){var t,r;return"function"!=typeof WeakMap?null:(t=new WeakMap,r=new WeakMap,(u=function(e){return e?r:t})(e))}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=u(t);if(t&&t.has(e))return t.get(e);var r,n,o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&((n=i?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(o,r,n):o[r]=e[r]);return o.default=e,t&&t.set(e,o),o}function f(e){return e&&e.__esModule?e:{default:e}}function P(){return(P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach(function(e){y(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function y(e,t,r){(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function j(e,t,r){t&&E(e.prototype,t),r&&E(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function S(e){e=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===a(e)?e:String(e)}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}function M(e,t){return(M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function C(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=R(r),t=(e=n?(e=R(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return L(t)}}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var x=s.default.requireLib("form").ValidPassword,T=s.default.requireLib("hoc").ModernStyles,D=function(){_(n,m["default"].Component);var r=C(n);function n(e){var t;return k(this,n),(t=r.call(this,e)).state={active:!!e.active},t}return j(n,[{key:"render",value:function(){var e=this,t=this.props,r=t.title,n=t.legend,t=t.children,o=this.state.active,i={title:{cursor:"pointer",fontSize:15,padding:16,paddingBottom:o?8:16,display:"flex",alignItems:"center",fontWeight:o?500:null},legend:{opacity:.4,fontSize:12,fontWeight:500,fontStyle:"italic"},content:{padding:"0 16px 8px"},chevron:{fontSize:24,color:"rgba(0,0,0,.3)",transition:"transform 250ms ease",transform:o?"rotate(90deg)":""}};return m.default.createElement(m.default.Fragment,null,m.default.createElement("div",{style:d({},i.title),onClick:function(){e.setState({active:!o})}},m.default.createElement("span",{style:{flex:1}},r,n&&m.default.createElement("span",{style:i.legend}," - ",n)),m.default.createElement("span",{className:"mdi mdi-chevron-right",style:i.chevron})),o&&m.default.createElement("div",{style:d({},i.content)},t))}}]),n}(),e=(r.PaneToggler=D,function(){_(i,m["default"].Component);var o=C(i);function i(){var r;k(this,i);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return y(L(r=o.call.apply(o,[this].concat(t))),"state",{showTemporaryPassword:!1,temporaryPassword:null,saving:!1}),y(L(r),"toggleLink",function(){var e=r.props,t=e.linkModel;e.pydio;r.state.showTemporaryPassword?r.setState({showTemporaryPassword:!1,temporaryPassword:null}):!t.getLinkUuid()&&w.default.getAuthorizations().password_mandatory?r.setState({showTemporaryPassword:!0,temporaryPassword:""}):(r.setState({saving:!0}),(t.getLinkUuid()?r.props.compositeModel.deleteLink(t):t.save()).catch(function(){r.setState({saving:!1})}).then(function(){r.setState({saving:!1})}))}),y(L(r),"updateTemporaryPassword",function(e,t){void 0===e&&(e=t.currentTarget.getValue()),r.setState({temporaryPassword:e})}),y(L(r),"enableLinkWithPassword",function(){var e=r.props.linkModel;if(r.state.temporaryPasswordState){e.setCreatePassword(r.state.temporaryPassword);try{e.save()}catch(e){r.props.pydio.UI.displayMessage("ERROR",e.message)}r.setState({showTemporaryPassword:!1,temporaryPassword:null})}else r.props.pydio.UI.displayMessage("ERROR","Invalid Password")}),r}return j(i,[{key:"render",value:function(){var t,e,r=this,n=this.props,o=n.linkModel,i=n.pydio,a=n.compositeModel,l=n.toggleOnly,n=n.additionalPanes,s=this.state,u=s.showTemporaryPassword,c=s.temporaryPassword,s=s.saving,f=w.default.getAuthorizations(),p=a.getNode().isLeaf(),d=p&&f.file_public_link||!p&&f.folder_public_link,y={backgroundColor:"#eee"};return o.getLinkUuid()?(this.props.isReadonly()||s||!o.isEditable()||!o.getLinkUuid()&&!d||(e=function(){return r.toggleLink()}),e=m.default.createElement(h.default,{pydio:i,linkModel:o,showMailer:this.props.showMailer,editAllowed:f.editable_hash&&o.isEditable(),onDisableLink:e,key:"public-link"}),t=[m.default.createElement(v.Divider,{style:y}),m.default.createElement(D,(0,b.PermissionsTitle)(a,o,this.props.getMessage),m.default.createElement(b.default,{compositeModel:a,linkModel:o,pydio:i,key:"public-perm"}))],o.getLink().TargetUsers&&(t.push(m.default.createElement(v.Divider,{style:y})),t.push(m.default.createElement(g.default,{linkModel:o,pydio:i}))),t.push(m.default.createElement(v.Divider,{style:y})),t.push(m.default.createElement(D,(0,O.SecureOptionsTitle)(a,o,this.props.getMessage),m.default.createElement(O.default,{pydio:i,linkModel:o}))),n&&n.forEach(function(e){t.push(m.default.createElement(v.Divider,{style:y})),t.push(m.default.createElement(D,{title:e.title,legend:e.legend},e.content))})):e=u?m.default.createElement("div",null,m.default.createElement("div",{className:"section-legend",style:{marginTop:20}},this.props.getMessage("215")),m.default.createElement("div",{style:{width:"100%"}},m.default.createElement(x,{attributes:{label:this.props.getMessage("23")},value:c,onChange:this.updateTemporaryPassword.bind(this),onValidStatusChange:function(e){return r.setState({temporaryPasswordState:e})},variant:"v2"})),m.default.createElement("div",{style:{textAlign:"center",marginTop:20}},m.default.createElement(v.RaisedButton,{label:this.props.getMessage("92"),secondary:!0,onClick:this.enableLinkWithPassword.bind(this),disabled:!this.state.temporaryPasswordState}))):d?m.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)",paddingBottom:16,paddingTop:16}},this.props.getMessage("190")):m.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)",paddingBottom:16,paddingTop:16}},this.props.getMessage(p?"225":"226")),m.default.createElement("div",{style:this.props.style},!(o.getLinkUuid()||u)&&m.default.createElement("div",{style:{padding:16}},m.default.createElement(v.Toggle,P({disabled:this.props.isReadonly()||s||!o.isEditable()||!o.getLinkUuid()&&!d,onToggle:this.toggleLink,toggled:o.getLinkUuid()||u,label:this.props.getMessage("189")},T.toggleFieldV2))),s&&m.default.createElement("div",{style:{width:"100%",height:300,display:"flex",alignItems:"center",justifyContent:"center"}},m.default.createElement(v.CircularProgress,null)),!l&&!s&&m.default.createElement("div",{style:{padding:16}},e),!l&&!s&&t)}}]),i}());y(r.default=e,"propTypes",{linkModel:l.default.instanceOf(o.default),compositeModel:l.default.instanceOf(i.default),pydio:l.default.instanceOf(s.default),authorizations:l.default.object,showMailer:l.default.func}),r.default=(0,n.default)(e)},{"../ShareContextConsumer":1,"../composite/CompositeModel":11,"../main/ShareHelper":29,"./Field":16,"./LinkModel":18,"./Permissions":20,"./SecureOptions":22,"./TargetedUsers":23,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.PermissionsTitle=function(e,t,r){var n,o=[];t.hasPermission("Preview")&&o.push(r("72"));t.hasPermission("Download")&&o.push(r("73"));t.hasPermission("Upload")&&(e.getNode().isLeaf()?o.push(r("74b")):o.push(r("74")));o.length&&(n=o.join(", ").toLowerCase());return{title:r("71"),legend:n}},r.default=void 0;var i=l(e("react")),n=l(e("prop-types")),o=(l(e("pydio")),l(e("../ShareContextConsumer"))),s=e("material-ui"),a=l(e("./LinkModel")),u=l(e("../main/ShareHelper")),c=e("cells-sdk");function l(e){return e&&e.__esModule?e:{default:e}}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=n?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return m(t)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,r){(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function g(e){e=function(e,t){if("object"!==f(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===f(e)?e:String(e)}e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var r,a=y(l);function l(){var i,e=this,t=l;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return b(m(i=a.call.apply(a,[this].concat(n))),"changePermission",function(e){var t=e.target.name,e=e.target.checked,r=i.props,n=r.compositeModel,r=r.linkModel,o=r.getLink();e?o.Permissions.push(c.RestShareLinkAccessType.constructFromObject(t)):o.Permissions=o.Permissions.filter(function(e){return e!==t}),n.getNode().isLeaf()&&(e=u.default.getAuthorizations().max_downloads,r.hasPermission("Preview")?(o.ViewTemplateName="pydio_unique_strip",o.MaxDownloads=0):(o.ViewTemplateName="pydio_unique_dl",e&&!o.MaxDownloads&&(o.MaxDownloads=e))),i.props.linkModel.updateLink(o)}),i}return t=l,(e=[{key:"render",value:function(){var e=this.props,t=e.linkModel,r=e.compositeModel,e=e.pydio,r=r.getNode(),n=[],o=u.default.getAuthorizations();return r.isLeaf()?(r=(e=u.default.nodeHasEditor(e,r)).preview,e=e.writeable,n.push({NAME:"Download",LABEL:this.props.getMessage("73"),DISABLED:!r||!t.hasPermission("Preview")}),r&&!o.max_downloads&&(n.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Download")}),t.hasPermission("Preview"))&&e&&n.push({NAME:"Upload",LABEL:this.props.getMessage("74b")})):(n.push({NAME:"Preview",LABEL:this.props.getMessage("72"),DISABLED:!t.hasPermission("Upload")}),n.push({NAME:"Download",LABEL:this.props.getMessage("73")}),n.push({NAME:"Upload",LABEL:this.props.getMessage("74")})),i.default.createElement("div",null,n.map(function(e){return i.default.createElement(s.Checkbox,{key:e.NAME,disabled:e.DISABLED||this.props.isReadonly()||!t.isEditable(),type:"checkbox",name:e.NAME,label:e.LABEL,onCheck:this.changePermission,checked:t.hasPermission(e.NAME),labelStyle:{whiteSpace:"nowrap"},style:{margin:"10px 0"}})}.bind(this)),void 0)}}])&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(i.default.Component);b(r.default=e,"propTypes",{linkModel:n.default.instanceOf(a.default),style:n.default.object}),r.default=(0,o.default)(e)},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"cells-sdk":"cells-sdk","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],21:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=u(e("react")),n=u(e("prop-types")),a=u(e("pydio")),l=u(e("../ShareContextConsumer")),s=e("material-ui"),e=u(e("./LinkModel"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function p(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(r),t=(e=n?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=a.default.requireLib("hoc").ModernSelectField,a=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var r,n=p(o);function o(){var e=this,t=o;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"onDropDownChange",value:function(e,t,r){var n=this.props.linkModel;n.getLink().ViewTemplateName=r,n.notifyDirty()}},{key:"render",value:function(){var t,e=this.props,r=e.linkModel,e=e.hideTitle,n=r.getLink().ViewTemplateName,o=this.props.layoutData.map(function(e){return n&&e.LAYOUT_ELEMENT===n&&(t=e.LAYOUT_LABEL),n||t||(n=e.LAYOUT_ELEMENT,t=e.LAYOUT_LABEL),i.default.createElement(s.MenuItem,{key:e.LAYOUT_ELEMENT,value:e.LAYOUT_ELEMENT,primaryText:e.LAYOUT_LABEL})});return i.default.createElement("div",{style:this.props.style},!e&&i.default.createElement("div",{style:{fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},this.props.getMessage("151")),i.default.createElement(y,{variant:"v2",fullWidth:!0,value:n,onChange:this.onDropDownChange.bind(this),disabled:this.props.isReadonly()||this.props.readonly||!r.isEditable(),floatingLabelText:this.props.getMessage("151")},o))}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(i.default.Component),n=(a.PropTypes={linkModel:n.default.instanceOf(e.default)},a=(0,l.default)(a));r.default=n,t.exports=r.default},{"../ShareContextConsumer":1,"./LinkModel":18,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio",react:"react"}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SecureOptionsTitle=function(e,t,r){r("link.secure.title");var n,o,i=[],t=t.getLink();{var a,l,s;t.AccessEnd&&0!==parseInt(t.AccessEnd)&&(a=new Date(1e3*parseInt(t.AccessEnd)),l=new Date,s=r("link.secure.expires"),a<l&&(s=r("link.secure.expired"),n=y.default.createElement("span",{className:"mdi mdi-alert"})),i.push(s+" "+S(a).fromNow()))}t.PasswordRequired&&i.push(r("link.secure.hasPassword"));0<t.MaxDownloads&&i.push(r("link.secure.maxdownloads").replace("%d",t.MaxDownloads));i.length&&(o=y.default.createElement(y.default.Fragment,null,n,i.join(", ")));return{title:r("link.secure.title"),legend:o}},r.default=void 0;var y=a(e("react")),n=a(e("prop-types")),s=a(e("pydio")),u=a(e("pydio/util/pass")),m=e("material-ui"),o=a(e("../ShareContextConsumer")),i=a(e("./LinkModel")),h=a(e("../main/ShareHelper"));function a(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function b(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach(function(e){O(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=w(r),t=(e=n?(e=w(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return v(t)}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,r){(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function P(e){e=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===l(e)?e:String(e)}var k=s.default.requireLib("form").ValidPassword,e=s.default.requireLib("hoc"),E=e.ModernTextField,j=e.ModernStyles,S=s.default.requireLib("boot").moment,_={iconButton:{style:{width:40,height:40,padding:6},iconStyle:{color:"rgba(0,0,0,.5)",fontSize:20}},leftIcon:{margin:"0 16px 0 4px",color:"#757575"}};e=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,i=d(l);function l(){var a,e=this,t=l;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return O(v(a=i.call.apply(i,[this].concat(n))),"state",{}),O(v(a),"updateDLExpirationField",function(e){var e=e.currentTarget.value,t=(parseInt(e)<0&&(e=-parseInt(e)),a.props.linkModel),r=t.getLink();r.MaxDownloads=e,t.updateLink(r)}),O(v(a),"updateDaysExpirationField",function(e,t){t=t||e.currentTarget.getValue();var e=a.props.linkModel,r=e.getLink();r.AccessEnd=t,e.updateLink(r)}),O(v(a),"onDateChange",function(e,t){t=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());a.updateDaysExpirationField(e,Math.floor(t/1e3)+"")}),O(v(a),"resetPassword",function(){var e=a.props.linkModel;e.setUpdatePassword(""),e.getLink().PasswordRequired=!1,e.notifyDirty()}),O(v(a),"setUpdatingPassword",function(r){u.default.checkPasswordStrength(r,function(e,t){a.setState({updatingPassword:r,updatingPasswordValid:e})})}),O(v(a),"changePassword",function(){var e=a.props.linkModel,t=a.state.updatingPassword;e.setUpdatePassword(t),a.setState({pwPop:!1,updatingPassword:"",updatingPasswordValid:!1}),e.notifyDirty()}),O(v(a),"updatePassword",function(e,t){var r=a.props.linkModel;a.state.validPasswordStatus?a.setState({invalidPassword:null,invalid:!1},function(){r.setUpdatePassword(e)}):a.setState({invalidPassword:e,invalid:!0})}),O(v(a),"resetDownloads",function(){var e;window.confirm(a.props.getMessage("106"))&&((e=a.props.linkModel).getLink().CurrentDownloads="0",e.notifyDirty())}),O(v(a),"resetExpiration",function(){var e=a.props.linkModel;e.getLink().AccessEnd="0",e.notifyDirty()}),O(v(a),"renderPasswordContainer",function(){var e,t,r,n=a.props.linkModel,o=n.getLink(),i=h.default.getAuthorizations();return o.PasswordRequired?(a.props.isReadonly()||!n.isEditable()||i.password_mandatory||(t=y.default.createElement(m.IconButton,g({iconClassName:"mdi mdi-close-circle",onClick:a.resetPassword,tooltip:a.props.getMessage("174")},_.iconButton))),!a.props.isReadonly()&&n.isEditable()&&(r=y.default.createElement("div",null,y.default.createElement(m.IconButton,g({iconClassName:"mdi mdi-pencil",onClick:function(e){a.setState({pwPop:!0,pwAnchor:e.currentTarget})},tooltip:a.props.getMessage("181")},_.iconButton)),y.default.createElement(m.Popover,{open:a.state.pwPop,anchorEl:a.state.pwAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(){a.setState({pwPop:!1})}},y.default.createElement("div",{style:{width:380,padding:8}},y.default.createElement(k,{name:"update",ref:"pwdUpdate",attributes:{label:a.props.getMessage("23")},value:a.state.updatingPassword||"",onChange:function(e){a.setUpdatingPassword(e)},onValidStatusChange:function(e){return a.setState({updatingPasswordDiffer:!e})},variant:"v2"}),y.default.createElement("div",{style:{paddingTop:20,textAlign:"right"}},y.default.createElement(m.FlatButton,{label:s.default.getMessages()[54],onClick:function(){a.setState({pwPop:!1,updatingPassword:""})}}),y.default.createElement(m.FlatButton,{style:{minWidth:60},label:s.default.getMessages()[48],onClick:function(){a.changePassword()},disabled:!a.state.updatingPassword||!a.state.updatingPasswordValid||a.state.updatingPasswordDiffer})))))),e=y.default.createElement(E,{floatingLabelText:a.props.getMessage("23"),disabled:!0,value:"********",fullWidth:!0,variant:"v2"})):!a.props.isReadonly()&&n.isEditable()&&(e=y.default.createElement(k,{name:"share-password",ref:"pwd",attributes:{label:a.props.getMessage("23")},value:a.state.invalidPassword||n.updatePassword,onChange:a.updatePassword.bind(v(a)),onValidStatusChange:function(e){a.setState({validPasswordStatus:e})},variant:"v2"})),e?y.default.createElement("div",{className:"password-container",style:{display:"flex",alignItems:"baseline",width:"100%",position:"relative"}},y.default.createElement("div",{style:{width:"100%",display:"inline-block"}},e),(t||r)&&y.default.createElement("div",{style:{position:"absolute",right:0,bottom:0,display:"flex"}},r,t)):null}),O(v(a),"formatDate",function(e){return a.props.getMessage("date_format","").split(" ").shift().replace("Y",e.getFullYear()).replace("m",e.getMonth()+1).replace("d",e.getDate())}),a}return t=l,(e=[{key:"render",value:function(){var e,t,r,n,o=this.props.linkModel,i=o.getLink(),a=this.renderPasswordContainer(),l=o.hasPermission("Download")&&!o.hasPermission("Preview")&&!o.hasPermission("Upload"),s=parseInt(i.MaxDownloads),u=parseInt(i.AccessEnd),c=!1,f=!1,p=new Date,d=h.default.getAuthorizations();return 0<parseInt(d.max_expiration)&&(r=new Date).setDate(p.getDate()+parseInt(d.max_expiration)),0<parseInt(d.max_downloads)&&(s=Math.max(1,Math.min(s,parseInt(d.max_downloads)))),u&&(u<0&&(c=!0),t=new Date(1e3*u),parseInt(d.max_expiration)||(e=y.default.createElement(m.IconButton,{iconStyle:_.iconButton.iconStyle,style:b(b({},_.iconButton.style),{},{position:"absolute",right:0,bottom:0,zIndex:1}),iconClassName:"mdi mdi-close-circle",onClick:this.resetExpiration.bind(this)}))),s&&((p=parseInt(i.CurrentDownloads)||0)&&(n=y.default.createElement("a",{style:{cursor:"pointer"},onClick:this.resetDownloads.bind(this),title:this.props.getMessage("17")},"(",this.props.getMessage("16"),")"),s<=p)&&(f=!0),n=y.default.createElement("span",{className:"dlCounterString"},p+"/"+s," ",n)),y.default.createElement("div",null,a,y.default.createElement("div",{style:{display:"flex",alignItems:"baseline",position:"relative"},className:c?"limit-block-expired":null},y.default.createElement(m.DatePicker,g({ref:"expirationDate",key:"start",value:t,minDate:new Date,maxDate:r,autoOk:!0,disabled:this.props.isReadonly()||!o.isEditable(),onChange:this.onDateChange,showYearSelector:!0,floatingLabelText:this.props.getMessage(c?"21b":"21"),mode:"landscape",formatDate:this.formatDate,fullWidth:!0},j.textFieldV2,{style:{flex:1},textFieldStyle:b(b({},j.textFieldV2.style),{},{flex:1})})),e),y.default.createElement("div",{style:{alignItems:"baseline",display:l?"flex":"none",position:"relative"},className:f?"limit-block-expired":null},y.default.createElement(E,{type:"number",disabled:this.props.isReadonly()||!o.isEditable(),floatingLabelText:this.props.getMessage(f?"22b":"22"),value:0<s?s:"",onChange:this.updateDLExpirationField,fullWidth:!0,style:{flex:1},variant:"v2"}),y.default.createElement("span",{style:{position:"absolute",right:10,top:14,fontSize:13,fontWeight:500,color:"rgba(0,0,0,0.43)"}},n)))}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(y.default.Component);O(r.default=e,"propTypes",{linkModel:n.default.instanceOf(i.default).isRequired,style:n.default.object}),r.default=(0,o.default)(e)},{"../ShareContextConsumer":1,"../main/ShareHelper":29,"./LinkModel":18,"material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/util/pass":"pydio/util/pass",react:"react"}],23:[function(P,k,E){!function(O){!function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(E,"__esModule",{value:!0}),E.default=void 0;var e=s(P("prop-types")),i=s(P("react")),n=s(P("react-dom")),t=s(P("../ShareContextConsumer")),a=P("material-ui"),l=s(P("clipboard")),r=s(P("../links/LinkModel"));function s(e){return e&&e.__esModule?e:{default:e}}function u(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function c(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?u(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):u(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function d(e,t,r){t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function y(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(){m(r,i["default"].Component);var t=b(r);function r(e){return f(this,r),(e=t.call(this,e)).state={copyMessage:""},e}return d(r,[{key:"componentDidMount",value:function(){this._clip&&this._clip.destroy(),this._button&&(this._clip=new l.default(this._button,{text:function(e){return this.props.link}.bind(this)}),this._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage("192")},this.clearCopyMessage)}.bind(this)),this._clip.on("error",function(){var e=0===O.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("share_center.143");this.setState({copyMessage:e},this.clearCopyMessage)}.bind(this)))}},{key:"componentWillUnmount",value:function(){this._clip&&this._clip.destroy()}},{key:"clearCopyMessage",value:function(){setTimeout(function(){this.setState({copyMessage:""})}.bind(this),5e3)}},{key:"render",value:function(){var t=this,e=this.props,r=e.targetUser,e=e.link;return i.default.createElement("div",{style:{display:"flex"}},i.default.createElement("div",{style:{flex:1}},r.Display,i.default.createElement(a.IconButton,{pydio:this.props.pydio,ref:function(e){t._button=n.default.findDOMNode(e)},iconClassName:"mdi mdi-link",tooltip:this.state.copyMessage||e,iconStyle:{fontSize:13,lineHeight:"17px"},style:{width:34,height:34,padding:6}})),i.default.createElement("div",{style:{width:40,textAlign:"center"}},r.DownloadCount))}}]),r}(),w=function(){m(n,i["default"].Component);var r=b(n);function n(e,t){return f(this,n),(e=r.call(this,e,t)).state={open:!1},e}return d(n,[{key:"render",value:function(){var r,e,t=this,n=this.props.linkModel,o=n.getLink(),o=(o.TargetUsers&&(r=o.TargetUsers),Object.keys(r).map(function(e){var t=n.getPublicUrl()+"?u="+e;return i.default.createElement(v,{targetUser:r[e],link:t})}));return o.length?(e={borderBottom:this.state.open?"1px solid #757575":"",color:"rgba(0, 0, 0, 0.36)"},i.default.createElement("div",{style:{lineHeight:"34px",padding:"4px 10px 4px",fontSize:14,backgroundColor:"#fafafa",borderRadius:2}},i.default.createElement("div",{style:c({display:"flex"},e)},i.default.createElement("div",{style:{flex:1}},this.props.getMessage("245").replace("%s",o.length)," ",i.default.createElement("span",{className:"mdi mdi-chevron-"+(this.state.open?"up":"down"),style:{cursor:"pointer"},onClick:function(){t.setState({open:!t.state.open})}})),this.state.open&&i.default.createElement("div",{style:{width:40,textAlign:"center"}},"#DL")),this.state.open&&i.default.createElement("div",null,o))):null}}]),n}();(E.default=w).propTypes={linkModel:e.default.instanceOf(r.default)},E.default=w=(0,t.default)(w),v=(0,t.default)(v),k.exports=E.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../ShareContextConsumer":1,"../links/LinkModel":18,clipboard:"clipboard","material-ui":"material-ui","prop-types":"prop-types",react:"react","react-dom":"react-dom"}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=l(e("react")),n=l(e("../ShareContextConsumer")),i=l(e("prop-types")),a=l(e("pydio")),s=l(e("pydio/http/policies")),u=e("cells-sdk"),e=l(e("./LinkModel"));function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],s=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}(e,t)||function(e,t){var r;if(e)return"string"==typeof e?p(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(r),t=(e=n?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t,r){(t=v(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function v(e){e=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===c(e)?e:String(e)}var w=a.default.requireLib("components").ResourcePoliciesPanel,O=function(e){var t=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var r,a=m(l);function l(){var o,e=this,t=l;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return g(h(o=a.call.apply(a,[this].concat(n))),"onSavePolicies",function(r){var e=o.props,t=e.linkModel,n=(e.pydio,t.getLink().UserLogin);s.default.loadPolicies("user",n).then(function(e){var t;e.length&&(t=e[0].Resource,e=o.diffPolicies(e,r,t),s.default.savePolicies("user",n,e))})}),g(h(o),"diffPolicies",function(e,r,n){var o=[];return e.map(function(e){var t=e.Action+"///"+e.Subject;r.remove[t]||o.push(e)}),Object.keys(r.add).map(function(e){var t=new u.ServiceResourcePolicy,e=f(e.split("///"),2),r=e[0],e=e[1];t.Resource=n,t.Effect=u.ServiceResourcePolicyPolicyEffect.constructFromObject("allow"),t.Subject=e,t.Action=r,o.push(t)}),o}),o}return t=l,(e=[{key:"render",value:function(){var e=this.props,t=e.linkModel,e=e.pydio,r=[],n=(r["user:"+t.getLink().UserLogin]=!0,{READ:r,WRITE:r});return o.default.createElement("div",{style:this.props.style},t.getLink().Uuid&&o.default.createElement(w,{pydio:e,resourceType:"link",description:this.props.getMessage("link.visibility.advanced"),resourceId:t.getLink().Uuid,skipTitle:!0,onSavePolicies:this.onSavePolicies.bind(this),subjectsDisabled:n,subjectsHidden:r,readonly:this.props.isReadonly()||!t.isEditable(),ref:"policies"}))}}])&&d(t.prototype,e),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(o.default.Component),a=(O.PropTypes={pydio:i.default.instanceOf(a.default).isRequired,linkModel:i.default.instanceOf(e.default).isRequired},O=(0,n.default)(O));r.default=a,t.exports=r.default},{"../ShareContextConsumer":1,"./LinkModel":18,"cells-sdk":"cells-sdk","prop-types":"prop-types",pydio:"pydio","pydio/http/policies":"pydio/http/policies",react:"react"}],25:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.ShareViewModal=r.ShareView=void 0;var s=d(e("react")),n=d(e("create-react-class")),i=d(e("prop-types")),a=d(e("pydio")),l=d(e("pydio/http/api")),u=d(e("pydio/model/node")),c=d(e("pydio/util/path")),f=e("cells-sdk"),p=e("material-ui");function d(e){return e&&e.__esModule?e:{default:e}}function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function h(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?m(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=w(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):m(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,w(n.key),n)}}function v(e,t,r){t&&g(e.prototype,t),r&&g(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function w(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}function P(e,t){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function k(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=E(r),t=(e=n?(e=E(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=a.default.requireLib("boot"),S=j.ActionDialogMixin,_=j.Loader,j=a.default.requireLib("components"),M=j.ModalAppBar,C=j.EmptyStateView,L=a.default.requireLib("hoc").ModernTextField,j=e("material-ui/styles").muiThemeable,R=function(){O(t,s["default"].Component);var e=k(t);function t(){return b(this,t),e.apply(this,arguments)}return v(t,[{key:"render",value:function(){var e=this.props,t=e.value,r=e.onChange,n=e.muiTheme,e=e.m,o={color:"#616161"},n={color:n.palette.accent1Color},i={marginRight:5};return s.default.createElement(p.Tabs,{style:{width:360},onChange:function(e){r(null,0,e)},value:t,tabItemContainerStyle:{background:"transparent"}},s.default.createElement(p.Tab,{label:s.default.createElement("span",null,s.default.createElement("span",{style:i,className:"mdi mdi-share-variant"}),e(243)),value:"LINKS",buttonStyle:"LINKS"===t?n:o}),s.default.createElement(p.Tab,{label:s.default.createElement("span",null,s.default.createElement("span",{style:i,className:"icomoon-cells"}),e(254)),value:"CELLS",buttonStyle:"CELLS"===t?n:o}))}}]),t}(),R=j()(R),x=function(){O(n,s["default"].Component);var r=k(n);function n(e){var t;return b(this,n),(t=r.call(this,e)).state={resources:[],loading:!1,selectedModel:null,shareType:e.defaultShareType||"LINKS"},t}return v(n,[{key:"getChildContext",value:function(){var r=this.props.pydio.MessageHash;return{messages:r,getMessage:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"share_center";try{return r[e+(e?".":"")+t]||t}catch(e){return t}},isReadonly:function(){return!1}.bind(this)}}},{key:"componentDidMount",value:function(){this.load()}},{key:"load",value:function(){var t=this,e=(this.setState({filter:""}),new f.ShareServiceApi(l.default.getRestClient())),r=new f.RestListSharedResourcesRequest;r.ShareType=f.ListSharedResourcesRequestListShareType.constructFromObject(this.state.shareType),this.props.subject?r.Subject=this.props.subject:r.OwnedBySubject=!0,this.setState({loading:!0}),e.listSharedResources(r).then(function(e){t.setState({resources:e.Resources||[],loading:!1})}).catch(function(){t.setState({loading:!1})})}},{key:"getLongestPath",value:function(e){var t,r,n;return e.AppearsIn?(t={},e.AppearsIn.map(function(e){t[e.Path]=e}),(r=Object.keys(t)).sort(),r=r[r.length-1],n=(n=c.default.getBasename(r))||t[r].WsLabel,{path:r,appearsIn:t[r],basename:n}):{path:e.Path,basename:e.Path}}},{key:"goTo",value:function(e){var t=e.Path,r=e.WsLabel,e=e.WsUuid,t=t.split("/"),t=(t.shift(),new u.default(t.join("/")));t.getMetadata().set("repository_id",e),t.getMetadata().set("repository_label",r),this.props.pydio.goTo(t),this.props.onRequestClose()}},{key:"render",value:function(){function o(e){return a.MessageHash["share_center."+e]}var i=this,e=this.state,t=e.loading,r=e.resources,e=e.filter,n=void 0===e?"":e,e=this.props,a=e.pydio,e=e.style,l=(r.sort(function(e,t){e=e.Node.Path,t=t.Node.Path;return e===t?0:t<e?1:-1}),a.Registry.getFilesExtensions());return s.default.createElement("div",{style:h(h({},e),{},{display:"flex",flexDirection:"column",overflow:"hidden"})},s.default.createElement("div",{style:{backgroundColor:"#F5F5F5",borderBottom:"1px solid #EEEEEE",display:"flex",paddingRight:16,paddingTop:3}},s.default.createElement(R,{m:o,value:this.state.shareType,onChange:function(e,t,r){i.setState({shareType:r},function(){i.load()})}}),s.default.createElement("span",{style:{flex:1}}),s.default.createElement("div",{style:{width:150}},s.default.createElement(L,{hintText:o("sharelist.quick-filter"),value:n,onChange:function(e,t){i.setState({filter:t})},fullWidth:!0}))),t&&s.default.createElement(_,{style:{height:400}}),!t&&0===r.length&&s.default.createElement(C,{pydio:a,iconClassName:"mdi mdi-share-variant",primaryTextId:o(131),style:{flex:1,height:400,padding:"90px 0",backgroundColor:"transparent"}}),!t&&0<r.length&&s.default.createElement(p.List,{style:{flex:1,minHeight:400,maxHeight:400,overflowY:"auto",paddingTop:0}},r.map(function(e){var t,r=i.getLongestPath(e.Node),n=r.appearsIn,r=r.basename;return t=-1===r.indexOf(".")?"mdi mdi-folder":(t=c.default.getFileExtension(r),l.has(t)?"mdi mdi-"+l.get(t).fontIcon:"mdi mdi-file"),{primaryText:r=e.Link&&e.Link.Label&&e.Link.Label!==r?e.Link.Label+" ("+r+")":r,secondaryText:e.Link?o(251)+": "+e.Link.Description:o(284).replace("%s",e.Cells.length),icon:t,appearsIn:n}}).filter(function(e){return!n||-1!==e.primaryText.toLowerCase().indexOf(n.toLowerCase())}).map(function(e){var t=e.appearsIn,r=e.icon;return s.default.createElement(p.ListItem,{primaryText:e.primaryText,secondaryText:e.secondaryText,onClick:function(){t&&i.goTo(t)},disabled:!t,leftIcon:s.default.createElement(p.FontIcon,{className:r})})})))}}]),n}(),a=((r.ShareView=x).childContextTypes={messages:i.default.object,getMessage:i.default.func,isReadonly:i.default.func},(0,n.default)({displayName:"ShareViewModal",mixins:[S],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"lg",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},render:function(){var e=this;return s.default.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},s.default.createElement(M,{title:this.props.pydio.MessageHash["share_center.98"],showMenuIconButton:!1,iconClassNameRight:"mdi mdi-close",onRightIconButtonClick:function(){e.dismiss()}}),s.default.createElement(x,y({},this.props,{style:{width:"100%",flex:1},onRequestClose:function(){e.dismiss()}})))}}));r.ShareViewModal=a},{"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/node":"pydio/model/node","pydio/util/path":"pydio/util/path",react:"react"}],26:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../ShareContextConsumer"))&&n.__esModule?n:{default:n};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=e("prop-types"),c=e("react").Component,f=e("material-ui").IconButton,e=e("material-ui/styles").muiThemeable,p=function(){var e=o,t=c;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t);var r,n=l(o);function o(){var e=this,t=o;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"render",value:function(){var e=this.props.muiTheme.palette,e=this.props.destructive?"#d32f2f":e.primary1Color,e={root:{borderRadius:"50%",border:"1px solid "+e,backgroundColor:"transparent",width:36,height:36,padding:"8px 6px",margin:"0 6px",zIndex:0},icon:{color:e,fontSize:20,lineHeight:"20px"}},t=this.props,r=t.tooltip,n=t.messageId,o=t.getMessage,t=t.messageCoreNamespace;return n&&o&&(r=this.props.getMessage(n,t||void 0)),React.createElement(f,{style:e.root,iconStyle:e.icon,onClick:this.props.callback||this.props.onClick,iconClassName:this.props.mdiIcon?"mdi mdi-"+this.props.mdiIcon:this.props.iconClassName,tooltip:r,tooltipPosition:this.props.tooltipPosition})}}])&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(),u=(p.propTypes={callback:u.func,onClick:u.func,mdiIcon:u.string,messageId:u.string},p=(0,n.default)(p),p=e()(p));r.default=u,t.exports=r.default},{"../ShareContextConsumer":1,"material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",react:"react"}],27:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var d=(n=e("react"))&&n.__esModule?n:{default:n},y=e("material-ui"),n=e("material-ui/styles");function m(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?i(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function h(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=c(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function u(e,t,r){t&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function c(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(){f(t,d["default"].Component);var e=b(t);function t(){return l(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(){var e=this.props,t=e.tabs,n=e.active,o=e.onChange,r=e.style,i=e.muiTheme.palette.primary1Color;return d.default.createElement("div",{style:h({display:"flex"},r)},t.map(function(e){var t=e.Value===n,r=e.Label;return e.Icon&&(r=d.default.createElement("span",null,d.default.createElement("span",{className:e.Icon,style:{marginLeft:-5}})," ",e.Label)),d.default.createElement(y.FlatButton,{label:r,onClick:function(){o(e.Value)},primary:t,style:{flex:1,height:46,lineHeight:"46px",borderBottom:"3px solid "+(t?i:"transparent")},labelStyle:{textTransform:"none",fontSize:15,paddingLeft:8,paddingRight:8,color:t?i:"rgba(0,0,0,.3)"}})}))}}]),t}(),v=(0,n.muiThemeable)()(v),w=function(){f(t,d["default"].Component);var e=b(t);function t(){return l(this,t),e.apply(this,arguments)}return u(t,[{key:"render",value:function(){var e=this.props,t=e.tabs,r=e.active,n=null;return t.map(function(e){e.Value===r&&(n=e.Component)}),n}}]),t}(),e=function(){f(n,d["default"].Component);var r=b(n);function n(e){var t;return l(this,n),(t=r.call(this,e)).state={left:e.tabs.left.length?e.tabs.left[0].Value:"",right:e.tabs.right.length?e.tabs.right[0].Value:""},e.defaultLeft&&(t.state.left=e.defaultLeft),e.defaultRight&&(t.state.right=e.defaultRight),t}return u(n,[{key:"componentWillReceiveProps",value:function(e){!this.props.defaultLeft&&e.defaultLeft?this.setState({left:e.defaultLeft}):!this.state.left&&e.tabs.left.length&&this.setState({left:e.tabs.left[0].Value}),!this.props.defaultRight&&e.defaultRight?this.setState({right:e.defaultRight}):!this.state.right&&e.tabs.right.length&&this.setState({right:e.tabs.right[0].Value})}},{key:"render",value:function(){var e,t=this,r=this.props,n=r.tabs,o=r.header,i=r.onSaveAction,a=r.onCloseAction,l=r.onRevertAction,s=r.saveEnabled,u=r.style,c=r.pydio,r=r.editorOneColumn,f=this.state,p=f.left,f=f.right;return r?((r=(e=(r=[].concat(m(n.left),m(n.right))).filter(function(e){return e.AlwaysLast})).length?[].concat(m(r.filter(function(e){return!e.AlwaysLast})),m(e)):r).length&&0===r.filter(function(e){return e.Value===p}).length&&(p=r[0].Value),d.default.createElement("div",{style:h({display:"flex",flexDirection:"column",height:"100%"},u)},d.default.createElement("div",{style:{display:"flex",alignItems:"center"}},d.default.createElement("div",{style:{flex:1,padding:10}},o),d.default.createElement(y.IconButton,{iconClassName:"mdi mdi-close",tooltip:c.MessageHash[86],onClick:a,style:{marginRight:10}})),d.default.createElement("div",{style:{display:"flex"}},d.default.createElement(v,{tabs:r,active:p,style:{flex:1,padding:"0 16px"},onChange:function(e){t.setState({left:e})}})),d.default.createElement(y.Divider,{style:{flexShrink:0,backgroundColor:"#e0e0e0"}}),d.default.createElement("div",{style:{display:"flex",flex:1,overflow:"hidden"}},d.default.createElement("div",{style:h({overflowY:"auto",width:"100%",height:"100%"},n.leftStyle)},d.default.createElement(w,{tabs:r,active:p}))),d.default.createElement("div",{style:{borderTop:"1px solid #eeeeee",padding:10,display:"flex",alignItems:"center",justifyContent:"flex-end"}},d.default.createElement(y.FlatButton,{disabled:!s,label:c.MessageHash[628],onClick:l,style:{marginLeft:10}}),d.default.createElement(y.RaisedButton,{disabled:!s,primary:!0,label:c.MessageHash[53],onClick:i})))):(n.left&&n.left.length&&0===n.left.filter(function(e){return e.Value===p}).length&&(p=n.left[0].Value),n.right&&n.right.length&&0===n.right.filter(function(e){return e.Value===p}).length&&(f=n.right[0].Value),d.default.createElement("div",{style:h({backgroundColor:"#fafafa",display:"flex",flexDirection:"column",height:"100%"},u)},d.default.createElement("div",{style:{display:"flex",alignItems:"center",padding:10,paddingBottom:0}},d.default.createElement("div",{style:{flex:1,alignItems:"center",paddingRight:20}},o),d.default.createElement(y.RaisedButton,{disabled:!s,primary:!0,label:c.MessageHash[53],onClick:i}),d.default.createElement(y.FlatButton,{disabled:!s,label:c.MessageHash[628],onClick:l,style:{marginLeft:10}}),d.default.createElement(y.IconButton,{iconClassName:"mdi mdi-close",tooltip:c.MessageHash[86],onClick:a,style:{marginLeft:10}})),d.default.createElement("div",{style:{display:"flex"}},d.default.createElement(v,{tabs:n.left,active:p,style:{flex:1,margin:"0 16px"},onChange:function(e){t.setState({left:e})}}),d.default.createElement(v,{tabs:n.right,active:f,style:{flex:1,margin:"0 16px"},onChange:function(e){t.setState({right:e})}})),d.default.createElement(y.Divider,{style:{flexShrink:0,display:"none"}}),d.default.createElement("div",{style:{display:"flex",flex:1,overflow:"hidden",padding:"0 5px 5px"}},d.default.createElement(y.Paper,{zDepth:1,style:h({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},n.leftStyle)},d.default.createElement(w,{tabs:n.left,active:p})),d.default.createElement(y.Paper,{zDepth:1,style:h({overflowY:"auto",width:"50%",margin:"0 5px 5px",border:"1px solid #e0e0e0",borderRadius:5},n.rightStyle)},d.default.createElement(w,{tabs:n.right,active:f})))))}}]),n}();r.default=e,t.exports=r.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",react:"react"}],28:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("pydio")),i=s(e("react")),a=s(e("../composite/CompositeCard")),l=s(e("../cells/CellCard"));function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=n.default.requireLib("workspaces").InfoPanelCard,e=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,n=f(o);function o(e){if(this instanceof o)return(e=n.call(this,e)).state={popoverOpen:!1},e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"openPopover",value:function(e){this.setState({popoverOpen:!0,popoverAnchor:e.target})}},{key:"render",value:function(){var e=this.props,t=e.pydio,r=e.node,n=e.popoverPanel,e=e.popoverRequestClose;return r.isRoot()?i.default.createElement(d,{popoverPanel:n},i.default.createElement("div",{style:{padding:0}},i.default.createElement(l.default,{cellId:t.user.activeRepository,pydio:t,mode:"infoPanel"}))):i.default.createElement(d,{popoverPanel:n},i.default.createElement("div",{style:{padding:0}},i.default.createElement(a.default,{node:r,pydio:t,mode:"infoPanel",popoverPanel:n,popoverRequestClose:e})))}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(i.default.Component);r.default=e,t.exports=r.default},{"../cells/CellCard":2,"../composite/CompositeCard":9,pydio:"pydio",react:"react"}],29:[function(r,u,p){!function(l){!function(){"use strict";Object.defineProperty(p,"__esModule",{value:!0}),p.default=void 0;var n=e(r("pydio/util/xml")),s=e(r("pydio/http/api")),c=e(r("pydio")),f=r("cells-sdk");function e(e){return e&&e.__esModule?e:{default:e}}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}var a=c.default.requireLib("boot").moment,t=function(){function u(){if(!(this instanceof u))throw new TypeError("Cannot call a class as a function")}var e,t,r;return e=u,r=[{key:"mailerSupported",value:function(e){return e.Parameters.get("validMailer")}},{key:"getAuthorizations",value:function(){var e=c.default.getInstance(),t=e.getPluginConfigs("action.share"),r={folder_public_link:t.get("ENABLE_FOLDER_PUBLIC_LINK"),folder_workspaces:t.get("ENABLE_FOLDER_INTERNAL_SHARING"),file_public_link:t.get("ENABLE_FILE_PUBLIC_LINK"),file_workspaces:t.get("ENABLE_FILE_INTERNAL_SHARING"),editable_hash:t.get("HASH_USER_EDITABLE"),hash_min_length:t.get("HASH_MIN_LENGTH")||6,password_mandatory:!1,max_expiration:t.get("FILE_MAX_EXPIRATION"),max_downloads:t.get("FILE_MAX_DOWNLOAD")},t=t.get("SHARE_FORCE_PASSWORD");return t&&(r.password_mandatory=!0),r.password_placeholder=t?e.MessageHash["share_center.176"]:e.MessageHash["share_center.148"],r}},{key:"buildPublicUrl",value:function(e,t){var r=e.Parameters;return 2<arguments.length&&void 0!==arguments[2]&&arguments[2]?"..."+r.get("PUBLIC_BASEURI")+"/"+t.LinkHash:t.LinkUrl&&t.LinkUrl.match(new RegExp("^http://|^https://"))?t.LinkUrl:(e=e.getFrontendUrl(),"".concat(e.protocol,"//").concat(e.host)+r.get("PUBLIC_BASEURI")+"/"+t.LinkHash)}},{key:"nodeHasEditor",value:function(e,t){var r;return t.getMetadata().has("mime_has_preview_editor")||(r=(e=(e=e.Registry.findEditorsForMime(t.getAjxpMime())).filter(function(e){return"editor.browser"!==e.id&&"editor.other"!==e.id})).filter(function(e){return e.canWrite}),t.getMetadata().set("mime_has_preview_editor",0<e.length),t.getMetadata().set("mime_has_writeable_editor",0<r.length)),{preview:t.getMetadata().get("mime_has_preview_editor"),writeable:t.getMetadata().get("mime_has_writeable_editor")}}},{key:"compileLayoutData",value:function(o,e){var i,a,l,s=e.getNode(),e=s.isLeaf()?(i=s.getAjxpMime(),n.default.XPathSelectNodes(o.getXmlRegistry(),"//template[contains(@name, 'unique_preview_')]")):n.default.XPathSelectNodes(o.getXmlRegistry(),"//template[contains(@name, 'minisite_')]");return e.length?1===e.length?[{LAYOUT_NAME:e[0].getAttribute("element"),LAYOUT_LABEL:""}]:(a=o.Parameters.get("theme"),l=[],e.map(function(e){var t,r,n=e.getAttribute("theme");n&&n!==a||(n=e.getAttribute("element"),t=e.getAttribute("name"),r=e.getAttribute("label"),i&&"unique_preview_file"===t&&!u.nodeHasEditor(o,s).preview)||(r?MessageHash[r]&&(r=MessageHash[r]):r=e.getAttribute("name"),l[t]=n,l.push({LAYOUT_NAME:t,LAYOUT_ELEMENT:n,LAYOUT_LABEL:r}))}),l):[]}},{key:"forceMailerOldSchool",value:function(){return l.pydio.getPluginConfigs("action.share").get("EMAIL_INVITE_EXTERNAL")}},{key:"qrcodeEnabled",value:function(){return l.pydio.getPluginConfigs("action.share").get("CREATE_QRCODE")}},{key:"sendCellInvitation",value:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:function(){},e=u.prepareEmail(e,null,t),t=e.templateId,e=e.templateData,o=new f.MailerMail,i=new f.MailerServiceApi(s.default.getRestClient()),a=(o.To=[],0),l=(Object.keys(r).map(function(e){var e=r[e],t=new f.MailerUser;return e.IdmUser&&e.IdmUser.Login&&e.IdmUser.Attributes&&(e.IdmUser.Attributes.hasEmail||e.IdmUser.Attributes.email)?(t.Uuid=e.IdmUser.Login,o.To.push(t)):a++,t}),c.default.getInstance().MessageHash);o.To.length?(o.TemplateId=t,o.TemplateData=e,i.send(o).then(function(){n()}),t=l["core.mailer.1"].replace("%s",o.To.length),0<a&&(t+=" "+l["core.mailer.entries.ignored"]),c.default.getInstance().UI.displayMessage("SUCCESS",t)):c.default.getInstance().UI.displayMessage("ERROR",l["core.mailer.entries.ignored"])}},{key:"prepareEmail",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n={},o="",i=pydio.user;return i.getPreference("displayName")?n.Inviter=i.getPreference("displayName"):n.Inviter=i.id,t?(i=t.getLink(),e.isLeaf()?(o="PublicFile",n.FileName=i.Label||e.getLabel()):(o="PublicFolder",n.FolderName=i.Label||e.getLabel()),n.LinkPath="/public/"+i.LinkHash,i.MaxDownloads&&(n.MaxDownloads=i.MaxDownloads+""),i.AccessEnd&&(e=a(new Date(1e3*i.AccessEnd)),n.Expire=e.format("LL"))):(o="Cell",n.Cell=r.getLabel()),{templateId:o,templateData:n,message:"",linkModel:t}}}],(t=null)&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),u}();p.default=t,u.exports=p.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/xml":"pydio/util/xml"}]},{},[15])(15)});