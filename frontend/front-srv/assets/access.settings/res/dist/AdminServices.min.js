!function r(i,n,s){function o(t,e){if(!n[t]){if(!i[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(l)return l(t,!0);throw(a=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",a}a=n[t]={exports:{}},i[t][0].call(a.exports,function(e){return o(i[t][1][e]||e)},a,a.exports,r,i,n,s)}return n[t].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)o(s[e]);return o}({1:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=c(e("prop-types")),i=c(e("pydio")),n=c(e("pydio/model/data-model")),s=c(e("pydio/model/node")),o=c(e("react")),l=c(e("create-react-class")),d=c(e("./ServicesList")),u=e("material-ui");function c(e){return e&&e.__esModule?e:{default:e}}var e=i.default.requireLib("hoc"),p=e.ModernSelectField,f=e.ModernTextField,i=(0,l.default)({displayName:"Dashboard",mixins:[AdminComponents.MessagesConsumerMixin],propTypes:{dataModel:r.default.instanceOf(n.default).isRequired,rootNode:r.default.instanceOf(s.default).isRequired,currentNode:r.default.instanceOf(s.default).isRequired,openEditor:r.default.func.isRequired,openRightPane:r.default.func.isRequired,closeRightPane:r.default.func.isRequired,pydio:r.default.instanceOf(i.default)},getInitialState:function(){return{filter:"",peers:[],peerFilter:""}},onDetailsChange:function(e,t){this.setState({details:t}),localStorage.setItem("console.services.details",t?"true":"false")},onFilterChange:function(e,t,a){this.setState({filter:a})},onPeerFilterChange:function(e,t,a){this.setState({peerFilter:a})},reloadList:function(){this.refs.servicesList.reload()},onUpdatePeers:function(e){this.setState({peers:e})},render:function(){var a=this,t=this.props.pydio,e=this.state,r=e.peers,i=e.peerFilter,n=e.filter,s=e.inputFilter,e=void 0===s?"":s,s=function(e){return t.MessageHash["ajxp_admin.services."+e]||e},r=o.default.createElement("div",{style:{display:"flex",alignItems:"center",width:"100%"}},o.default.createElement("div",{style:{width:150,marginRight:8},className:"media-small-hide"},o.default.createElement(f,{fullWidth:!0,value:e,onChange:function(e,t){return a.setState({inputFilter:t})},hintText:s("text-filter.hint")})),0<r.length&&o.default.createElement("div",{style:{width:150,height:14,marginRight:8}},o.default.createElement(p,{fullWidth:!0,className:"media-small-hide",style:{marginTop:-10},underlineStyle:{display:"none"},value:i,onChange:this.onPeerFilterChange},o.default.createElement(u.MenuItem,{value:"",primaryText:s("peerfilter.title")}),r.map(function(e){return o.default.createElement(u.MenuItem,{value:e,primaryText:e})}))),o.default.createElement("div",{style:{width:150,height:14}},o.default.createElement(p,{fullWidth:!0,className:"media-small-hide",style:{marginTop:-10},underlineStyle:{display:"none"},value:n,onChange:this.onFilterChange},o.default.createElement(u.MenuItem,{value:"",primaryText:s("filter.nofilter")}),o.default.createElement(u.MenuItem,{value:"STARTED",primaryText:s("filter.started")}),o.default.createElement(u.MenuItem,{value:"STOPPED",primaryText:s("filter.stopped")})))),s=this.props.toolsAbsolute;return o.default.createElement("div",{className:"main-layout-nav-to-stack workspaces-board"},o.default.createElement("div",{className:"vertical-layout",style:{width:"100%"}},o.default.createElement(AdminComponents.Header,{title:s?"":this.context.getMessage("172","settings"),icon:s?"":"mdi mdi-access-point-network",legend:this.context.getMessage("173","settings"),actions:[r],reloadAction:this.reloadList.bind(this),style:s?{position:"absolute",top:0,right:0}:null}),o.default.createElement(d.default,{ref:"servicesList",pydio:t,className:"layout-fill",style:{paddingBottom:16},dataModel:this.props.dataModel,rootNode:this.props.rootNode,currentNode:this.props.rootNode,filter:n,peerFilter:i,inputFilter:e,onUpdatePeers:this.onUpdatePeers.bind(this)})))}});a.default=i,t.exports=a.default},{"./ServicesList":3,"create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model","pydio/model/node":"pydio/model/node",react:"react"}],2:[function(e,t,a){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r,u=(r=e("react"))&&r.__esModule?r:{default:r},c=e("material-ui");function n(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(a){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(a);return e=r?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==i(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(i,u["default"].Component);var e,t,a,r=o(i);function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.apply(this,arguments)}return e=i,(t=[{key:"renderServiceLine",value:function(e,t,a,r){var i="STARTED"===e.Status?"#33691e":"#d32f2f",n=!1;"STARTED"!==e.Status&&e.Metadata&&e.Metadata.unique&&(i="#9E9E9E",n=!0);var s=e.Name.startsWith("pydio.grpc.")?"Grpc":"Rest";"gateway"===t?s=e.Name.split(".").pop():"datasource"===t&&(e.Name.startsWith("pydio.grpc.data.sync.")?s=r("datasource.sync"):e.Name.startsWith("pydio.grpc.data.objects.")?s=r("datasource.objects"):e.Name.startsWith("pydio.grpc.data.index.")&&(s=r("datasource.index")));var o=[];"STARTED"===e.Status&&e.RunningPeers?e.RunningPeers.map(function(e){e.Port?o.push(e.Address+":"+e.Port):o.push(e.Address)}):n?o.push("Standby"):o.push("N/A");return u.default.createElement("div",{style:{display:"flex",alignItems:"center",margin:"6px 8px",backgroundColor:"#F5F5F5",padding:"8px 6px",borderRadius:2}},u.default.createElement(c.FontIcon,{style:{margin:"0 9px 0 4px",fontSize:20},className:"mdi-traffic-light",color:i}),u.default.createElement("span",{style:{flex:1}},o.join(", ")),a&&u.default.createElement("span",{style:{fontStyle:"italic",paddingRight:6,fontWeight:500,color:"#9e9e9e"}},s))}},{key:"render",value:function(){function t(e){return l.MessageHash["ajxp_admin.services.service."+e]||e}var a,r=this,e=this.props,i=e.title,n=e.services,s=e.tagId,o=e.showDescription,l=e.pydio;1<n.length&&n.map(function(e){e.Name.startsWith("pydio.grpc.")&&(a=e.Description)});var d=a||n[0].Description;d||"datasource"!==s||(d=n[0].Name.startsWith("pydio.grpc.data.objects.")?t("datasource.objects.legend"):t("datasource.legend"));e={container:{flex:1,minWidth:200,margin:4,display:"flex",flexDirection:"column"},title:{padding:8,fontSize:15,fontWeight:500,borderBottom:"1px solid #eee"},description:{padding:8,flex:1}};return u.default.createElement(c.Paper,{zDepth:1,style:e.container},u.default.createElement("div",{style:e.title},i),o&&u.default.createElement("div",{style:e.description},d),u.default.createElement("div",null,n.map(function(e){return r.renderServiceLine(e,s,o,t)})))}}])&&n(e.prototype,t),a&&n(e,a),i}();a.default=d,t.exports=a.default},{"material-ui":"material-ui",react:"react"}],3:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var r=l(e("prop-types")),i=l(e("pydio")),p=l(e("react")),n=l(e("create-react-class")),s=l(e("pydio/http/api")),o=e("cells-sdk"),f=e("material-ui");l(e("./ServiceCard"));function l(e){return e&&e.__esModule?e:{default:e}}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a,r=arguments[t];for(a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var h=i.default.requireLib("components").MaterialTable,y=["gateway","datasource","data","idm","scheduler","broker","frontend","discovery"];r=(0,n.default)({displayName:"ServicesList",mixins:[AdminComponents.MessagesConsumerMixin],propTypes:{dataModel:r.default.instanceOf(PydioDataModel).isRequired,rootNode:r.default.instanceOf(AjxpNode).isRequired,currentNode:r.default.instanceOf(AjxpNode).isRequired,filter:r.default.string,peerFilter:r.default.string,details:r.default.bool,onUpdatePeers:r.default.func},getInitialState:function(){return{services:[]}},componentDidMount:function(){this.load()},reload:function(){this.load()},load:function(){var a=this,e=new o.ConfigServiceApi(s.default.getRestClient());i.default.startLoading(),this.setState({loading:!0}),e.listServices().then(function(e){var t;i.default.endLoading(),a.setState({loading:!1}),a.setState({services:e.Services}),a.props.onUpdatePeers&&(e=e.Services,t={},e.filter(function(e){return!!e.RunningPeers}).map(function(e){e.RunningPeers.map(function(e){e.Address&&(t[e.Address]=e.Address)})}),e=Object.keys(t),a.props.onUpdatePeers(e))}).catch(function(){i.default.endLoading(),a.setState({loading:!1})})},renderListItem:function(e){var t,a=[],r=this.props,i=r.details,r=r.pydio;return i&&(e.Description&&a.push(e.Description),(i=e.RunningPeers)&&i.length&&(t=[],i.map(function(e){t.push(e.Address)}),a.push(r.MessageHash["ajxp_admin.services.service.ip"].replace("%s",t.join(","))))),p.default.createElement(f.ListItem,{primaryText:e.Name,secondaryText:a.join(" - "),leftCheckbox:p.default.createElement(f.Checkbox,{defaultChecked:"STARTED"===e.Status,checked:"STARTED"===e.Status})})},filterNodes:function(e){var t=this;return-1===e.Name.indexOf(".(.+)")&&((!this.props.filter||e.Status===this.props.filter)&&(!(this.props.inputFilter&&e.Name.indexOf(this.props.inputFilter)<=0)&&(!this.props.peerFilter||!!e.RunningPeers&&0<e.RunningPeers.filter(function(e){return e.Address===t.props.peerFilter}).length)))},render:function(){function r(e){return n.MessageHash["ajxp_admin.services.tag."+e]||e}var e,i,t=this,n=this.props.pydio,a=this.state,s=a.services,o=void 0===s?[]:s,l=a.loading,d=function(e){return n.MessageHash["ajxp_admin.services.column."+e]||e},u=(e=o.filter(function(e){return t.filterNodes(e)}),i={},e.sort(function(e,t){return e.Name>t.Name?1:e.Name===t.Name?0:-1}),y.forEach(function(r){i[r]={services:{}},e.map(function(e){var t,a;r===e.Tag&&((a=e.Name).startsWith("pydio.grpc.")?a=a.replace("pydio.grpc.",""):a.startsWith("pydio.rest.")&&(a=a.replace("pydio.rest.","")),"datasource"===r&&a.startsWith("data.")&&(a="index"===(a=a.replace("data.",""))||"sync"===a||"objects"===a?"main - "+a:(t=a.split(".").shift(),a=a.split(".").pop(),"objects"===t?"objects - "+a:"datasource - "+a)),i[r].services[a]||(i[r].services[a]=[]),i[r].services[a].push(e))})}),i),c=[],s=[{name:"Status",label:"",style:{width:56,paddingLeft:12,paddingRight:12,textOverflow:"inherit"},headerStyle:{width:56},renderCell:function(e){var t="STARTED"===e.Status?"#33691e":"#d32f2f",a="STARTED"===e.Status?"Running":"Stopped";return"STARTED"!==e.Status&&e.Metadata&&e.Metadata.unique&&(t="#9E9E9E",a="Standby"),{element:p.default.createElement(f.FontIcon,{style:{margin:"0 9px 0 4px",fontSize:20},className:"mdi-traffic-light",color:t}),text:a}}},{name:"Name",label:d("name"),style:{paddingLeft:0},headerStyle:{paddingLeft:0}},{name:"Description",label:d("description"),style:{width:"40%"},headerStyle:{width:"40%"},hideSmall:!0},{name:"Version",label:d("version"),style:{width:110},headerStyle:{width:110},hideSmall:!0},{name:"Type",label:d("tag"),style:{width:120},headerStyle:{width:120},hideSmall:!0,renderCell:function(e){function t(e){return n.MessageHash["ajxp_admin.services.service."+e]||e}var a=e.Name.startsWith("pydio.grpc.")?"Grpc":"Rest";return"gateway"===e.Tag?a=e.Name.split(".").pop():"datasource"===e.Tag&&(e.Name.startsWith("pydio.grpc.data.sync.")?a=t("datasource.sync"):e.Name.startsWith("pydio.grpc.data.objects.")?a=t("datasource.objects"):e.Name.startsWith("pydio.grpc.data.index.")&&(a=t("datasource.index"))),a}},{name:"RunningPeers",label:d("peers"),hideSmall:!0,renderCell:function(e){var t=[];return"STARTED"===e.Status&&e.RunningPeers?t=e.RunningPeers.map(function(e){return e.Metadata&&e.Metadata["non-addressable"]?e.Metadata["non-addressable"]:e.Port?e.Address+":"+e.Port:e.Address}):t.push("N/A"),t.join(",")}}];Object.keys(u).forEach(function(e){var t=[],a=u[e].services;Object.keys(a).forEach(function(e){a[e].forEach(function(e){t.push(e)})}),t.length&&(t.unshift({Subheader:p.default.createElement("span",null,p.default.createElement("span",{style:{textTransform:"uppercase"}},r(e+".title"))," - ",r(e+".description"))}),c.push.apply(c,t))});a=AdminComponents.AdminStyles().body,o=a.tableMaster,d=a.block.props,a=a.block.container;return p.default.createElement("div",{className:this.props.className,style:this.props.style},p.default.createElement(f.Paper,m({},d,{style:a}),p.default.createElement(h,{data:c,columns:s,deselectOnClickAway:!0,showCheckboxes:!1,emptyStateString:n.MessageHash["ajxp_admin.services.empty."+(l?"loading":"noservice")],masterStyles:o})))}});a.default=r,t.exports=a.default},{"./ServiceCard":2,"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],4:[function(e,t,a){"use strict";var r,i=(r=e("./board/Dashboard"))&&r.__esModule?r:{default:r};window.AdminServices={Dashboard:i.default}},{"./board/Dashboard":1}]},{},[4]);