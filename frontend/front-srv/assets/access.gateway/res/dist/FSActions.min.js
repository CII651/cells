!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).FSActions=e()}(function(){return function n(r,i,a){function l(t,e){if(!i[t]){if(!r[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(s)return s(t,!0);throw(o=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",o}o=i[t]={exports:{}},r[t][0].call(o.exports,function(e){return l(r[t][1][e]||e)},o,o.exports,n,r,i,a)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(n){return function(){var e,t=i.getUrlFromBase(),o=n.repositoryId||(n.user?n.user.activeRepository:null);!n.user||(e=n.user.repositories.get(o).getSlug())&&(o="ws-"+e),o=a.trimRight(t,"/")+"/"+o+n.getUserSelection().getUniqueNode().getPath(),n.UI.openComponentInModal("PydioReactUI","PromptDialog",{dialogTitleId:369,fieldLabelId:296,defaultValue:o,submitValue:r.Empty})}};var r=e("pydio/util/func"),i=e("pydio/util/dom"),a=e("pydio/util/lang");t.exports=o.default},{"pydio/util/dom":"pydio/util/dom","pydio/util/func":"pydio/util/func","pydio/util/lang":"pydio/util/lang"}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(l){return function(e,t,o,n){var r=l.user.getActiveRepositoryObject().getSlug(),i=r;!n||(n=l.user.getRepositoriesList().get(n))&&(i=n.getSlug());var a=t.getSelectedNodes(),o={nodes:a.map(function(e){return r+e.getPath()}),target:i+o,targetParent:!0};s.getRestClient().userJob(e,o).then(function(o){"move"===e?a.forEach(function(e){var t=l.MessageHash["background.move."+(e.isLeaf()?"file":"folder")];e.getMetadata().set("pending_operation",t),e.getMetadata().set("pending_operation_uuid",o.JobUuid),e.notify("meta_replaced",e)}):l.UI.displayMessage("SUCCESS",l.MessageHash["background.copy.selection"]),l.getContextHolder().setSelectedNodes([])}).catch(function(e){e=e.Detail||e.message||e;l.UI.displayMessage("ERROR",e)})}};var s=e("pydio/http/api");t.exports=o.default},{"pydio/http/api":"pydio/http/api"}],3:[function(r,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(n){var e=n.MessageHash;return function(){var o=n.getUserSelection();n.UI.openComponentInModal("FSActions","TreeDialog",{isMove:!1,dialogTitle:e[159],submitValue:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;r("./applyCopyOrMove")(n)("copy",o,e,t)}})}},e.exports=t.default},{"./applyCopyOrMove":2}],4:[function(e,t,o){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(i){var n=i.MessageHash;return function(){var e,t=n[176],o=i.getPluginConfigs("access.gateway").get("DELETE_ALLOW_PERMANENT");"true"===i.getContextHolder().getRootNode().getMetadata().get("ws_skip_recycle")||0===i.getContextHolder().getContextNode().getPath().indexOf("/recycle_bin")?t=n[177]:o&&(e={removePermanently:function(e){return a.default.createElement(f,{onChange:e,messages:n})}}),i.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{message:t,dialogTitleId:7,moreComponents:e,validCallback:function(e){var o=i.getContextHolder().getSelectedNodes(),n=i.user.getActiveRepositoryObject().getSlug(),t=new s.RestDeleteNodesRequest,r=new s.TreeServiceApi(l.default.getRestClient());t.Nodes=o.map(function(e){var t=new s.TreeNode;return t.Path=n+e.getPath(),t}),e&&e.removePermanently&&(t.RemovePermanently=!0),r.deleteNodes(t).then(function(t){t.DeleteJobs&&t.DeleteJobs.length&&o.forEach(function(e){e.getMetadata().set("pending_operation",t.DeleteJobs[0].Label),e.getMetadata().set("pending_operation_uuid",t.DeleteJobs[0].Uuid),e.notify("meta_replaced",e)}),i.getContextHolder().setSelectedNodes([])}).catch(function(e){i.UI.displayMessage("ERROR",e.Title||e.message)})}})}};var a=n(e("react")),l=n(e("pydio/http/api")),i=e("material-ui"),s=e("cells-sdk");function n(e){return e&&e.__esModule?e:{default:e}}function d(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(o){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(o);return e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,a["default"].Component);var e,t,o,n=c(r);function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=n.call(this,e)).state={},e}return e=r,(t=[{key:"render",value:function(){var o=this,e=this.props,n=e.onChange,t=e.messages,r=this.state.checked,e=": "+t["action.delete.permanently.warning"];return a.default.createElement("div",{style:{marginTop:16}},a.default.createElement(i.Checkbox,{onCheck:function(e,t){o.setState({checked:t}),n("removePermanently",t)},label:t["action.delete.permanently"]+(r?e:""),labelPosition:"right",labelStyle:r?{color:"#f44336"}:{color:"inherit"}}))}}])&&d(e.prototype,t),o&&d(e,o),r}();t.exports=o.default},{"cells-sdk":"cells-sdk","material-ui":"material-ui","pydio/http/api":"pydio/http/api",react:"react"}],5:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return function(){var e=t.getUserSelection();n.getClient().downloadSelection(e)}};var n=e("pydio/http/api");t.exports=o.default},{"pydio/http/api":"pydio/http/api"}],6:[function(o,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){return function(){var e=t.getContextHolder();e.setSelectedNodes([e.getRootNode()]),o("./download")(t)()}},e.exports=t.default},{"./download":5}],7:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(a){return function(){var e=a.getUserSelection().getUniqueNode(),t=l.default.getClient(),o=s.default.getBasename(e.getPath()).replace(e.getAjxpMime(),"pdf"),n=navigator.userAgent||"",r=-1!==n.indexOf("iPhone")||-1!==n.indexOf("iPod")||-1!==n.indexOf("iPad")||-1!==n.indexOf("iOs"),i=a.UI&&a.UI.hasHiddenDownloadForm();t.buildPresignedGetUrl(e,null,"",{Bucket:"io",Key:"pydio-thumbstore/"+e.getMetadata().get("PDFPreview"),Expires:600},o).then(function(e){r||!i?document.location.href=e:a.UI.sendDownloadToHiddenForm(a.getUserSelection(),{presignedUrl:e})})}};var l=n(e("pydio/http/api")),s=n(e("pydio/util/path"));function n(e){return e&&e.__esModule?e:{default:e}}t.exports=o.default},{"pydio/http/api":"pydio/http/api","pydio/util/path":"pydio/util/path"}],8:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(r){var e=r.MessageHash;return function(){r.UI.openComponentInModal("PydioReactUI","ConfirmDialog",{message:e[177],dialogTitleId:220,validCallback:function(){var e=r.user.getActiveRepositoryObject().getSlug(),t=new a.RestDeleteNodesRequest,o=new a.TreeServiceApi(i.default.getRestClient()),n=new a.TreeNode;n.Path=e+"/recycle_bin",t.Nodes=[n],o.deleteNodes(t).then(function(e){e.DeleteJobs&&e.DeleteJobs.forEach(function(e){r.UI.displayMessage("SUCCESS",e.Label)}),r.getContextHolder().requireContextChange(r.getContextHolder().getRootNode())}).catch(function(e){r.UI.displayMessage("ERROR",e.Title||e.message)})}})}};var n,i=(n=e("pydio/http/api"))&&n.__esModule?n:{default:n},a=e("cells-sdk");t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api"}],9:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return function(){var e=t.getContextHolder().getUniqueNode();t.goTo(e)}},t.exports=o.default},{}],10:[function(o,n,r){!function(t){!function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=t.pydio,e={ls:o("./ls")(e),mkdir:o("./mkdir")(e),deleteAction:o("./deleteAction")(e),rename:o("./rename").renameFunction,renameCallback:o("./rename").callback,applyCopyOrMove:o("./applyCopyOrMove")(e),copy:o("./copy")(e),move:o("./move")(e),upload:o("./upload")(e),download:o("./download")(e),downloadPDF:o("./downloadPDF")(e),downloadAll:o("./downloadAll")(e),emptyRecycle:o("./emptyRecycle")(e),restore:o("./restore")(e),openInEditor:o("./openInEditor")(e),ajxpLink:o("./ajxpLink")(e),openOtherEditorPicker:o("./openOtherEditorPicker")(e),lock:o("./lock")(e),goTo:o("./goto")(e)};r.default=e,n.exports=r.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ajxpLink":1,"./applyCopyOrMove":2,"./copy":3,"./deleteAction":4,"./download":5,"./downloadAll":6,"./downloadPDF":7,"./emptyRecycle":8,"./goto":9,"./lock":11,"./ls":12,"./mkdir":13,"./move":14,"./openInEditor":15,"./openOtherEditorPicker":16,"./rename":17,"./restore":18,"./upload":19}],11:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(i){return function(){var e=new l.UserMetaServiceApi(a.default.getRestClient()),t=new l.IdmUpdateUserMetaRequest,o=i.getContextHolder().getUniqueNode(),n=new l.IdmUserMeta;n.NodeUuid=o.getMetadata().get("uuid"),n.Namespace="content_lock",n.JsonValue=i.user.id;var r=o.getMetadata().get("sl_locked");t.Operation=r?"DELETE":"PUT",t.MetaDatas=[n],e.updateUserMeta(t).then(function(e){i.getContextHolder().requireNodeReload(o)})}};var n,a=(n=e("pydio/http/api"))&&n.__esModule?n:{default:n},l=e("cells-sdk");t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api"}],12:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return function(){e.goTo(e.getUserSelection().getUniqueNode())}},t.exports=o.default},{}],13:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(r){return function(){r.UI.openComponentInModal("PydioReactUI","PromptDialog",{dialogTitleId:154,legendId:155,fieldLabelId:173,dialogSize:"sm",submitValue:function(e){if(-1!==e.indexOf("/")){var t=r.MessageHash["filename.forbidden.slash"];throw r.UI.displayMessage("ERROR",t),new Error(t)}var o=new l.TreeServiceApi(i.default.getRestClient()),n=new l.RestCreateNodesRequest,t=r.user.getActiveRepositoryObject().getSlug()+a.default.trimRight(r.getContextNode().getPath(),"/")+"/"+e,e=new l.TreeNode;e.Path=t,e.Type=l.TreeNodeType.constructFromObject("COLLECTION"),n.Nodes=[e],o.createNodes(n).then(function(e){console&&console.debug("Created nodes",e.Children)})}})}};var i=n(e("pydio/http/api")),a=n(e("pydio/util/lang")),l=e("cells-sdk");function n(e){return e&&e.__esModule?e:{default:e}}t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang"}],14:[function(u,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(l){function s(e,t){var o=t.getMetadata().has("repository_id");if(t.getMetadata().has("local:dropFunc"))t.getMetadata().has("local:canDropFunc")&&t.getMetadata().get("local:canDropFunc")(e,t);else{if(t.isLeaf()||t.getPath()===e.getPath()||!o&&r.default.trimRight(t.getPath(),"/")===n.default.getDirname(e.getPath()))throw new Error("Cannot drop on leaf or on same path");if(t.getMetadata().has("virtual_root"))throw new Error("Cannot drop on virtual root");if(e.getMetadata().has("ws_root"))throw new Error("Cannot move roots around");if("true"===t.getMetadata().get("node_readonly")||t.getMetadata().has("workspaceEntry")&&!t.getMetadata().get("workspaceEntry").allowCrossRepositoryCopy)throw new Error("Cannot drop on this branch (readonly)")}}var d=l.MessageHash;return function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(t&&t instanceof c){if(t.getStep()===c.STEP_CAN_DROP){var o=t.getTarget(),n=t.getSource();return s(n,o),!1}if(t.getStep()===c.STEP_END_DRAG){try{s(t.getSource(),t.getTarget())}catch(e){return}var r=e.getDataModel(),n=t.getTarget().getPath(),o=null;if(t.getTarget().getMetadata().has("repository_id")){var o=t.getTarget().getMetadata().get("repository_id"),i=t.getTarget().getMetadata().get("workspaceEntry");if(i&&"cell"===i.getRepositoryType())return void l.UI.openComponentInModal("FSActions","CrossWsDropDialog",{target:t.getTarget(),source:t.getSource(),dropEffect:t.getDropEffect()||"move",cellWs:i})}else if(t.getTarget().getMetadata().has("local:dropFunc"))return void t.getTarget().getMetadata().get("local:dropFunc")("dnd",t.getSource(),t.getTarget());e=u("./applyCopyOrMove")(l),i=t.getSource();-1===r.getSelectedNodes().indexOf(i)?((i=new PydioDataModel).setContextNode(r.getContextNode()),i.setSelectedNodes([t.getSource()]),e(t.getDropEffect()||"move",i,n,o)):e(t.getDropEffect()||"move",r,n,o)}}else{var a=l.getUserSelection();l.UI.openComponentInModal("FSActions","TreeDialog",{isMove:!0,dialogTitle:d[160],submitValue:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;u("./applyCopyOrMove")(l)("move",a,e,t)}})}}};var n=o(u("pydio/util/path")),r=o(u("pydio/util/lang"));function o(e){return e&&e.__esModule?e:{default:e}}var c=u("pydio").requireLib("components").DNDActionParameter;e.exports=t.default},{"./applyCopyOrMove":2,pydio:"pydio","pydio/util/lang":"pydio/util/lang","pydio/util/path":"pydio/util/path"}],15:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(o){return function(e,t){t=t&&t.length?t[0]:null;o.UI.openCurrentSelectionInEditor(t)}},t.exports=o.default},{}],16:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return function(){e.UI.openComponentInModal("FSActions","OtherEditorPickerDialog",{selection:e.getUserSelection(),pydio:e})}},t.exports=o.default},{}],17:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(i){return function(){function t(o,n){if(o=o||i.getUserSelection().getUniqueNode(),-1!==n.indexOf("/"))throw new Error(i.MessageHash["filename.forbidden.slash"]);var e={nodes:[e=i.user.getActiveRepositoryObject().getSlug()+o.getPath()],target:l.default.getDirname(e)+"/"+n,targetParent:!1};a.default.getRestClient().userJob("move",e).then(function(e){var t=i.MessageHash["rename.processing"].replace("%1",o.getLabel()).replace("%2",n);i.UI.displayMessage("SUCCESS",t),r.getMetadata().set("pending_operation",t),r.getMetadata().set("pending_operation_uuid",e.JobUuid),r.notify("meta_replaced",r),i.getContextHolder().setSelectedNodes([])}).catch(function(e){e=e.Detail||e.message||e;i.UI.displayMessage("ERROR",e)})}var e,r=i.getUserSelection().getSelectedNodes()[0];r&&((e=r.notify("node_action",{type:"prompt-rename",callback:function(e){t(r,e)}}))&&!0===e[0]||!r.getParent()||r.getParent().notify("child_node_action",{type:"prompt-rename",child:r,callback:function(e){t(r,e)}}))}},o.renameFunction=o.callback=void 0;var i=n(e("pydio")),a=n(e("pydio/http/api")),l=n(e("pydio/util/path"));function n(e){return e&&e.__esModule?e:{default:e}}function r(o,n){var r=i.default.getInstance();if(o=o||r.getUserSelection().getUniqueNode(),-1!==n.indexOf("/"))throw new Error(r.MessageHash["filename.forbidden.slash"]);var e={nodes:[e=r.user.getActiveRepositoryObject().getSlug()+o.getPath()],target:l.default.getDirname(e)+"/"+n,targetParent:!1};a.default.getRestClient().userJob("move",e).then(function(e){var t=r.MessageHash["rename.processing"].replace("%1",o.getLabel()).replace("%2",n);r.UI.displayMessage("SUCCESS",t),o.getMetadata().set("pending_operation",t),o.getMetadata().set("pending_operation_uuid",e.JobUuid),o.notify("meta_replaced",o),r.getContextHolder().setSelectedNodes([])}).catch(function(e){e=e.Detail||e.message||e;r.UI.displayMessage("ERROR",e)})}o.callback=r;o.renameFunction=function(){var e,t=i.default.getInstance().getUserSelection().getSelectedNodes()[0];t&&((e=t.notify("node_action",{type:"prompt-rename",callback:function(e){r(t,e)}}))&&!0===e[0]||!t.getParent()||t.getParent().notify("child_node_action",{type:"prompt-rename",child:t,callback:function(e){r(t,e)}}))}},{pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/path":"pydio/util/path"}],18:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(r){return function(){var t=r.getContextHolder().getSelectedNodes(),o=r.user.getActiveRepositoryObject().getSlug(),e=new a.RestRestoreNodesRequest,n=new a.TreeServiceApi(i.default.getRestClient());e.Nodes=t.map(function(e){var t=new a.TreeNode;return t.Path=o+e.getPath(),t}),n.restoreNodes(e).then(function(e){e.RestoreJobs&&e.RestoreJobs.length&&t.forEach(function(t){e.RestoreJobs.forEach(function(e){e.NodeUuid===t.getMetadata().get("uuid")&&(t.getMetadata().set("pending_operation",e.Label),t.getMetadata().set("pending_operation_uuid",e.Uuid),t.notify("meta_replaced",t))})}),r.getContextHolder().setSelectedNodes([])})}};var n,i=(n=e("pydio/http/api"))&&n.__esModule?n:{default:n},a=e("cells-sdk");t.exports=o.default},{"cells-sdk":"cells-sdk","pydio/http/api":"pydio/http/api"}],19:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(n){return function(e,t){var o={};t&&t.length&&(o={uploaderProps:t[0]}),n.UI.openComponentInModal("FSActions","UploadDialog",o)}},t.exports=o.default},{}],20:[function(l,e,t){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=c(l("create-react-class")),i=c(l("pydio/model/meta-node-provider")),a=c(l("pydio/http/api")),s=l("cells-sdk"),d=c(l("pydio/model/cell")),n=l("material-ui/styles"),u=c(l("prop-types"));function c(e){return e&&e.__esModule?e:{default:e}}function p(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(o){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(o);return e=n?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=l("react"),m=l("material-ui"),v=m.FontIcon,b=m.ListItem,_=m.List,C=m.FlatButton,x=m.Subheader,w=l("pydio"),M=l("pydio/model/data-model"),m=w.requireLib("boot").ActionDialogMixin,P=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(r,h.Component);var e,t,o,n=g(r);function r(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=n.call(this,e)).state={roots:[]},e}return e=r,(t=[{key:"componentDidMount",value:function(){var n=this,e=this.props.cellWs,t=new s.MetaServiceApi(a.default.getRestClient()),o=new s.RestGetBulkMetaRequest,r=e.getSlug();console.log(r),o.NodePaths=[r,r+"/*"],t.getBulkMeta(o).then(function(e){var e=e.Nodes||[],t=null,o=[];e.forEach(function(e){e.Path===r+"/"?t=i.default.parseTreeNode(e,r):(e=i.default.parseTreeNode(e,r)).isLeaf()||o.push(e)}),t.getMetadata().has("virtual_root")?(console.log(o),n.setState({roots:o})):(console.log(t),n.setState({roots:[t]}))})}},{key:"move",value:function(e){var t=this.props,o=t.source,n=t.cellWs,r=t.pydio,i=t.dropEffect,a=l("../callback/applyCopyOrMove")(w.getInstance()),t=r.getContextHolder();-1===t.getSelectedNodes().indexOf(o)?((r=new M).setContextNode(t.getContextNode()),r.setSelectedNodes([o]),a(i,r,e.getPath(),n.getId())):a(i,t,e.getPath(),n.getId()),this.props.onDismiss()}},{key:"share",value:function(){var e=this,t=this.props,o=t.source,n=t.cellWs,r=t.pydio,i=new d.default;i.load(n.getId()).then(function(){i.addRootNode(o),i.save().then(function(){e.props.onDismiss(),r.triggerRepositoryChange(n.getId())})})}},{key:"render",value:function(){function o(e){return a.MessageHash["openother.drop.cell."+e]||e}var n=this,e=this.props,t=e.source,r=e.cellWs,i=e.dropEffect,a=e.pydio,l=e.muiTheme,s=this.state.roots,d=[];d.push(h.createElement(b,{onClick:function(){n.share()},primaryText:t.isLeaf()?o("file.share"):o("folder.share"),secondaryText:o("share.legend").replace("%s",r.getLabel()),leftIcon:h.createElement(v,{style:{color:l.palette.primary1Color},className:"mdi mdi-share-variant"})}));var e=t.isLeaf()?"file":"folder",u=o(e+"."+i);return s.forEach(function(e){var t=o("copymove.legend").replace("%s",r.getLabel());"/"!==e.getPath()&&""!==e.getPath()&&(t+="/"+e.getLabel()),d.push(h.createElement(b,{onClick:function(){n.move(e)},primaryText:u,secondaryText:t,leftIcon:h.createElement(v,{style:{color:l.palette.primary1Color},className:"mdi mdi-folder-"+("copy"===i?"plus":"move")})}))}),h.createElement(_,{style:{maxHeight:320,overflowY:"scroll",width:"100%",borderTop:"1px solid #e0e0e0"}},h.createElement(x,{style:{overflow:"hidden",whiteSpace:"nowrap",paddingRight:16,textOverflow:"ellipsis"}},o("picker").replace("%s",t.getLabel())),d)}}])&&p(e.prototype,t),o&&p(e,o),r}(),P=(0,n.muiThemeable)()(P),m=(0,o.default)({displayName:"CrossWsDropDialog",propTypes:{pydio:u.default.instanceOf(w),selection:u.default.instanceOf(M)},mixins:[m],getButtons:function(e){var t=[],o=this.props.pydio.MessageHash;return t.push(h.createElement(C,{label:o[49],primary:!0,keyboardFocused:!0,onClick:this.props.onDismiss})),t},getDefaultProps:function(){return{dialogIsModal:!1,dialogSize:"sm",dialogPadding:0}},render:function(){return h.createElement(P,this.props)}});t.default=m,e.exports=t.default},{"../callback/applyCopyOrMove":2,"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/model/cell":"pydio/model/cell","pydio/model/data-model":"pydio/model/data-model","pydio/model/meta-node-provider":"pydio/model/meta-node-provider",react:"react"}],21:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var l=i(e("../callback/openInEditor")),n=i(e("create-react-class")),r=i(e("prop-types"));function i(e){return e&&e.__esModule?e:{default:e}}var a=e("react"),s=e("material-ui"),d=s.FontIcon,u=s.ListItem,c=s.List,p=s.FlatButton,f=e("pydio"),s=e("pydio/model/data-model"),g=e("pydio/util/lang"),e=f.requireLib("boot").ActionDialogMixin,e=(0,n.default)({displayName:"OtherEditorPickerDialog",propTypes:{pydio:r.default.instanceOf(f),selection:r.default.instanceOf(s)},mixins:[e],getButtons:function(e){var t=[],o=this.props.pydio.MessageHash;return t.push(a.createElement(p,{key:"clear",label:MessageHash["openother.5"],primary:!1,onClick:this.clearAssociations})),t.push(a.createElement(p,{label:o[49],primary:!0,keyboardFocused:!0,onClick:this.props.onDismiss})),t},getDefaultProps:function(){return{dialogTitleId:"openother.2",dialogIsModal:!1,dialogSize:"sm",dialogPadding:0}},findActiveEditors:function(e){var t=[],o=!1,n=this.props.pydio;return null==this.user||this.user.canWrite()||(o=!0),n.Registry.getActiveExtensionByType("editor").forEach(function(e){o&&e.write||e.openable&&t.push(e)}),t},clearAssociations:function(){var e,t,o,n,r=this.props.selection.getUniqueNode().getAjxpMime();try{t=(e=this.props.pydio.user.getPreference("gui_preferences",!0)).other_editor_extensions}catch(e){}t&&t[r]&&(o=t[r],this.props.pydio.Registry.getActiveExtensionByType("editor").forEach(function(e){e.editorClass===o&&(n=e)}),n&&-1!==n.mimes.indexOf(r)&&(n.mimes=g.arrayWithout(n.mimes,n.mimes.indexOf(r))),delete t[r],e.other_editor_extensions=t,this.props.pydio.user.setPreference("gui_preferences",e,!0),this.props.pydio.user.savePreference("gui_preferences")),this.props.onDismiss()},selectEditor:function(e,t){var o=this.props,n=o.pydio,r=o.selection.getUniqueNode().getAjxpMime();e.mimes.push(r);var i,a=n.user;a&&((o=(i=a.getPreference("gui_preferences",!0)||{}).other_editor_extensions||{})[r]=e.editorClass,i.other_editor_extensions=o,a.setPreference("gui_preferences",i,!0),a.savePreference("gui_preferences"),(0,l.default)(n)(null,[e]),this.dismiss())},render:function(){var o=this,e=this.findActiveEditors("*").map(function(e){var t=a.createElement(d,{className:e.icon_class});return a.createElement(u,{onClick:o.selectEditor.bind(o,e),primaryText:e.text,secondaryText:e.title,leftIcon:t})});return a.createElement(c,{style:{maxHeight:320,overflowY:"scroll",width:"100%",borderTop:"1px solid #e0e0e0"}},e)}});o.default=e,t.exports=o.default},{"../callback/openInEditor":15,"create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model","pydio/util/lang":"pydio/util/lang",react:"react"}],22:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=a(e("react")),n=a(e("pydio")),r=a(e("prop-types")),i=a(e("create-react-class")),d=a(e("pydio/util/lang")),u=e("cells-sdk"),c=a(e("pydio/model/data-model")),p=e("material-ui");function a(e){return e&&e.__esModule?e:{default:e}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var n,r,i=[],a=!0,l=!1;try{for(o=o.call(e);!(a=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){l=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(l)throw r}}return i}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return y(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(o="Object"===o&&e.constructor?e.constructor.name:o)||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var e=n.default.requireLib("hoc"),h=e.ModernTextField,m=e.ModernSelectField,v=n.default.requireLib("components").FoldersTree,b=(0,i.default)({displayName:"TreeDialog",propTypes:{isMove:r.default.bool.isRequired,submitValue:r.default.func.isRequired},mixins:[PydioReactUI.ActionDialogMixin,PydioReactUI.CancelButtonProviderMixin,PydioReactUI.SubmitButtonProviderMixin],getDefaultProps:function(){return{dialogTitle:"Copy/Move",dialogIsModal:!0,dialogScrollBody:!0}},submit:function(){var e=this.props,t=e.pydio,o=e.submitValue,n=this.state,e=n.dataModel,n=n.wsId,e=e.getContextNode().getPath();o(e,"__CURRENT__"===n?null:n);var r=("__CURRENT__"===n?t.user.activeRepository:n)+":"+e;b.RecentPlaces=b.RecentPlaces.filter(function(e){return e!==r}),b.RecentPlaces.unshift(r),b.RecentPlaces=b.RecentPlaces.slice(0,5),this.dismiss()},getInitialState:function(){var e=this.getCurrentDataModel();return{dataModel:e,wsId:e.getRootNode().getMetadata().get("repository_id")||"__CURRENT__"}},handleRepositoryChange:function(e,t,o){var n=this,r=this.getCurrentDataModel(o),i=r.getRootNode();i.observeOnce("loaded",function(){n.forceUpdate()}),i.load(),this.setState({dataModel:r,wsId:o})},getCurrentDataModel:function(){var e,t,o=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,r=this.props.pydio,i=r.user,a=i.getRepositoriesList().get(i.activeRepository).getLabel();null!==n&&"__CURRENT__"!==n?(e=n,a=i.getCrossRepositories().get(n).getLabel()):null===n&&(!i.canWrite()&&i.canCrossRepositoryCopy()&&i.hasCrossRepositories()&&(e=i.getCrossRepositories().keys().next().value,a=i.getCrossRepositories().get(e).getLabel()),r.getContextHolder().getContextNode().isRoot()||(t=r.getContextHolder().getContextNode().getPath()));var l=c.default.RemoteDataModelFactory(e?{tmp_repository_id:e}:{},a),s=l.getRootNode();return e&&s.getMetadata().set("repository_id",e),t?(r.getContextHolder().getRootNode().getChildren().forEach(function(e){s.addChild(e)}),l.loadPathInfoAsync(t,function(e){l.requireContextChange(e)}.bind(this))):(s.observeOnce("loaded",function(){o.forceUpdate()}),s.load(l.getAjxpNodeProvider())),l.observe("context_changed",function(){o.forceUpdate()}),l},onNodeSelected:function(e){var t=this.state.dataModel;t.setContextNode(e),e.load(t.getAjxpNodeProvider())},createNewFolder:function(){var t=this,e=this.props.pydio,o=this.state,n=o.dataModel,r=o.newFolderInput,i=n.getContextNode(),a=e.user.getActiveRepositoryObject().getSlug();"__CURRENT__"!==this.state.wsId&&(a=e.user.getRepositoriesList().get(this.state.wsId).getSlug());var l=new u.TreeServiceApi(PydioApi.getRestClient()),o=new u.RestCreateNodesRequest,e=a+d.default.trimRight(i.getPath(),"/")+"/"+r,a=new u.TreeNode;a.Path=e,a.Type=u.TreeNodeType.constructFromObject("COLLECTION"),o.Nodes=[a],l.createNodes(o).then(function(e){i.observeOnce("loaded",function(){var e=("/"===i.getPath()?"":i.getPath())+"/"+r,e=i.getChildren().get(e);e&&n.setContextNode(e)}),setTimeout(function(){return i.reload(n.getAjxpNodeProvider())},1e3),t.setState({newFolderFormOpen:!1,newFolderInput:""})})},toggleNewFolderForm:function(){var e=this,t=!this.state.newFolderFormOpen;this.setState({newFolderFormOpen:t},function(){t&&e.refs.newfolder_input.focus()})},buildWsSelector:function(){var e,o,t,n=this.props.pydio,r=n.user,i=this.state.wsId,a=s.default.createElement("div",{style:{height:30}});return r&&r.canCrossRepositoryCopy()&&r.hasCrossRepositories()&&(e=[],o=[],r.canWrite()&&(t=r.getActiveRepositoryObject(),e.push(s.default.createElement(p.MenuItem,{key:"current",value:"__CURRENT__",primaryText:t.getLabel()+" - "+n.MessageHash[372],leftIcon:s.default.createElement(p.FontIcon,{style:{fontSize:20,height:20,top:t.getOwner()?5:1},className:t.getOwner()?"icomoon-cells":"mdi mdi-folder"})})),e.push(s.default.createElement(p.Divider,null))),r.getCrossRepositories().forEach(function(e,t){o.push({label:e.getLabel(),owner:!!e.getOwner(),item:s.default.createElement(p.MenuItem,{key:t,value:t,primaryText:e.getLabel(),leftIcon:s.default.createElement(p.FontIcon,{style:{fontSize:20,height:20,top:e.getOwner()?5:1},className:e.getOwner()?"icomoon-cells":"mdi mdi-folder"})})})}),o.sort(function(e,t){return e.owner===t.owner?e.label.localeCompare(t.label,void 0,{numeric:!0}):e.owner?1:-1}),e=[].concat(l(e),l(o.map(function(e){return e.item}))),a=s.default.createElement("div",null,s.default.createElement(m,{fullWidth:!0,variant:"v2",floatingLabelText:n.MessageHash[455],value:i,onChange:this.handleRepositoryChange.bind(this)},e))),a},buildRecentLocations:function(){var i=this,e=this.props.pydio,a=e.user;if(!b.RecentPlaces||!b.RecentPlaces.length)return t;var t,l=this.props.submitValue;return t=s.default.createElement("div",{style:{borderBottom:"1px solid #e0e0e0",padding:"3px 7px 1px",backgroundColor:"#F6F6F8"}},s.default.createElement("div",{style:{color:"rgba(0,0,0,.3)",fontSize:12}},e.MessageHash["action.copymove.recent"]),s.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",paddingTop:2}},b.RecentPlaces.map(function(e){var t,o=f(e.split(":"),2),n=o[0],r=o[1],e=r;return a&&a.getRepositoriesList().has(n)&&(o=a.getRepositoriesList().get(n),t=s.default.createElement(p.Avatar,{style:{fontSize:12,height:24,width:24,fontWeight:500}},o.getLettersBadge()),e=o.getLabel()+r),s.default.createElement(p.Chip,{style:{margin:"0 3px 4px 0"},labelStyle:{lineHeight:"24px"},title:e,onClick:function(){l(r,n),i.dismiss()}},t,r)})))},render:function(){var o=this,t=this.props.pydio,e=this.state,n=e.newFolderFormOpen,r=e.dataModel,i=e.newFolderInput,a=this.buildWsSelector(),e=this.buildRecentLocations();return s.default.createElement("div",{style:{width:"100%"}},e,a,s.default.createElement(p.Paper,{zDepth:0,style:{height:300,overflowX:"auto",color:"#546E7A",fontSize:14,padding:"6px 0px",backgroundColor:"rgb(246, 246, 248)",marginTop:4,borderBottom:"1px solid #e0e0e0",borderRadius:"2px 2px 0 0"}},s.default.createElement("div",{style:{marginTop:-6,marginLeft:-5}},s.default.createElement(v,{pydio:t,dataModel:r,onNodeSelected:this.onNodeSelected.bind(this),showRoot:!0,draggable:!1,rootLabel:t.MessageHash["action.copymove.root"],getItemStyle:function(e){return r.getContextNode()===e?{fontWeight:500,backgroundColor:"#ebebef"}:{}},getRightIcon:function(e){return r.getContextNode()===e?s.default.createElement(p.IconButton,{iconClassName:"mdi mdi-folder-plus",style:{height:18,width:18,padding:0,marginRight:-15},iconStyle:{opacity:.5,fontSize:18},tooltip:t.MessageHash[154],tooltipPosition:"bottom-left",onClick:function(){return o.toggleNewFolderForm()}}):null}}))),s.default.createElement(p.Paper,{className:"bezier-transitions",zDepth:0,style:{position:"relative",height:n?60:0,overflow:n?"visible":"hidden",opacity:n?1:0,padding:0,marginTop:n?0:4}},s.default.createElement(h,{fullWidth:!0,floatingLabelText:t.MessageHash[173],ref:"newfolder_input",variant:"v2",value:i,onKeyDown:function(e){"Enter"===e.key&&i&&o.createNewFolder()},onChange:function(e,t){return o.setState({newFolderInput:t})}}),s.default.createElement("div",{style:{position:"absolute",bottom:-2,right:0}},s.default.createElement(p.IconButton,{iconClassName:"mdi mdi-check",iconStyle:{color:"#546E7A"},tooltip:this.props.pydio.MessageHash[48],onClick:function(){o.createNewFolder()}}),s.default.createElement(p.IconButton,{iconClassName:"mdi mdi-close",iconStyle:{color:"#546E7A"},tooltip:this.props.pydio.MessageHash[49],onClick:function(){return o.toggleNewFolderForm()}}))))}});(o.default=b).RecentPlaces=[],t.exports=o.default},{"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model","pydio/util/lang":"pydio/util/lang",react:"react"}],23:[function(e,t,o){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var l=d(e("react")),n=d(e("pydio")),i=d(e("create-react-class")),s=e("material-ui"),a=e("material-ui/styles");function d(e){return e&&e.__esModule?e:{default:e}}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o,n=arguments[t];for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function c(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(o){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(o);return e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==r(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=n.default.requireLib("boot"),e=y.ActionDialogMixin,h=y.AsyncComponent,m=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(r,l["default"].Component);var e,t,o,n=f(r);function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),n.apply(this,arguments)}return e=r,(t=[{key:"render",value:function(){var e=this.props,t=e.tabs,o=e.dismiss,e=e.muiTheme;return l.default.createElement("div",{style:{display:"flex",backgroundColor:e.tabs.backgroundColor}},l.default.createElement(s.Tabs,{style:{flex:1}},t),l.default.createElement(s.IconButton,{iconStyle:{color:e.tabs.selectedTextColor},iconClassName:"mdi mdi-close",onClick:o,tooltip:"Close"}))}}])&&c(e.prototype,t),o&&c(e,o),r}(),m=(0,a.muiThemeable)()(m),e=(0,i.default)({displayName:"UploadDialog",mixins:[e],getDefaultProps:function(){return{dialogTitle:"",dialogSize:n.default.getInstance().UI.MOBILE_EXTENSIONS?"md":"lg",dialogPadding:!1,dialogIsModal:!1}},getInitialState:function(){var e,t=this.props.pydio.Registry.getActiveExtensionByType("uploader").filter(function(e){return e.moduleName});return t.sort(function(e,t){return e.order-t.order}),{uploaders:t,current:e=t.length?t[0]:e,loaded:!1}},render:function(){function e(){t.dismiss()}var t=this,o=[],n=l.default.createElement("div",{style:{height:360}}),r=this.state,i=r.uploaders,a=r.current,r=r.loaded;return i.map(function(e){o.push(l.default.createElement(s.Tab,{label:e.xmlNode.getAttribute("label"),key:e.id,onActive:function(){t.setState({current:e})}}))}),a&&(a=a.moduleName.split("."),n=l.default.createElement(h,u({pydio:this.props.pydio,namespace:a[0],componentName:a[1],onDismiss:e,showDismiss:1===o.length,onLoad:function(){t.setState({loaded:!0})}},this.props.uploaderProps))),l.default.createElement("div",{style:{width:"100%"}},1<o.length&&l.default.createElement(m,{tabs:o,dismiss:e}),n,!r&&l.default.createElement("div",{style:{padding:"100px 40px",textAlign:"center",color:"rgba(0,0,0,.5)"}},this.props.pydio.MessageHash[466]))}});o.default=e,t.exports=o.default},{"create-react-class":"create-react-class","material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio",react:"react"}],24:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),Object.defineProperty(o,"OtherEditorPickerDialog",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(o,"TreeDialog",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(o,"UploadDialog",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(o,"CrossWsDropDialog",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(o,"Callbacks",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(o,"Listeners",{enumerable:!0,get:function(){return s.default}});var n=d(e("./dialog/OtherEditorPickerDialog")),r=d(e("./dialog/TreeDialog")),i=d(e("./dialog/UploadDialog")),a=d(e("./dialog/CrossWsDropDialog")),l=d(e("./callback/index")),s=d(e("./listener/index"));function d(e){return e&&e.__esModule?e:{default:e}}},{"./callback/index":10,"./dialog/CrossWsDropDialog":20,"./dialog/OtherEditorPickerDialog":21,"./dialog/TreeDialog":22,"./dialog/UploadDialog":23,"./listener/index":29}],25:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return function(){var e=t.getUserSelection();t.Parameters.get("zipEnabled")&&t.Parameters.get("multipleFilesDownloadEnabled")||(e.isUnique()?this.selectionContext.multipleOnly=!0:this.selectionContext.unique=!0)}},t.exports=o.default},{}],26:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return function(){this.rightsContext.write=!0;var e=t.user;e&&e.canRead()&&e.canCrossRepositoryCopy()&&e.hasCrossRepositories()&&(this.rightsContext.write=!1,e.canWrite()||(t.getController().defaultActions.delete("ctrldragndrop"),t.getController().defaultActions.delete("dragndrop"))),e&&e.canWrite()&&t.getContextNode().hasAjxpMimeInBranch("ajxp_browsable_archive")&&(this.rightsContext.write=!1),t.getContextNode().hasAjxpMimeInBranch("ajxp_browsable_archive")?this.setLabel(247,248):this.setLabel(66,159)}},t.exports=o.default},{}],27:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return function(){e.Parameters.get("zipEnabled")&&e.Parameters.get("multipleFilesDownloadEnabled")||(this.hide(),e.Controller.actions.delete("download_all"))}},t.exports=o.default},{}],28:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return function(){var e=t.getUserSelection();t.Parameters.get("zipEnabled")&&t.Parameters.get("multipleFilesDownloadEnabled")||e.hasDir()&&(this.selectionContext.dir=!1)}},t.exports=o.default},{}],29:[function(o,n,r){!function(t){!function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=t.pydio,e={mkfileDynamicBuilder:o("./mkfileDynamicBuilder")(e),downloadSelectionChange:o("./downloadSelectionChange")(e),downloadAllInit:o("./downloadAllInit")(e),compressUiSelectionChange:o("./compressUiSelectionChange")(e),copyContextChange:o("./copyContextChange")(e),openWithDynamicBuilder:o("./openWithDynamicBuilder")(e),lockSelectionChange:o("./lockSelectionChange")(e),deleteTemplateByUuid:function(){}};r.default=e,n.exports=r.default}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./compressUiSelectionChange":25,"./copyContextChange":26,"./downloadAllInit":27,"./downloadSelectionChange":28,"./lockSelectionChange":30,"./mkfileDynamicBuilder":31,"./openWithDynamicBuilder":32}],30:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(o){return function(){var e=o.getController().getActionByName("sl_lock"),t=o.getUserSelection().getUniqueNode();e&&t&&(e.selectionContext.allowedMimes=[],t.getMetadata().get("sl_locked")?(e.setIconClassName("mdi mdi-lock-outline"),e.setLabel("meta.simple_lock.3"),t.getMetadata().get("sl_mylock")||(e.selectionContext.allowedMimes=["fake_extension_that_never_exists"])):(e.setIconClassName("mdi mdi-lock-outline"),e.setLabel("meta.simple_lock.1")))}},t.exports=o.default},{}],31:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e){return d.dynamicBuilder};var i,a,l,s=n(e("pydio")),u=n(e("pydio/util/path")),c=e("cells-sdk"),p=n(e("./index"));function n(e){return e&&e.__esModule?e:{default:e}}function f(e,t,o,n,r,i,a){try{var l=e[i](a),s=l.value}catch(e){return void o(e)}l.done?t(s):Promise.resolve(s).then(n,r)}function r(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}s.default.getInstance().observe("reload_node_templates",function(){console.log("reload_node_templates"),l=i=null,clearTimeout(a),s.default.getInstance().getController().fireContextChange()});var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,o,n;return t=e,n=[{key:"dynamicBuilder",value:function(){var n=this,d=s.default.getInstance();if(l=null!==i?i:l){var r={doc:"file-word",docx:"file-word",odt:"file-word",odg:"file-chart",odp:"file-powerpoint",ods:"file-excel",pot:"file-powerpoint",pptx:"file-powerpoint",rtf:"file-word",xls:"file-excel",xlsx:"file-excel"};return l.map(function(a){var l=a.UUID&&u.default.getFileExtension(a.UUID)?u.default.getFileExtension(a.UUID):u.default.getFileExtension(a.Label)?u.default.getFileExtension(a.Label):"txt",e="file";r[l]&&(e=r[l]);var s,t,o=a.Label;return{name:o=a.Editable?React.createElement("div",{style:{display:"flex"}},React.createElement("span",{style:{flex:1}},a.Label),React.createElement("span",{onClick:function(e){e.stopPropagation(),p.default.deleteTemplateByUuid(a.UUID)},className:"mdi mdi-delete",style:{opacity:.3}})):o,alt:a.Label,icon_class:"mdi mdi-"+e,callback:(s=regeneratorRuntime.mark(function e(t){var o,r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=d.user.getRepositoriesList(),n=d.getContextHolder().getContextNode(),o=i.get(d.user.activeRepository).getSlug(),i=d.MessageHash["mkfile.untitled.document"]||"Untitled",i=(i=o+n.getPath()+"/"+i+"."+l).replace("//","/"),r=u.default.getDirname(i),n=function(e,t){function o(t){var o=!1;return n.forEach(function(e){e.getLabel()===t&&(o=!0)}),o}var n=e.getChildren(),e=t.lastIndexOf("."),r=t.substring(0,e),i=t.substring(e),a=t,l=1,s=o(a);for(;s;)a=r+"-"+l+i,l++,s=o(a);return a}(n,u.default.getBasename(i)),i=function(e){if(-1!==e.indexOf("/")){var t=d.MessageHash["filename.forbidden.slash"];throw d.UI.displayMessage("ERROR",t),new Error(t)}var o=new c.TreeServiceApi(PydioApi.getRestClient()),n=new c.RestCreateNodesRequest,t=new c.TreeNode;t.Path=r+"/"+e,t.Type=c.TreeNodeType.constructFromObject("LEAF"),n.Nodes=[t],n.TemplateUUID=a.UUID,o.createNodes(n).then(function(e){})},d.UI.openComponentInModal("PydioReactUI","PromptDialog",{dialogTitleId:156,legendId:a.Label,fieldLabelId:174,dialogSize:"sm",defaultValue:n,defaultInputSelection:!0,submitValue:i});case 10:case"end":return e.stop()}},e)}),t=function(){var e=this,a=arguments;return new Promise(function(t,o){var n=s.apply(e,a);function r(e){f(n,t,o,r,i,"next",e)}function i(e){f(n,t,o,r,i,"throw",e)}r(void 0)})},function(e){return t.apply(this,arguments)}.bind(n))}})}return a&&clearTimeout(a),new c.TemplatesServiceApi(PydioApi.getRestClient()).listTemplates().then(function(e){l=e.Templates;var t=new c.RestTemplate;t.Label=d.MessageHash["mkfile.empty.template.label"]||"Empty File",t.UUID="",l.unshift(t),l.sort(function(e,t){return e.Editable?-1:t.Editable?1:e<=t}),i=e.Templates,a=setTimeout(function(){i=null},2e3),s.default.getInstance().getController().fireContextChange()}),[]}}],(o=null)&&r(t.prototype,o),n&&r(t,n),e}();t.exports=o.default},{"./index":29,"cells-sdk":"cells-sdk",pydio:"pydio","pydio/util/path":"pydio/util/path"}],32:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(l){var s=e("../callback/openOtherEditorPicker")(l),d=l.MessageHash;return function(){var e=[];if(l.getUserSelection().isEmpty())return e;var n,t=l.getUserSelection().getUniqueNode(),o=u.getAjxpMimeType(t),r="true"===t.getMetadata().get("node_readonly"),t=l.user;t&&t.getPreference("gui_preferences",!0)&&t.getPreference("gui_preferences",!0).other_editor_extensions&&(n=t.getPreference("gui_preferences",!0).other_editor_extensions,Object.keys(n).forEach(function(t){var o;l.Registry.getActiveExtensionByType("editor").forEach(function(e){e.editorClass===n[t]&&(o=e)}),o&&-1===o.mimes.indexOf(t)&&o.mimes.push(t)}.bind(this)));var o=l.Registry.findEditorsForMime(o),i=0,a=!1;return o.length&&(o.forEach(function(t){t.openable&&(t.write&&r||(-1<t.mimes.indexOf("*")&&(!a&&0<i&&e.push({separator:!0}),a=!0),e.push({name:t.text,alt:t.title,isDefault:0===i,icon_class:t.icon_class,callback:function(e){this.apply([t])}.bind(this)}),i++))}.bind(this)),e.push({name:d["openother.1"],alt:d["openother.2"],isDefault:0===i,icon_class:"icon-list-alt",callback:s})),i||e.push({name:d[324],alt:d[324],callback:function(e){}}),e}};var u=e("pydio/util/path");t.exports=o.default},{"../callback/openOtherEditorPicker":16,"pydio/util/path":"pydio/util/path"}]},{},[24])(24)});