!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).UserAccount=e()}(function(){return function n(o,a,i){function s(t,e){if(!a[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=a[t]={exports:{}},o[t][0].call(r.exports,function(e){return s(o[t][1][e]||e)},r,r.exports,n,o,a,i)}return a[t].exports}for(var u="function"==typeof require&&require,e=0;e<i.length;e++)s(i[e]);return s}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return{openDashboard:function(){n.loadClassesAndApply(["PydioForm"],function(){e.UI.openComponentInModal("UserAccount","ModalDashboard")})},openAddressBook:function(){n.loadClassesAndApply(["PydioForm","PydioComponents"],function(){e.UI.openComponentInModal("UserAccount","ModalAddressBook")})}}};var n=e("pydio/http/resources-manager");t.exports=r.default},{"pydio/http/resources-manager":"pydio/http/resources-manager"}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("pydio/util/xml");r.default={getAccountTabs:function(e){return n.XPathSelectNodes(e.getXmlRegistry(),'client_configs/component_config[@component="UserAccountTabs"]/additional_tab').map(function(e){return{id:e.getAttribute("id"),tabInfo:JSON.parse(e.getAttribute("tabInfo")),paneInfo:JSON.parse(e.getAttribute("paneInfo"))}})}},t.exports=r.default},{"pydio/util/xml":"pydio/util/xml"}],3:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("prop-types"))&&n.__esModule?n:{default:n};function a(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function i(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(r),t=(e=n?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=e("react").Component,e=e("material-ui"),m=e.Toggle,b=e.Subheader,h=e.MenuItem,g=e.SelectField,v=e.TextField,O=e.TimePicker,e=function(){var e=o,t=f;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t);var r,n=c(o);function o(){var e=this,t=o;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"onChange",value:function(e){var t=this.props,r=t.values;(0,t.onChange)(i(i({},r),e),!0)}},{key:"onFrequencyChange",value:function(e){var t,r={NOTIFICATIONS_EMAIL_FREQUENCY:e};switch(e){case"M":t="5";break;case"H":t="2";break;case"D1":t="03";break;case"D2":t="09,14";break;case"W1":t="Monday"}r.NOTIFICATIONS_EMAIL_FREQUENCY_USER=t,this.onChange(r)}},{key:"onPickDate",value:function(e,t,r){var n=this.props.values.NOTIFICATIONS_EMAIL_FREQUENCY_USER.split(","),o=[];"first"===e&&(o=[r.getHours(),n[1]||"00"]),"last"===e&&(o=[n[0]||"00",r.getHours()]),this.onChange({NOTIFICATIONS_EMAIL_FREQUENCY_USER:o.join(",")})}},{key:"render",value:function(){function e(e){return i.MessageHash["user_dash."+e]}var t,n=this,r=this.props,o=r.definitions,a=r.values,i=r.pydio,r=a.NOTIFICATIONS_EMAIL_GET,s=a.NOTIFICATIONS_EMAIL_FREQUENCY,u=a.NOTIFICATIONS_EMAIL_FREQUENCY_USER,a=(a.NOTIFICATIONS_EMAIL,a.NOTIFICATIONS_EMAIL_SEND_HTML),l="true"===r,c=new Map,p=[];if(o[1].choices.split(",").map(function(e){e=e.split("|");c.set(e[0],e[1]),p.push(React.createElement(h,{primaryText:e[1],value:e[0]}))}),l)switch(s){case"M":case"H":t=React.createElement(v,{fullWidth:!0,floatingLabelText:e("M"===s?62:63),value:u,onChange:function(e,t){n.onChange({NOTIFICATIONS_EMAIL_FREQUENCY_USER:t})}});break;case"D1":var f=new Date;f.setHours(u),f.setMinutes(0),t=React.createElement(O,{format:"ampm",hintText:e(64),value:f,onChange:function(e,t){n.onChange({NOTIFICATIONS_EMAIL_FREQUENCY_USER:t.getHours()})},autoOk:!0,textFieldStyle:{width:"100%"}});break;case"D2":var f=u+"",d=(f=(f=f||"09,14").split(","),new Date),y=new Date;y.setMinutes(0),d.setHours(f[0]),d.setMinutes(0),f[1]&&y.setHours(f[1]),t=React.createElement("div",{style:{display:"flex"}},React.createElement(O,{format:"ampm",hintText:e(65),value:d,onChange:this.onPickDate.bind(this,"first"),textFieldStyle:{width:100,marginRight:5}}),React.createElement(O,{format:"ampm",hintText:e(66),value:y,onChange:this.onPickDate.bind(this,"last"),textFieldStyle:{width:100,marginLeft:5}}));break;case"W1":t=React.createElement(g,{floatingLabelText:e(67),fullWidth:!0,value:u,onChange:function(e,t,r){n.onChange({NOTIFICATIONS_EMAIL_FREQUENCY_USER:r})}},React.createElement(h,{primaryText:e(68),value:"Monday"}),React.createElement(h,{primaryText:e(69),value:"Tuesday"}),React.createElement(h,{primaryText:e(70),value:"Wednesday"}),React.createElement(h,{primaryText:e(71),value:"Thursday"}),React.createElement(h,{primaryText:e(72),value:"Friday"}),React.createElement(h,{primaryText:e(73),value:"Saturday"}),React.createElement(h,{primaryText:e(74),value:"Sunday"}))}return React.createElement("div",null,React.createElement(b,{style:{paddingLeft:20}},e(61)),React.createElement("div",{style:{padding:"0 20px 20px"}},React.createElement(m,{label:o[0].label,toggled:"true"===r,onToggle:function(e,t){n.onChange({NOTIFICATIONS_EMAIL_GET:t?"true":"false"})}}),l&&React.createElement("div",{style:{paddingBottom:16}},React.createElement("div",{style:{padding:"16px 0"}},React.createElement(m,{label:o[4].label,toggled:"true"===a,onToggle:function(e,t){n.onChange({NOTIFICATIONS_EMAIL_SEND_HTML:t?"true":"false"})}})),React.createElement(g,{fullWidth:!0,floatingLabelText:o[1].label,value:s,onChange:function(e,t,r){n.onFrequencyChange(r)}},p),t)))}}])&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}();(r.default=e).propTypes={definitions:n.default.object,values:n.default.object,onChange:n.default.func},t.exports=r.default},{"material-ui":"material-ui","prop-types":"prop-types",react:"react"}],4:[function(e,t,r){"use strict";function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=e("react"),a=e("create-react-class"),e=e("pydio"),i=e.requireLib("boot").ActionDialogMixin,e=e.requireLib("components"),s=e.ModalAppBar,u=e.AddressBook,e=a({displayName:"ModalAddressBook",mixins:[i],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"xl",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!0}},submit:function(){this.dismiss()},render:function(){var e=this;return o.createElement("div",{style:{width:"100%",display:"flex",flexDirection:"column"}},o.createElement(s,{title:this.props.pydio.MessageHash["user_dash.1"],showMenuIconButton:!1,iconClassNameRight:"mdi mdi-close",onRightIconButtonClick:function(){e.dismiss()}}),o.createElement(u,n({mode:"book"},this.props,{style:{width:"100%",flexGrow:1,height:"auto"}})))}});r.default=e,t.exports=r.default},{"create-react-class":"create-react-class",pydio:"pydio",react:"react"}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./ProfilePane")),o=a(e("./ComponentConfigParser"));function a(e){return e&&e.__esModule?e:{default:e}}function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var s=e("react"),u=e("create-react-class"),l=e("pydio").requireLib("boot"),c=l.ActionDialogMixin,p=l.SubmitButtonProviderMixin,f=l.AsyncComponent,l=e("material-ui"),d=l.Tabs,y=l.Tab,m=l.FontIcon,b=l.FlatButton,e=u({displayName:"ModalDashboard",mixins:[c,p],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"md",dialogPadding:!1,dialogIsModal:!1,dialogScrollBody:!1}},submit:function(){this.dismiss()},getDefaultButtons:function(){return[s.createElement(b,{label:this.props.pydio.MessageHash[86],onClick:this.props.onDismiss})]},getButtons:function(e){return this._updater=e,this.refs.profile?this.refs.profile.getButtons(this._updater):this.getDefaultButtons()},onTabChange:function(e){this._updater&&(e&&this.refs[e]&&this.refs[e].getButtons?this._updater(this.refs[e].getButtons(this._updater)):this._updater(this.getDefaultButtons()))},render:function(){var t={textTransform:"none"},r=[s.createElement(y,{key:"account",label:this.props.pydio.MessageHash["user_dash.43"],icon:s.createElement(m,{className:"mdi mdi-account"}),buttonStyle:t,value:"profile"},s.createElement(n.default,i({},this.props,{ref:"profile"})))];return o.default.getAccountTabs(this.props.pydio).map(function(e){r.push(s.createElement(y,{key:e.id,label:this.props.pydio.MessageHash[e.tabInfo.label],icon:s.createElement(m,{className:e.tabInfo.icon}),buttonStyle:t,value:e.id},s.createElement(f,i({ref:e.id},this.props,e.paneInfo))))}.bind(this)),s.createElement(d,{style:{display:"flex",flexDirection:"column",width:"100%"},tabItemContainerStyle:{minHeight:72},contentContainerStyle:{overflowY:"auto",minHeight:350},onChange:this.onTabChange},r)}});r.default=e,t.exports=r.default},{"./ComponentConfigParser":2,"./ProfilePane":8,"create-react-class":"create-react-class","material-ui":"material-ui",pydio:"pydio",react:"react"}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("react")),o=a(e("pydio")),u=a(e("pydio/http/api")),l=e("cells-sdk");function a(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return d(t)}}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t,r){(t=m(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function m(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}var b=o.default.requireLib("form").ValidPassword,h=o.default.requireLib("hoc").ModernTextField,e=function(e){var t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var r,a=f(s);function s(){var i,e=this,t=s;if(!(e instanceof t))throw new TypeError("Cannot call a class as a function");for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return y(d(i=a.call.apply(a,[this].concat(n))),"state",{error:null,old:"",newPass:""}),y(d(i),"getMessage",function(e){return i.props.pydio.MessageHash[e]}),y(d(i),"update",function(e,t){var r={};r[t]=e,i.setState(r,function(){var e=i.validate();i.props.onValidStatusChange&&i.props.onValidStatusChange(e)})}),y(d(i),"validate",function(){var e,t;return!(!i.state.validStatus||(e=(t=i.state).oldPass,t=t.newPass,e&&t?t.length<parseInt(i.props.pydio.getPluginConfigs("core.auth").get("PASSWORD_MINLENGTH"))?(i.setState({error:i.getMessage(378)}),1):(i.setState({error:null}),0):(i.setState({error:i.getMessage(239)}),1)))}),y(d(i),"post",function(t){var e=i.state,r=e.oldPass,n=e.newPass,o=i.props.pydio,a="";o.user.lock&&(a=" "+i.getMessage(445)),o.user.getIdmUser().then(function(e){e=l.IdmUser.constructFromObject(JSON.parse(JSON.stringify(e)));e.OldPassword=r,e.Password=n,new l.UserServiceApi(u.default.getRestClient()).putUser(e.Login,e).then(function(){o.displayMessage("SUCCESS",i.getMessage(197)+a),t(!0),a&&o.getController().fireAction("logout")})})}),i}return t=s,(e=[{key:"render",value:function(){var e,t,r=this;return this.props.pydio.user?(e=this.props.pydio.MessageHash,this.state.error?t=n.default.createElement("div",{className:"error"},this.state.error):this.props.pydio.user.lock&&(t=n.default.createElement("div",null,e[444])),n.default.createElement("div",{style:this.props.style},t,n.default.createElement("div",null,n.default.createElement("form",{autoComplete:"off"},n.default.createElement(h,{onChange:function(e,t){r.update(t,"oldPass")},type:"password",value:this.state.oldPass,floatingLabelText:e[237],autoComplete:"off",variant:"v2",fullWidth:!0}))),n.default.createElement("div",null,n.default.createElement(b,{onChange:function(e,t){r.update(e,"newPass")},attributes:{name:"pass",label:e[198]},value:this.state.newPass,name:"newpassword",onValidStatusChange:function(e){return r.setState({validStatus:e})},variant:"v2"})))):null}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n.default.Component);r.default=e,t.exports=r.default},{"cells-sdk":"cells-sdk",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],7:[function(e,t,r){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=(n=e("./PasswordForm"))&&n.__esModule?n:{default:n};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){e=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===o(e)?e:String(e)}(n.key),n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=e("react"),n=e("material-ui"),p=n.FlatButton,f=(n.RaisedButton,n.Popover),d=n.Divider,n=(e("pydio"),function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var r,n=u(o);function o(e,t){if(this instanceof o)return(e=n.call(this,e,t)).state={passOpen:!1,passValid:!1,passAnchor:null},e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"passOpenPopover",value:function(e){this.setState({passOpen:!0,passAnchor:e.currentTarget})}},{key:"passClosePopover",value:function(){this.setState({passOpen:!1})}},{key:"passValidStatusChange",value:function(e){this.setState({passValid:e})}},{key:"passSubmit",value:function(){this.refs.passwordForm.post(function(e){e&&this.passClosePopover()}.bind(this))}},{key:"render",value:function(){var e=this.props.pydio,t=this.state,r=t.passOpen,n=t.passAnchor,t=t.passValid;return c.createElement("div",{style:{marginLeft:8}},c.createElement(p,{onClick:this.passOpenPopover.bind(this),label:e.MessageHash[194],secondary:!0}),c.createElement(f,{open:r,anchorEl:n,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"bottom"},onRequestClose:this.passClosePopover.bind(this),zDepth:4},c.createElement("div",null,c.createElement("div",{style:{padding:"15px 15px 0",fontSize:15}},e.MessageHash[194]),c.createElement(a.default,{style:{width:386,padding:10,backgroundColor:"#fafafa",paddingBottom:30},pydio:e,ref:"passwordForm",onValidStatusChange:this.passValidStatusChange.bind(this)}),c.createElement(d,null),c.createElement("div",{style:{textAlign:"right",padding:"8px 0"}},c.createElement(p,{label:e.MessageHash[49],onClick:this.passClosePopover.bind(this)}),c.createElement(p,{disabled:!t,label:"Ok",onClick:this.passSubmit.bind(this)})))))}}])&&i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(c.Component));r.default=n,t.exports=r.default},{"./PasswordForm":6,"material-ui":"material-ui",pydio:"pydio",react:"react"}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=o(e("react")),s=o(e("./PasswordPopover")),u=(o(e("./EmailPanel")),o(e("pydio/util/lang"))),l=e("material-ui"),n=o(e("pydio")),c=o(e("pydio/http/api")),p=e("cells-sdk");function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach(function(e){v(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,O(n.key),n)}}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,r){(t=O(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}function O(e){e=function(e,t){if("object"!==i(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"===i(e)?e:String(e)}var e=n.default.requireLib("form"),E=e.Manager,P=e.FormPanel,n=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e);var r,n=b(o);function o(e){var i;if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");v(h(i=n.call(this,e)),"onFormChange",function(e,t,r){var n=i.state.values;i.setState({dirty:t,values:e},function(){i._updater&&i._updater(i.getButtons()),!i.props.saveOnChange&&e.avatar===n.avatar||i.saveForm()})}),v(h(i),"getButtons",function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return t&&(i._updater=t),t=i.state.dirty?(e=a.default.createElement(l.FlatButton,{label:i.props.pydio.MessageHash[628],onClick:i.revert}),a.default.createElement(l.FlatButton,{label:i.props.pydio.MessageHash[53],secondary:!0,onClick:i.saveForm})):a.default.createElement(l.FlatButton,{label:i.props.pydio.MessageHash[86],onClick:i.props.onDismiss}),i.props.pydio.Controller.getActionByName("pass_change")?[a.default.createElement("div",{style:{display:"flex",width:"100%"}},a.default.createElement(s.default,i.props),a.default.createElement("span",{style:{flex:1}}),e,t)]:[t]}),v(h(i),"revert",function(){i.setState({values:d({},i.state.originalValues),dirty:!1},function(){i._updater&&i._updater(i.getButtons())})}),v(h(i),"saveForm",function(){var n,e,o,a;i.state.dirty?(n=i.props.pydio,e=i.state,o=e.definitions,a=e.values,n.user.getIdmUser().then(function(t){t.Attributes||(t.Attributes={}),o.forEach(function(e){a[e.name]?"user"===e.scope?t.Attributes[e.name]=a[e.name]:t.Attributes["parameter:"+e.pluginId+":"+e.name]=JSON.stringify(a[e.name]):delete t.Attributes[e.name]});var r=!1;return a.lang&&a.lang!==n.currentLanguage&&(n.user.setPreference("lang",a.lang),r=!0),new p.UserServiceApi(c.default.getRestClient()).putUser(t.Login,t).then(function(e){r&&n.observeOnce("registry_loaded",function(){i.setState({definitions:E.parseParameters(n.getXmlRegistry(),"user/preferences/pref[@exposed='true']|//param[contains(@scope,'user') and @expose='true' and not(contains(@name, 'NOTIFICATIONS_EMAIL'))]"),mailDefinitions:E.parseParameters(n.getXmlRegistry(),"user/preferences/pref[@exposed='true']|//param[contains(@scope,'user') and @expose='true' and contains(@name, 'NOTIFICATIONS_EMAIL')]")})}),n.refreshUserData(),i.setState({dirty:!1},function(){i._updater&&i._updater(i.getButtons())})})})):i.setState({dirty:!1})});var r={},e=e.pydio,t=(e.user&&e.user.preferences.forEach(function(e,t){"gui_preferences"!==t&&(r[t]=e)}),E.parseParameters(e.getXmlRegistry(),"user/preferences/pref[@exposed='true']|//param[contains(@scope,'user') and @expose='true' and not(contains(@name, 'NOTIFICATIONS_EMAIL'))]")),e=E.parseParameters(e.getXmlRegistry(),"user/preferences/pref[@exposed='true']|//param[contains(@scope,'user') and @expose='true' and contains(@name, 'NOTIFICATIONS_EMAIL')]");return i.state={definitions:t,mailDefinitions:e,values:r,originalValues:u.default.deepCopy(r),dirty:!1},i}return t=o,(e=[{key:"render",value:function(){var e,t,r=this.props,n=r.pydio,r=r.miniDisplay;return n.user?(t=(e=this.state).definitions,e=e.values,t=(t=r?t.filter(function(e){return-1!==["avatar"].indexOf(e.name)}):t).map(function(e){return d(d({},e),{},{label:e.label+" - "+e.description})}),a.default.createElement("div",null,a.default.createElement(P,{className:"current-user-edit",parameters:t,values:e,depth:-1,binary_context:"user_id="+n.user.id+(e.avatar?"?"+e.avatar:""),onChange:this.onFormChange,variant:"v2"}),a.default.createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:" \n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group:first-of-type {\n  margin-top: 210px;\n  overflow-y: hidden;\n}\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 200px;\n  background-color: #eceff1;\n}\n.react-mui-context .current-user-edit.pydio-form-panel .form-entry-image>div:last-child {\n  margin-top: 0;\n}\n\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image > div:first-child {\n  padding: 0;\n  border-radius: 0;\n}\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image .image-label,\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image .form-legend {\n  display: none;\n}\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image .file-dropzone {\n  border-radius: 50%;\n  width: 160px !important;\n  height: 160px !important;\n  margin: 20px auto;\n}\n.react-mui-context .current-user-edit.pydio-form-panel > .pydio-form-group div.form-entry-image .binary-remove-button {\n  position: absolute;\n  bottom: 5px;\n  right: 5px;\n  font-size: 14px; \n}\n\n"}}))):null}}])&&y(t.prototype,e),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}(a.default.Component);r.default=n,t.exports=r.default},{"./EmailPanel":3,"./PasswordPopover":7,"cells-sdk":"cells-sdk","material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang",react:"react"}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=u(e("react")),o=u(e("create-react-class")),a=u(e("./ProfilePane")),i=u(e("pydio")),s=e("material-ui");function u(e){return e&&e.__esModule?e:{default:e}}function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var e=i.default.requireLib("boot"),i=e.ActionDialogMixin,c=e.CancelButtonProviderMixin,e=(e.SubmitButtonProviderMixin,(0,o.default)({displayName:"WelcomeModal",mixins:[i,c],getDefaultProps:function(){return{dialogTitle:"",dialogIsModal:!0,dialogSize:"sm",dialogPadding:0}},close:function(e){this.props.onRequestStart&&this.props.onRequestStart(e),this.props.onDismiss()},getMessage:function(e){return this.props.pydio.MessageHash["ajax_gui.tour.welcomemodal."+e]},getButtons:function(){var e=this;return[n.default.createElement(s.FlatButton,{label:this.getMessage("skip"),onClick:function(){e.close(!0)}}),n.default.createElement(s.FlatButton,{label:this.getMessage("start"),primary:!0,onClick:function(){return e.close(!1)}})]},render:function(){return n.default.createElement("div",null,n.default.createElement("div",{style:{position:"relative",width:"100%",height:200,overflow:"hidden",backgroundColor:"#eceff1"}},n.default.createElement(a.default,l({miniDisplay:!0},this.props,{saveOnChange:!0}))),n.default.createElement(s.CardTitle,{title:this.getMessage("title"),subtitle:this.getMessage("subtitle")}))}}));r.default=e,t.exports=r.default},{"./ProfilePane":8,"create-react-class":"create-react-class","material-ui":"material-ui",pydio:"pydio",react:"react"}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Callbacks=void 0,Object.defineProperty(r,"ModalAddressBook",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"ModalDashboard",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"PasswordForm",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"WelcomeModal",{enumerable:!0,get:function(){return i.default}});var n=u(e("./Callbacks")),o=u(e("./ModalDashboard")),a=u(e("./ModalAddressBook")),i=u(e("./WelcomeModal")),s=u(e("./PasswordForm"));function u(e){return e&&e.__esModule?e:{default:e}}e=(0,n.default)(window.pydio);r.Callbacks=e},{"./Callbacks":1,"./ModalAddressBook":4,"./ModalDashboard":5,"./PasswordForm":6,"./WelcomeModal":9}]},{},[10])(10)});