(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t),e.d(t,{DropUploader:()=>re,TransfersList:()=>W});const r=require("react");var n=e.n(r);const o=require("pydio");var i=e.n(o);const l=require("material-ui");function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==a(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===a(o)?o:String(o)),n)}var o}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(d,e);var t,r,o,f,p=(o=d,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(o);if(f){var r=c(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function d(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),p.apply(this,arguments)}return t=d,(r=[{key:"updateField",value:function(e,t){var r=this.props.configs;if("autostart"===e){var n=r.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send",!0);n=!n,r.updateOption("upload_auto_send",n,!0)}else if("autoclose"===e){var o=r.getOptionAsBool("DEFAULT_AUTO_CLOSE","upload_auto_close",!0);o=!o,r.updateOption("upload_auto_close",o,!0)}else if("existing"===e)r.updateOption("upload_existing",t.target.getSelectedValue());else if("show_processed"===e){var i=r.getOptionAsBool("UPLOAD_SHOW_PROCESSED","upload_show_processed",!1);i=!i,r.updateOption("upload_show_processed",i,!0)}this.setState({random:Math.random()})}},{key:"radioChange",value:function(e,t){this.props.configs.updateOption("upload_existing",t),this.setState({random:Math.random()})}},{key:"render",value:function(){var e=this,t=this.props.configs,r=i().getInstance(),o=t.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send"),a=t.getOptionAsBool("DEFAULT_AUTO_CLOSE","upload_auto_close"),s=t.getOption("DEFAULT_EXISTING","upload_existing");return n().createElement(l.Popover,{open:this.props.open,anchorEl:this.props.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:function(t){e.props.onDismiss(t)}},n().createElement("div",{style:{width:320,paddingBottom:6}},n().createElement(l.Subheader,null,"Options"),n().createElement("div",{style:{padding:"0 16px",marginTop:-6}},n().createElement(l.Checkbox,{style:{margin:"8px 0"},checked:o,labelPosition:"right",onCheck:this.updateField.bind(this,"autostart"),label:r.MessageHash[337],labelStyle:{fontSize:14}}),n().createElement(l.Checkbox,{style:{margin:"8px 0"},checked:a,labelPosition:"right",onCheck:this.updateField.bind(this,"autoclose"),label:r.MessageHash[338],labelStyle:{fontSize:14}})),n().createElement(l.Subheader,null,r.MessageHash["html_uploader.options.existing"]),n().createElement("div",{style:{padding:16,fontSize:14,paddingTop:0}},n().createElement(l.RadioButtonGroup,{ref:"group",name:"shipSpeed",defaultSelected:s,onChange:this.radioChange.bind(this)},n().createElement(l.RadioButton,{value:"alert",label:r.MessageHash["html_uploader.options.existing.alert"],style:{paddingBottom:8}}),n().createElement(l.RadioButton,{value:"rename-folders",label:r.MessageHash["html_uploader.options.existing.folders"],style:{paddingBottom:8}}),n().createElement(l.RadioButton,{value:"rename",label:r.MessageHash["html_uploader.options.existing.merge"],style:{paddingBottom:8}}),n().createElement(l.RadioButton,{value:"overwrite",label:r.MessageHash["html_uploader.options.existing.overwrite"]})))))}}])&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),d}(n().Component);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===p(o)?o:String(o)),n)}var o}function y(e,t){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},y(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(u,e);var t,r,o,a,s=(o=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(o);if(a){var r=h(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===p(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),s.apply(this,arguments)}return t=u,(r=[{key:"clear",value:function(e){var t=UploaderModel.Store.getInstance();switch(e){case"all":t.clearAll();break;case"loaded":t.clearStatus("loaded");break;case"error":t.clearStatus("error")}this.props.onDismiss()}},{key:"render",value:function(){var e=this,t=i().getMessages();return n().createElement(l.Popover,{open:this.props.open,anchorEl:this.props.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:function(t){e.props.onDismiss(t)}},n().createElement(l.Menu,{style:{width:146},desktop:!0},n().createElement(l.Subheader,{style:{lineHeight:"26px"}},t["html_uploader.clear-header"]),n().createElement(l.MenuItem,{primaryText:t["html_uploader.clear-finished"],onClick:function(){e.clear("loaded")}}),n().createElement(l.MenuItem,{primaryText:t["html_uploader.clear-failed"],onClick:function(){e.clear("error")}}),n().createElement(l.MenuItem,{primaryText:t["html_uploader.clear-all"],onClick:function(){e.clear("all")}})))}}])&&d(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n().Component);const g=require("pydio/util/path");var b=e.n(g);const v=require("pydio/lang/observable");function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function w(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==S(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===S(o)?o:String(o)),n)}var o}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(a,e);var t,r,n,o,l=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(n);if(o){var r=P(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return k(e)}(this,e)});function a(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=l.call(this))._status=a.StatusNew,r._type=e,r._id=Math.random(),r._errorMessage=null;var o=i().getInstance();return r._repositoryId=n?n.getRepositoryId():o.user.activeRepository,r._exists=!1,r._progress=0,r.children={folders:[],files:[],pg:{}},r._targetNode=t,n&&(r._parent=n,e===a.TypeFolder?n.children.folders.push(k(r)):n.children.files.push(k(r))),r}return t=a,r=[{key:"getId",value:function(){return this._id}},{key:"getParent",value:function(){return this._parent}},{key:"getLabel",value:function(){return this._label&&this._label.normalize?this._label.normalize("NFC"):this._label}},{key:"updateTargetNode",value:function(e){this._targetNode=e}},{key:"getTargetNode",value:function(){return this._targetNode}},{key:"updateLabel",value:function(e){this._label=e,this.notify("update_label",e)}},{key:"getFullPath",value:function(){return this._parent.getFullPath()+"/"+this.getLabel()}},{key:"getProgress",value:function(){return this._progress}},{key:"setExists",value:function(){this._exists=!0}},{key:"getExists",value:function(){return this._exists}},{key:"getType",value:function(){return this._type}},{key:"getStatus",value:function(){return this._status}},{key:"setStatus",value:function(e){this._status=e,this.notify("status",e)}},{key:"updateRepositoryId",value:function(e){this._repositoryId=e}},{key:"getRepositoryId",value:function(){return this._repositoryId}},{key:"getErrorMessage",value:function(){return this._errorMessage||""}},{key:"onError",value:function(e){this._errorMessage=e,this.setStatus(a.StatusError)}},{key:"process",value:function(e){this._doProcess(e)}},{key:"abort",value:function(e){this._doAbort&&this._doAbort(e)}},{key:"pause",value:function(){if(this._doPause){var e=this._doPause();this.setStatus(e)}}},{key:"resume",value:function(){this._doResume&&(this._doResume(),this.setStatus(a.StatusLoading))}},{key:"addChild",value:function(e){var t=this;this.children.pg[e.getId()]=0,e.observe("progress",(function(r){t.children.pg[e.getId()]=r,t.recomputeProgress()})),this.notify("child_added")}},{key:"recomputeProgress",value:function(){var e=this,t=Object.keys(this.children.pg).map((function(t){return e.children.pg[t]}));if(t.length){var r=t.reduce((function(e,t){return e+t}));this._progress=r/t.length,this.notify("progress",this._progress)}}},{key:"removeChild",value:function(e){e.abort(),e.walk((function(e){e.abort()}),(function(){return!0}),a.TypeFile);var t=e.getId(),r=this.children.folders.indexOf(e),n=this.children.files.indexOf(e),o=!1;r>-1?(this.children.folders=LangUtils.arrayWithout(this.children.folders,r),o=!0):n>-1&&(this.children.files=LangUtils.arrayWithout(this.children.files,n),o=!0),o&&(e.stopObserving("progress"),delete this.children.pg[t],this.recomputeProgress(),this.notify("children"))}},{key:"getChildren",value:function(){return[].concat(w(this.children.folders),w(this.children.files))}},{key:"walk",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.TypeBoth,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return!1},o=!1;if(r===a.TypeBoth||r===a.TypeFile)for(var i=this.children.files,l=0;l<i.length;l++){if(n(i[l])){o=!0;break}t(i[l])&&e(i[l])}o||this.children.folders.forEach((function(o){r!==a.TypeFolder&&r!==a.TypeBoth||!t(o)||e(o),n(o)||o.walk(e,t,r,n)}))}},{key:"collectWithLimit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"both",n=[];return this.walk((function(e){n.push(e)}),t,r,(function(t){return n.length>=e})),n}}],r&&_(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(e.n(v)());function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){x(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e,t,r){return(t=F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F(n.key),n)}}function F(e){var t=function(e,t){if("object"!==C(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===C(t)?t:String(t)}function M(e,t){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},M(e,t)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}j.StatusNew="new",j.StatusAnalyze="analyse",j.StatusFolders="folders",j.StatusLoading="loading",j.StatusLoaded="loaded",j.StatusError="error",j.StatusPause="pause",j.StatusCannotPause="cannot-pause",j.StatusMultiPause="multi-pause",j.TypeFolder="folder",j.TypeFile="file",j.TypeBoth="both";var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&M(e,t)}(u,e);var t,r,o,a,s=(o=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(o);if(a){var r=A(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).state={open:!1,showAll:!1,status:e.item.getStatus(),previewUrl:null,progress:e.item.getProgress()||0},t}return t=u,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props.item;if(this._pgObserver=function(t){e.setState({progress:t})},this._statusObserver=function(t){e.setState({status:t})},t.observe("progress",this._pgObserver),t.observe("status",this._statusObserver),t.observe("children",(function(){e.forceUpdate()})),t instanceof UploaderModel.UploadItem&&/\.(jpe?g|png|gif)$/i.test(t.getFile().name)){if(t.previewUrl)return void this.setState({previewUrl:t.previewUrl});var r=new FileReader;r.addEventListener("load",(function(){t.previewUrl=r.result,e.setState({previewUrl:r.result})}),!1),r.readAsDataURL(t.getFile())}}},{key:"componentWillUnmount",value:function(){var e=this.props.item;e.stopObserving("progress",this._pgObserver),e.stopObserving("status",this._statusObserver)}},{key:"remove",value:function(){var e=this.props.item;e.getParent()&&e.getParent().removeChild(e)}},{key:"abort",value:function(){this.props.item.abort()}},{key:"retry",value:function(){var e=this.props,t=e.item,r=e.store;t.setStatus(j.StatusNew),r.processNext()}},{key:"render",value:function(){var e,t,r,o,a,s,c=this,f=this.props,p=f.item,d=f.className,y=f.style,h=f.limit,m=f.level,g=f.extensions,v=f.store,S=this.state,w=S.open,O=S.showAll,_=S.progress,E=S.status,k=S.previewUrl,P=p.getChildren(),C=p instanceof UploaderModel.FolderItem,R=p instanceof UploaderModel.PartItem,x=p instanceof UploaderModel.Session,I=i().getMessages(),F={main:T(T({},y),{},{fontSize:14,color:"#424242"}),line:{paddingLeft:24*(m-1),display:"flex",alignItems:"center",paddingTop:m>1?10:16,paddingBottom:6,cursor:P.length?"pointer":"default",borderLeft:1===m?"3px solid transparent":""},secondaryLine:{display:"flex",alignItems:"center",opacity:.3,fontSize:11},leftIcon:{display:"inline-block",width:50,textAlign:"center",color:R?"#9e9e9e":"#616161",fontSize:18},previewImage:{display:"inline-block",backgroundColor:"#eee",backgroundSize:"cover",height:32,width:32,borderRadius:"50%"},label:{fontSize:15,fontWeight:C?500:400,color:R?"#9e9e9e":null,fontStyle:R?"italic":null,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},errMessage:{color:"#e53935",fontSize:11,flex:2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},pgBar:{position:"relative"},rightButton:{display:"inline-block",width:48,textAlign:"center",cursor:"pointer",color:"#9e9e9e",fontSize:16},toggleIcon:{color:"#bdbdbd",marginLeft:4}},M=[];if(P.length){if(w||x&&E!==j.StatusAnalyze){var A=O?P:P.slice(0,h);M=A.map((function(e){return n().createElement(u,{key:e.getId(),item:e,limit:h,level:m+1,extensions:g,store:v})})),P.length>A.length&&M.push(n().createElement("div",{style:T(T({},F.line),{},{cursor:"pointer",borderLeft:"",paddingLeft:20*m}),onClick:function(){c.setState({showAll:!0})}},n().createElement("span",{style:F.leftIcon,className:"mdi mdi-plus-box-outline"}),n().createElement("span",{style:{flex:1,fontStyle:"italic"}},I["html_uploader.list.show-more"].replace("%d",P.length-A.length))))}a=function(){c.setState({open:!w})},o=n().createElement("span",{onClick:a,style:F.toggleIcon,className:"mdi mdi-chevron-"+(w?"down":"right")})}if(C)e="mdi mdi-folder",t=n().createElement("span",{className:"mdi mdi-close-circle-outline",onClick:function(){c.remove()}}),100===_&&(s="#4caf50");else if(R)e="mdi mdi-package-up",100===_&&(s="#4caf50");else{e="mdi mdi-file";var B=b().getFileExtension(p.getFullPath());g.has(B)&&(e="mimefont mdi mdi-"+g.get(B).fontIcon),E===j.StatusLoading||E===j.StatusCannotPause||E===j.StatusMultiPause?t=n().createElement("span",{className:"mdi mdi-stop",onClick:function(){return c.abort()}}):E===j.StatusError?(s="#e53935",t=n().createElement("span",{className:"mdi mdi-restart",style:{color:"#e53935"},onClick:function(){c.retry()}})):(s="#4caf50",t=n().createElement("span",{className:"mdi mdi-close-circle-outline",onClick:function(){c.remove()}}))}var D,U=b().getBasename(p.getFullPath()),z=n().createElement(l.LinearProgress,{style:{backgroundColor:"#eeeeee",height:3},color:s,min:0,max:100,value:_,mode:"determinate"});if(x){if(E!==j.StatusAnalyze)return n().createElement("div",null,M);U=i().getMessages()["html_uploader.analyze.step"],z=null,a=null,o=null,t=n().createElement(l.CircularProgress,{size:16,thickness:2,style:{marginTop:1}})}r=k?n().createElement("span",{style:T(T({},F.leftIcon),{},{marginTop:-4,marginBottom:-5})},n().createElement("div",{style:T({background:"url("+k+")"},F.previewImage)})):n().createElement("span",{style:F.leftIcon},n().createElement("span",{className:e,style:{display:"block",width:F.previewImage.width,height:F.previewImage.height,lineHeight:F.previewImage.width+"px",backgroundColor:"#ECEFF1",borderRadius:"50%",marginLeft:6}}));var L=T({},F.secondaryLine),N=C?"dir":R?"part":"file";return"error"===E?(L.opacity=1,D=n().createElement("span",{style:F.errMessage,title:p.getErrorMessage()},p.getErrorMessage())):(D=I["html_uploader.status."+N+"."+E]||I["html_uploader.status."+E]||E,p.getSize&&(D=p.getHumanSize()+" - "+D),E===j.StatusAnalyze&&p.getAnalyzeStatus&&p.getAnalyzeStatus()&&(D+=" ("+p.getAnalyzeStatus()+")"),E===j.StatusLoading&&p.getRetry&&p.getRetry()>0&&(D+=" ("+I["html_uploader.attempt"]+" "+(1+p.getRetry())+")")),n().createElement("div",{style:F.main,className:"upload-"+E+" "+(d||"")},n().createElement("div",{style:F.line},r,n().createElement("div",{style:{flex:1,overflow:"hidden",paddingLeft:4}},n().createElement("div",{onClick:a,style:F.label},U," ",o),n().createElement("div",{style:L},D),n().createElement("div",{style:F.pgBar},z)),n().createElement("span",{style:F.rightButton},t)),M)}}])&&I(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n().Component);const D=require("material-ui/styles"),U=require("pydio/util/dom");var z=e.n(U);function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==L(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===L(o)?o:String(o)),n)}var o}function H(e,t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H(e,t)}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}var W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(s,e);var t,r,o,l,a=(o=s,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=q(o);if(l){var r=q(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),a.call(this,e)}return t=s,(r=[{key:"render",value:function(){var e,t=this.props,r=t.sessions,o=t.store,l=(t.muiTheme,t.onPickFile),a=t.onPickFolder,s=z().getBeziersTransition().replace("all ","color "),u=i().getMessages();if(r){var c=!0,f=i().getInstance().Registry.getFilesExtensions(),p=r.map((function(e){return e.getChildren().length&&(c=!1),n().createElement(B,{item:e,store:o,style:{},limit:10,level:0,extensions:f})}));c||(e=n().createElement("div",{style:{height:"100%",overflowY:"auto",padding:10,paddingBottom:20}},p))}var d=n().createElement("div",{style:{display:"flex",alignItems:"center",height:"100%",width:"100%",backgroundColor:"#F5F5F5",transition:s},className:"drop-transfer-list"},n().createElement("div",{style:{textAlign:"center",width:"100%",fontWeight:500,fontSize:18,padding:24,lineHeight:"28px"}},n().createElement("div",{className:"mdi mdi-cloud-upload",style:{fontSize:110}}),n().createElement("div",null,u["html_uploader.drophere"]," ",u["html_uploader.drop-or"]," ",n().createElement("a",{onClick:l},u["html_uploader.drop-pick-file"]),a&&n().createElement("span",null," ",u["html_uploader.drop-or"]," ",n().createElement("a",{onClick:a},u["html_uploader.drop-pick-folder"])))),n().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:"\n            .drop-transfer-list{\n                color:rgba(3, 169, 244, 0.5);\n            }\n            .transparent-dropzone.active .drop-transfer-list{\n                color:rgba(3, 169, 244, 0.8);\n            }\n            .drop-transfer-list a,.drop-transfer-list a:hover {\n                color:rgba(3, 169, 244, 1);\n                cursor: pointer;\n            }\n        "}}));return n().createElement("div",{style:{display:"flex",height:"100%",overflow:"hidden"}},n().createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"}},d),e&&n().createElement("div",{style:{width:420,minWidth:420,maxWidth:420}},e))}}])&&N(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n().Component);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==V(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===V(o)?o:String(o)),n)}var o}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}W=(0,D.muiThemeable)()(W);var X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(u,e);var t,r,o,a,s=(o=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Q(o);if(a){var r=Q(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).state={value:"rename-folders",saveValue:!1},t}return t=u,(r=[{key:"cancel",value:function(){this.props.onCancel()}},{key:"submit",value:function(){var e=this.state,t=e.value,r=e.saveValue;this.props.onConfirm(t,r)}},{key:"checkChange",value:function(e,t){this.setState({saveValue:t})}},{key:"radioChange",value:function(e,t){this.setState({value:t})}},{key:"render",value:function(){var e=i().getInstance(),t=this.state,r=t.value,o=t.saveValue;return n().createElement("div",{style:{position:"absolute",padding:16,fontSize:14,top:49,left:0,right:0,bottom:0,display:"flex",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.7)"}},n().createElement(l.Paper,{style:{width:500,padding:16,fontSize:14,margin:"0 auto"},zDepth:2},n().createElement("div",null,n().createElement("h5",null,e.MessageHash[124]),n().createElement(l.RadioButtonGroup,{ref:"group",name:"shipSpeed",defaultSelected:r,onChange:this.radioChange.bind(this)},n().createElement(l.RadioButton,{value:"rename-folders",label:e.MessageHash["html_uploader.confirm.rename.all"],style:{paddingBottom:8}}),n().createElement(l.RadioButton,{value:"rename",label:e.MessageHash["html_uploader.confirm.rename.merge"],style:{paddingBottom:8}}),n().createElement(l.RadioButton,{value:"overwrite",label:e.MessageHash["html_uploader.confirm.overwrite"]}))),n().createElement("div",{style:{display:"flex",marginTop:30,alignItems:"center"}},n().createElement(l.Checkbox,{label:e.MessageHash["html_uploader.confirm.save.choice"],checked:o,onCheck:this.checkChange.bind(this)}),n().createElement("span",{style:{flex:1}}),n().createElement(l.FlatButton,{label:e.MessageHash[54],onClick:this.cancel.bind(this)}),n().createElement(l.RaisedButton,{primary:!0,label:e.MessageHash[48],onClick:this.submit.bind(this)}))))}}])&&G(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n().Component);function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function Z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Y(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Y(o)?o:String(o)),n)}var o}function J(e,t){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},J(e,t)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}var ee=i().requireLib("hoc").dropProvider,te=i().requireLib("form").FileDropZone,re=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J(e,t)}(c,t);var r,o,a,s,u=(a=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=K(a);if(s){var r=K(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),t=u.call(this,e);var r=UploaderModel.Store.getInstance();return t._storeObserver=function(){t.setState({sessions:r.getSessions(),storeRunning:r.isRunning()})},r.observe("update",t._storeObserver),r.observe("auto_close",(function(){t.props.onDismiss&&t.props.onDismiss()})),t.state={showOptions:!1,configs:UploaderModel.Configs.getInstance(),sessions:r.getSessions(),storeRunning:r.isRunning(),confirmDialog:e.confirmDialog},t}return r=c,(o=[{key:"componentWillReceiveProps",value:function(e){e.confirmDialog!==this.state.confirmDialog&&this.setState({confirmDialog:e.confirmDialog})}},{key:"componentWillUnmount",value:function(){this._storeObserver&&(UploaderModel.Store.getInstance().stopObserving("update",this._storeObserver),UploaderModel.Store.getInstance().stopObserving("auto_close"))}},{key:"onDrop",value:function(e){var t=i().getInstance().getContextHolder().getContextNode();UploaderModel.Store.getInstance().handleDropEventResults(null,e,t)}},{key:"onFolderPicked",value:function(e){var t=i().getInstance().getContextHolder().getContextNode();UploaderModel.Store.getInstance().handleFolderPickerResult(e,t)}},{key:"start",value:function(e){e.preventDefault(),UploaderModel.Store.getInstance().resume()}},{key:"pause",value:function(e){UploaderModel.Store.getInstance().pause()}},{key:"openClear",value:function(e){e.preventDefault(),this.setState({showClear:!0,clearAnchorEl:e.currentTarget})}},{key:"toggleOptions",value:function(e){e.preventDefault&&e.preventDefault();var t=this.state,r=t.showOptions,n=void 0!==r&&r;t.currentTarget,this.setState({showOptions:!n,optionsAnchorEl:e.currentTarget})}},{key:"openFilePicker",value:function(e){e.preventDefault(),this.refs.dropzone.open()}},{key:"openFolderPicker",value:function(e){e.preventDefault(),this.refs.dropzone.openFolderPicker()}},{key:"dialogSubmit",value:function(e,t){var r=this.state.configs;UploaderModel.Store.getInstance().getSessions().forEach((function(t){"confirm"===t.getStatus()&&t.prepare(e)})),t&&r.updateOption("upload_existing",e),this.setState({confirmDialog:!1}),i().getInstance().getController().fireAction("upload")}},{key:"dialogCancel",value:function(){var e=UploaderModel.Store.getInstance();e.getSessions().forEach((function(t){"confirm"===t.getStatus()&&e.removeSession(t)})),this.setState({confirmDialog:!1}),i().getInstance().getController().fireAction("upload")}},{key:"supportsFolder",value:function(){var t=!1,r=e.g.document.createElement("input");return r.setAttribute("type","file"),"webkitdirectory"in r&&(t=!0),r=null,t}},{key:"render",value:function(){var e=this,t=i().getInstance().MessageHash,r=this.props,o=r.showDismiss,a=r.onDismiss,s=this.props.connectDropTarget||function(e){return e},u=this.state,c=u.configs,p=u.showOptions,d=u.optionsAnchorEl,y=u.showClear,h=u.clearAnchorEl,g=u.sessions,b=(u.storeRunning,u.confirmDialog),v=UploaderModel.Store.getInstance(),S=!0;return g.forEach((function(e){e.getChildren().length&&(S=!1)})),s(n().createElement("div",{style:{position:"relative",backgroundColor:"#FAFAFA"}},n().createElement("div",{style:{position:"relative",display:"flex",alignItems:"center",paddingLeft:16,paddingRight:16,width:"100%"}},n().createElement("h3",{style:{marginBottom:16}},t["html_uploader.dialog.title"]),n().createElement(l.IconButton,{iconClassName:"mdi mdi-dots-vertical",primary:!0,iconStyle:{fontSize:18},style:{padding:14},tooltip:t["html_uploader.options"],onClick:this.toggleOptions.bind(this)}),n().createElement("span",{style:{flex:1}}),n().createElement(l.FlatButton,{icon:n().createElement(l.FontIcon,{style:{fontSize:16},className:"mdi mdi-play"}),label:t["html_uploader.start"],onClick:this.start.bind(this),primary:!0,disabled:v.isRunning()||!v.hasQueue()}),n().createElement(l.FlatButton,{icon:n().createElement(l.FontIcon,{style:{fontSize:16},className:"mdi mdi-pause"}),label:t["html_uploader.pause"],onClick:this.pause.bind(this),primary:!0,disabled:!v.isRunning()}),n().createElement(l.FlatButton,{icon:n().createElement(l.FontIcon,{style:{fontSize:16},className:"mdi mdi-delete"}),label:n().createElement("span",null,t["html_uploader.clear"],n().createElement("span",{className:"mdi mdi-menu-down"})),onClick:this.openClear.bind(this),primary:!0,disabled:S}),o&&n().createElement(l.IconButton,{iconClassName:"mdi mdi-close",style:{padding:14},onClick:function(){return a()}})),n().createElement(te,{className:"transparent-dropzone",ref:"dropzone",multiple:!0,enableFolders:!0,supportClick:!1,ignoreNativeDrop:!0,onDrop:this.onDrop.bind(this),onFolderPicked:this.onFolderPicked.bind(this),style:{width:"100%",height:420}},n().createElement(W,{sessions:g,autoStart:c.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send"),onDismiss:this.props.onDismiss,store:v,onPickFile:function(t){e.openFilePicker(t)},onPickFolder:this.supportsFolder()?function(t){e.openFolderPicker(t)}:null})),n().createElement(f,{configs:c,open:p,anchorEl:d,onDismiss:function(t){e.toggleOptions(t)}}),n().createElement(m,{configs:c,open:y,anchorEl:h,onDismiss:function(){e.setState({showClear:!1,clearAnchorEl:null})}}),b&&n().createElement(X,{onConfirm:this.dialogSubmit.bind(this),onCancel:this.dialogCancel.bind(this)})))}}])&&Z(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),c}(n().Component);re=ee(re),window.UploaderView=t})();